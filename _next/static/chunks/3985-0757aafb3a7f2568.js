"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3985],{94789:function(e,r,t){t.d(r,{C:function(){return v}});var o=t(26042),n=t(99534),a=t(85893),i=t(45697),s=t(89345),u=t(9270),c=t(62140),l=t(99505),d=t(55843),v=function(e){var r=e.control,t=e.errors,i=e.nameEnd,v=e.nameStart,p=e.placeholderEnd,y=e.placeholderStart,m=e.space,g=(0,n.Z)(e,["control","errors","nameEnd","nameStart","placeholderEnd","placeholderStart","space"]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(u.Z,{children:[(0,a.jsx)(c.Z,{md:6,children:(0,a.jsx)(l.Z,(0,o.Z)({control:r,errors:t,locale:s.Z,name:v,placeholder:y},g))}),(0,a.jsx)(c.Z,{md:6,children:(0,a.jsx)(l.Z,(0,o.Z)({control:r,errors:t,locale:s.Z,name:i,placeholder:p},g))})]}),m&&(0,a.jsx)(d.Z,{marginBottom:"sm"})]})};v.propTypes={control:i.object.isRequired,errors:i.object.isRequired,nameStart:i.string.isRequired,nameEnd:i.string.isRequired,placeholderStart:i.string,placeholderEnd:i.string,space:i.bool},v.defaultProps={placeholderStart:"Start date",placeholderEnd:"End date",space:!0}},45082:function(e,r,t){t.d(r,{r:function(){return o}});var o=[{text:"All work orders",value:null,label:"All work orders"},{text:"All outstanding invoices",value:"0-",label:"All outstanding invoices"},{text:"1 - 30",value:"1-30",label:"1 - 30"},{text:"31 - 60",value:"31-60",label:"31 - 60"},{text:"61 - 90",value:"61-90",label:"61 - 90"},{text:"> 90",value:"90-",label:"> 90"}]},66812:function(e,r,t){t.d(r,{P:function(){return C}});var o=t(47568),n=t(26042),a=t(99534),i=t(7297),s=t(97582),u=t(85893),c=t(67294),l=t(45697),d=t(10367),v=t(66252),p=t(4972),y=t(78289),m=t(52019),g=t(49501),h=t(9270),b=t(62140),I=t(84043),f=t(77439);function q(){var e=(0,i.Z)(["\n  position: relative;\n  right: 25px;\n  top: 2px;\n"]);return q=function(){return e},e}var S=function(e,r){var t,o,n,a=!0;return(null===(t=e.errors[e.name])||void 0===t?void 0:t.message)!==(null===(o=r.errors[r.name])||void 0===o?void 0:o.message)&&(a=!1),["accountId","assetCategoryId","entity","entityId","locationId","serviceId","type","value","customerId","customerRole"].forEach(function(t){e[t]!==r[t]&&(a=!1)}),a},x=function(e){var r=e.accountId,t=e.area,o=e.assetCategoryId,n=e.entity,a=e.entityId,i=(e.hasRole,e.id),s=e.locationId,u=e.serviceId,c=e.taxonomyGroupType,l=e.customerId,d=e.customerRole,v=e.type,y=e.userId,m=e.invoiceThreshold,g=e.quoteThreshold,h=v;switch(d&&(h="".concat(v,"_").concat(d)),h){case"address":return{query:p.cz,variables:{entity:n,entityId:a}};case"asset":return{query:p.UH,variables:{categoryId:o,locationId:s}};case"assetBookable":return{query:p.UH,variables:{categoryId:o,locationId:s,bookable:"yes"}};case"assetCategory":return{query:p.nD,variables:{id:i}};case"assetSublocation":return{query:p.UH,variables:{category:"sublocation",adminId:r,locationId:s}};case"compliance":return{query:p.kU,variables:{locationId:s}};case"coverage":return{query:p.j$};case"customer":return{query:p.SW};case"job":return{query:p.Qn,variables:{locationId:s}};case"manager":return{query:p.he,variables:{accountId:r,userId:y}};case"thresholdManagers":return{query:p.Ak,variables:{accountId:r,userId:y,invoiceThreshold:m,quoteThreshold:g}};case"product":return{query:p.UH,variables:{category:"product",locationId:s}};case"property":return{query:p._d,variables:{where:{status:{_eq:"active"},Account_Locations:{accountId:{_eq:r}}}}};case"property_user":return{query:p._d,variables:{where:{status:{_eq:"active"},Account_Locations:{accountId:{_eq:r},Account:{type:{_eq:"customer"},Account_Users:{role:{_eq:"user"},userId:{_eq:l}}},User_Account_Locations:{Account_User:{userId:{_eq:l},accountId:{_eq:r}}}}}}};case"sensor":return{query:p.UH,variables:{category:"sensor",locationId:s}};case"service":return{query:p.kx};case"sla":return{query:p.t1,variables:{type:"priority",adminId:r}};case"sublocation":return{query:p.zR,variables:{locationId:s}};case"supplier":var b={type:{_eq:"supplier"}};return t&&(b.PostcodeAreas={PostcodeArea:{area:{_eq:t}},entity:{_eq:"Account"},status:{_eq:"active"}}),u&&(b.ServiceSchedule={status:{_eq:"active"},entity:{_eq:"Supplier"},serviceId:{_eq:u}},t&&(b.ServiceSchedule.PostcodeAreas={PostcodeArea:{area:{_eq:t}}})),{query:p.by,variables:{where:b}};case"user":return{query:p.yR,variables:{accountId:r}};case"usersForBookings":return{query:p.yR,variables:{accountId:y}};case"tenant":return{query:p.RJ};case"taxonomyGroup":return{query:p.Cj,variables:{type:c}};case"expenseCategory":return{query:p.Ve};default:return{query:p.qd}}},C=(0,c.memo)(function(e){var r,t=e.AddForm,i=e.accountId,l=e.area,d=e.assetCategoryId,p=e.control,q=e.entity,S=e.entityId,C=e.errors,j=e.id,Z=e.isClearable,R=e.isDisabled,A=e.label,w=e.locationId,P=e.name,T=e.serviceId,k=e.taxonomyGroupType,z=e.customerId,E=e.customerRole,U=e.type,F=e.userId,O=e.invoiceThreshold,B=e.quoteThreshold,D=(0,a.Z)(e,["AddForm","accountId","area","assetCategoryId","control","entity","entityId","errors","id","isClearable","isDisabled","label","locationId","name","serviceId","taxonomyGroupType","customerId","customerRole","type","userId","invoiceThreshold","quoteThreshold"]),G=(0,v.x)(),H=(0,c.useState)(!1),L=H[0],N=H[1],J=(0,c.useState)(),M=J[0],V=J[1],W=(0,c.useState)(!1),Q=W[0],$=W[1],K=(0,c.useContext)(y.Z),X=(0,c.useContext)(m.Z).hasRole,Y=(0,c.useState)(!1),ee=Y[0],er=Y[1];(0,c.useEffect)(function(){return er(!1),$(!1),function(){}},[i,d,q,S,w,T,U,z,E,F]);var et=(r=(0,o.Z)(function(){var e,r,t,o,a,u,c;return(0,s.__generator)(this,function(a){switch(a.label){case 0:if(Q)return er(!0),[2,null];return N(!0),r=(e=x({accountId:i,area:l,assetCategoryId:d,entity:q,entityId:S,hasRole:X,id:j,locationId:w,serviceId:T,taxonomyGroupType:k,customerId:z,customerRole:E,type:U,userId:F,invoiceThreshold:O,quoteThreshold:B})).query,o=void 0===(t=e.variables)?{}:t,[4,G.query({query:r,variables:(0,n.Z)({},o)})];case 1:return V((void 0===(u=a.sent().data)?{items:[]}:u).items),N(!1),$(!0),er(!0),[2]}})}),function(){return r.apply(this,arguments)}),eo=function(){K.show({content:(0,u.jsx)("div",{children:(0,u.jsx)(t,{})}),title:"Add form"})};return(0,u.jsx)(g.Z,{id:P,label:A,children:(0,u.jsxs)(h.Z,{children:[(0,u.jsx)(b.Z,{md:t?11:12,children:(0,u.jsx)(I.Z,(0,n.Z)({autoload:!1,blurInputOnSelect:!0,cacheOptions:!0,control:p,errors:C,isDisabled:R,isClearable:Z,isLoading:L,menuIsOpen:ee,options:M,onFocus:et,onBlur:function(){er(!1)},name:P,searchable:!0},D),D.defaultValue)}),t&&(0,u.jsx)(b.Z,{md:1,children:(0,u.jsx)(_,{children:(0,u.jsx)(f.Z,{content:null,startIcon:"plus",size:"sm",onClick:eo})})})]})})},S),_=d.ZP.div.withConfig({displayName:"select__ButtonWrapper",componentId:"sc-a24ec191-0"})(q());C.propTypes={AddForm:l.object,area:l.string,accountId:l.number,assetCategoryId:l.number,control:l.object.isRequired,errors:l.object.isRequired,entity:l.string,entityId:l.number,id:l.number,isClearable:l.bool,label:l.string.isRequired,locationId:l.number,name:l.string.isRequired,serviceId:l.number,taxonomyGroupType:(0,l.oneOf)(["expenseCategory","costCategory","jobTags"]),type:l.string},C.defaultProps={isClearable:!0,label:"Account",name:"account",type:"account"}},91272:function(e,r,t){t.d(r,{t:function(){return c}});var o=t(85893),n=t(67294),a=t(45697),i=t(11163),s=t(46003),u=t(16540),c=(0,n.forwardRef)(function(e,r){var t=e.columns,a=e.history,c=e.initialSort,l=e.loading,d=e.meta,v=e.paginationSize,p=e.refetch,y=e.rowClick,m=e.rows,g=e.xeroPageSize,h=(0,i.useRouter)(),b=h.query,I=void 0===b?{}:b,f=(0,n.useState)(parseInt(null==I?void 0:I.page,10)||1),q=f[0],S=f[1],x=(0,n.useState)(g||s.C1.paginationSize),C=x[0],_=x[1];c||(c={item:"createdAt",order:"desc"});var j=(0,n.useState)({item:c.item,order:c.order}),Z=j[0],R=j[1],A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=h.query,t=void 0===r?{}:r;if(e>1?t.page=e:delete t.page,!(Object.keys(t).length>0))return{};var o=Object.keys(t).map(function(r){return"page"===r?"".concat(r,"=").concat(e):"".concat(r,"=").concat(t[r])}).join("&");return"?".concat(o)},w=function(){R({item:c.item,order:c.order}),S(1);var e=A();h.push(e),_(g||s.C1.paginationSize)};(0,n.useImperativeHandle)(r,function(){return{currentPage:q,pageSize:C,sort:Z,resetPagination:function(){w()}}});var P=function(e){var r=A(e);a&&h.push(r),S(e),!a&&p&&p()},T=function(e){e!==s.C1.paginationSize&&(_(e),p&&p())},k=function(e){var r;R({item:e.item,order:e.order}),p&&p()};return(0,o.jsx)(u.Z,{columns:t,loading:l,paginationSize:v,pagination:d&&!0,paginationProps:d&&{currentPage:q,onPageChange:P,onPageSizeChange:T,pageCount:Math.ceil(d.aggregate.totalCount/C),perPage:C},rowClick:y,rows:m,sort:Z,setSort:k})});c.propTypes={columns:a.array.isRequired,history:a.bool,initialSort:a.object,loading:a.bool,meta:a.object,refetch:a.func,rowClick:a.func,rows:a.array.isRequired},c.defaultProps={history:!0,loading:!0,paginationSize:!1}},20705:function(e,r,t){t.d(r,{x:function(){return l}});var o=t(14924),n=t(26042),a=t(69396),i=t(67294),s=t(96486),u=t(46003),c=function(e){try{return JSON.parse(e)}catch(r){return!1}},l=function(e){var r,t,l,d,v,p,y,m,g,h,b,I=e.filters,f=e.newFilters,q=e.initialSort,S=(0,i.useRef)(),x=(0,i.useState)({}),C=x[0],_=x[1],j=(0,i.useState)({}),Z=j[0],R=j[1],A=q||{item:"createdAt",order:"desc"},w=(0,o.Z)({},(null===(r=S.current)||void 0===r?void 0:r.sort.item)||A.item,A.inneritem?(0,o.Z)({},A.inneritem,(null===(t=S.current)||void 0===t?void 0:t.sort.order)||A.order):(null===(l=S.current)||void 0===l?void 0:l.sort.order)||A.order);return(0,i.useEffect)(function(){var e=!(0,s.isEqual)(C,I),r=!(0,s.isEqual)(Z,f);if(e&&(_(I),null==S||null===(o=S.current)||void 0===o||o.resetPagination()),r&&(R(f),null==S||null===(n=S.current)||void 0===n||n.resetPagination()),(null==S?void 0:null===(t=S.current)||void 0===t?void 0:t.setSort)&&!(e||r)){var t,o,n,a,i,u,c,l,d,v,p,y=(null===(a=S.current)||void 0===a?void 0:null===(i=a.sort)||void 0===i?void 0:i.item)&&(null===(u=S.current)||void 0===u?void 0:null===(c=u.sort)||void 0===c?void 0:c.order)?{item:null===(l=S.current)||void 0===l?void 0:null===(d=l.sort)||void 0===d?void 0:d.item,order:null===(v=S.current)||void 0===v?void 0:null===(p=v.sort)||void 0===p?void 0:p.order}:w;S.current.setSort(y)}},[I,f]),{initialData:(0,a.Z)((0,n.Z)({},I),{newFilters:(null==f?void 0:f.length)>0?f:void 0,limit:(null===(d=S.current)||void 0===d?void 0:d.pageSize)==="Infinity"?null:parseInt(null===(v=S.current)||void 0===v?void 0:v.pageSize,10)||u.C1.paginationSize,offset:((null===(p=S.current)||void 0===p?void 0:p.currentPage)-1||0)*((null===(y=S.current)||void 0===y?void 0:y.pageSize)||u.C1.paginationSize),orderBy:c(null===(m=S.current)||void 0===m?void 0:null===(g=m.sort)||void 0===g?void 0:null===(h=g.item)||void 0===h?void 0:h.replace(/ORDER/i,null===(b=S.current)||void 0===b?void 0:b.sort.order))||w}),initialSort:q,ref:S}}}}]);