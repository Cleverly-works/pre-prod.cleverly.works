(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6889],{51332:function(n,e,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/admins/view",function(){return t(36502)}])},71225:function(n,e,t){"use strict";t.d(e,{Q:function(){return i}});var i=function(n){var e,t,i=n&&n.length>0&&n.find(function(n){var e;return(null===(e=n.medium)||void 0===e?void 0:e.category)==="avatar"});if(!i)return null;var r="".concat("https://cleverly-pre-prod-media.s3.eu-west-2.amazonaws.com","/").concat(i.medium.filename),o=null==i?void 0:null===(e=i.medium)||void 0===e?void 0:null===(t=e.meta)||void 0===t?void 0:t.thumbnails;if(null==o?void 0:o.length){var a=o.find(function(n){return"small"===n.name});(null==a?void 0:a.relativePath)&&(r="".concat("https://cleverly-pre-prod-media.s3.eu-west-2.amazonaws.com","/").concat(a.relativePath))}return r}},4380:function(n,e,t){"use strict";t.d(e,{g:function(){return U}});var i=t(7297),r=t(85893),o=t(67294),a=t(45697),c=t(10367),u=t(78289),d=t(74147),l=t(9270),s=t(62140),m=t(65414),f=t(55843),v=t(45481),p=t(97303),x=t(33006),y=t(40826),h=t(55171),b=t.n(h),j=t(6812),g=t(75063);function Z(){var n=(0,i.Z)(["\n  query GetLog($entityId: bigint!, $entityName: String!) {\n    activity: audit_Activity(\n      where: { _and: [{ entityid: { _eq: $entityId } }, { entity: { _eq: $entityName } }] }\n    ) {\n      eventId\n      userId\n      user: User {\n        fullName\n      }\n      sessionUserName\n      transactionStart\n      statementStart\n      applicationName\n      clientAddr\n      clientPort\n      action\n      changedFields\n    }\n  }\n"]);return Z=function(){return n},n}var _=(0,g.Ps)(Z()),w=t(11585),N=t(26186),I=t(86036),P=t(49501),C={U:"Update",I:"Insert",D:"Delete"},S=function(n){var e=n.entityId,t=n.entityName,i=(0,j.a)(_,{variables:{entityId:e,entityName:t}}),o=i.loading,a=i.data,c=(void 0===a?{activity:[]}:a).activity;return!o&&(0,r.jsx)(l.Z,{children:(0,r.jsx)(s.Z,{md:12,children:c.map(function(n){var e,t;return(0,r.jsxs)(w.Z,{title:"".concat((null===(e=n.user)||void 0===e?void 0:e.fullName)||"Backend"," - ").concat((0,N.Z)(n.transactionStart,!0)),children:[(0,r.jsx)(I.Z,{content:"Action:",text:C[t=n.action]||"-"}),(0,r.jsx)(f.Z,{}),(0,r.jsx)(P.Z,{label:"Changed:",children:(0,r.jsx)(b(),{collapsed:!0,displayDataTypes:!1,src:n.changedFields||"-"})}),(0,r.jsx)(I.Z,{content:"Application:",text:n.applicationName||"-"})]},n.userId)})})})};S.propTypes={entityId:a.number.isRequired,entityName:a.string.isRequired};var k=t(35418),T=t(97768),H=t(45416),q=t(96216),A=t(2845),E=function(n){var e,t,i,o,a=n.job,c=n.numberPrefix,u=n.numberSuffix,d=(0,A.x)().hasRole;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(I.Z,{content:"Type",text:(null===(e=T.x.find(function(n){return n.value===a.type}))||void 0===e?void 0:e.text)||"-"}),(0,r.jsx)(I.Z,{content:"Order",text:(0,r.jsx)(H.D,{id:a.id,number:a.number,invoiceNumber:null==a?void 0:null===(t=a.invoices)||void 0===t?void 0:null===(i=t[0])||void 0===i?void 0:i.invoiceNumber,type:a.type,numberPrefix:c,numberSuffix:u,isQuote:a.quoted})}),d("admin")&&a.source&&(0,r.jsx)(I.Z,{content:"Source",text:null===(o=q.Y.find(function(n){return n.value===a.source}))||void 0===o?void 0:o.text})]})};function R(){var n=(0,i.Z)(["\n  background-color: #fff;\n  border: 1px solid #eee;\n  box-shadow: rgba(45, 62, 80, 0.12) 0 1px 5px 0;\n  margin-bottom: 0.5rem;\n  padding: 1rem 0;\n"]);return R=function(){return n},n}function D(){var n=(0,i.Z)(["\n  font-size: 1rem;\n  margin-top: 0.5rem;\n"]);return D=function(){return n},n}function z(){var n=(0,i.Z)(["\n  font-size: 0.9rem;\n  margin-top: 0.5rem;\n"]);return z=function(){return n},n}function M(){var n=(0,i.Z)(["\n  margin-bottom: 1rem;\n"]);return M=function(){return n},n}function F(){var n=(0,i.Z)(["\n  margin-right: 0.5rem;\n"]);return F=function(){return n},n}function $(){var n=(0,i.Z)(["\n  display: inline;\n"]);return $=function(){return n},n}function O(){var n=(0,i.Z)(["\n  display: flex;\n  justify-content: center;\n"]);return O=function(){return n},n}function Q(){var n=(0,i.Z)(["\n  cursor: pointer;\n"]);return Q=function(){return n},n}E.propTypes={job:a.object,numberPrefix:a.string,numberSuffix:a.string},E.defaultProps={numberPrefix:"",numberSuffix:""};var U=function(n){var e=n.avatar,t=n.editable,i=n.entity,a=n.entityName,c=n.icons,x=n.job,y=n.linkTitleTo,h=n.log,b=n.numberPrefix,j=n.numberSuffix,g=n.prefix,Z=(0,o.useContext)(u.Z),_=(0,o.useState)(e),w=_[0],N=_[1],I=function(n){Z.close(),(null==n?void 0:n.filename)?N("".concat("https://cleverly-pre-prod-media.s3.eu-west-2.amazonaws.com","/").concat(null==n?void 0:n.filename)):N(null)},P=function(){Z.show({content:(0,r.jsx)(k.G,{category:"avatar",entity:a,entityId:null==i?void 0:i.id,filters:{category:"avatar"},limit:1,onMediaAdd:I,onMediaRemove:I,type:"image"}),title:"Avatar"})},C=function(){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(X,{context:"primary",icon:"building"}),y?(0,r.jsx)(B,{border:!1,passHref:!0,to:y,children:null==i?void 0:i.name}):null==i?void 0:i.name]})},T=function(){Z.show({content:(0,r.jsx)(S,{entityId:Number(null==h?void 0:h.entityId),entityName:null==h?void 0:h.entityName}),submit:!1,title:"Log Details",width:"50%"})};return(0,r.jsxs)(G,{children:[(0,r.jsx)(d.Z,{children:(0,r.jsxs)(l.Z,{children:[(0,r.jsx)(s.Z,{md:3,children:(0,r.jsx)(m.Z,{action:t?"Edit":null,actionClick:P,content:(null==i?void 0:i.name)||"test",context:"primary",gmail:null==i?void 0:i.email,src:w})}),(0,r.jsxs)(s.Z,{md:9,children:[(0,r.jsx)(L,{content:(0,r.jsx)(C,{}),noMargin:!0}),(null==i?void 0:i.description)&&(0,r.jsx)(Y,{content:null==i?void 0:i.description,noMargin:!0}),(null==i?void 0:i.website)&&(0,r.jsxs)(V,{href:null==i?void 0:i.website,rel:"nofollow noopener noreferrer",target:"_blank",children:[(0,r.jsx)(X,{context:"primary",icon:"window-maximize"}),"Visit website"]})]}),x&&(0,r.jsx)(s.Z,{md:12,children:(0,r.jsx)(E,{job:x,numberPrefix:b,numberSuffix:j})})]})}),(0,r.jsx)(f.Z,{marginTop:"sm"}),c&&(0,r.jsxs)(J,{children:[c.map(function(n){var e=n.icon,t=n.onClick,i=n.to;return(0,r.jsxs)("div",{children:[t&&(0,r.jsx)(K,{onClick:t,children:(0,r.jsx)(v.Z,{icon:e,prefix:g})}),i&&(0,r.jsx)(p.Z,{border:!1,passHref:!0,to:i,children:(0,r.jsx)(v.Z,{icon:e,prefix:g})})]},e)}),h&&(0,r.jsx)(K,{onClick:T,children:(0,r.jsx)(v.Z,{icon:"history",size:"lg"})})]})]})},G=c.ZP.div.withConfig({displayName:"profileHeader__StyledHeader",componentId:"sc-35c52c2f-0"})(R()),L=(0,c.ZP)(x.Z).withConfig({displayName:"profileHeader__StyledHeading",componentId:"sc-35c52c2f-1"})(D()),Y=(0,c.ZP)(x.Z).withConfig({displayName:"profileHeader__StyledDescription",componentId:"sc-35c52c2f-2"})(z()),V=c.ZP.a.withConfig({displayName:"profileHeader__StyledLink",componentId:"sc-35c52c2f-3"})(M()),X=(0,c.ZP)(y.Z).withConfig({displayName:"profileHeader__StyledIcon",componentId:"sc-35c52c2f-4"})(F()),B=(0,c.ZP)(p.Z).withConfig({displayName:"profileHeader__StyledTitle",componentId:"sc-35c52c2f-5"})($()),J=c.ZP.div.withConfig({displayName:"profileHeader__StyledIconContainer",componentId:"sc-35c52c2f-6"})(O()),K=c.ZP.div.withConfig({displayName:"profileHeader__Click",componentId:"sc-35c52c2f-7"})(Q());U.propTypes={avatar:a.string,editable:a.bool,entity:a.object.isRequired,entityName:a.string.isRequired,icons:a.array,job:a.object,linkTitleTo:a.string,log:a.object,prefix:a.string,numberPrefix:a.string,numberSuffix:a.string},U.defaultProps={avatar:"",editable:!0,numberPrefix:"",numberSuffix:""}},97768:function(n,e,t){"use strict";t.d(e,{x:function(){return i}});var i=[{text:"Reactive",value:"reactive",context:"#2EE6CA"},{text:"Planned Maintenance",value:"ppm",context:"#D67EFF"},{text:"Quote",value:"quote",context:"#7D7"},{text:"Compliance",value:"cppm",context:"#CC7429"}]},96216:function(n,e,t){"use strict";t.d(e,{Y:function(){return i}});var i=[{text:"Select...",value:""},{text:"Call",value:"call"},{text:"Email",value:"email"},{text:"Portal",value:"portal"},{text:"Other",value:"other"}]},36502:function(n,e,t){"use strict";t.r(e),t.d(e,{default:function(){return b}});var i=t(85893),r=t(19076),o=t(11163),a=t(6812),c=t(7297),u=t(75063);function d(){var n=(0,c.Z)(["\n  query GetAdmin($id: Int!) {\n    admin: Account_by_pk(id: $id) {\n      id\n      name\n      type\n      media: Media {\n        id\n        medium: Medium {\n          id\n          category\n          filename\n          meta\n          type\n        }\n      }\n    }\n  }\n"]);return d=function(){return n},n}var l=(0,u.Ps)(d()),s=t(9270),m=t(62140),f=t(20402),v=t(71225),p=t(4380),x=t(2845),y=t(8299),h=function(){var n=(0,o.useRouter)().query,e=(0,x.x)(),t=e.hasRole,r=e.user,c=null;t("superadmin")&&n.id?c=parseInt(n.id):t(["admin","superadmin"])&&r.accountId&&(c=r.accountId);var u=(0,a.a)(l,{skip:!c,variables:{id:c}}),d=u.loading,h=u.data,b=(void 0===h?{admin:{}}:h).admin;return d||!c?null:(0,i.jsx)(s.Z,{children:(0,i.jsxs)(m.Z,{md:12,children:[(0,i.jsx)(s.Z,{children:(0,i.jsx)(m.Z,{md:4,children:(0,i.jsx)(p.g,{avatar:(0,v.Q)(b.media),entity:b,entityName:"Account",icons:t(["admin","superadmin"])?(0,f.Y)(b):[]})})}),(0,i.jsx)(y.P,{accountType:"admin",filters:{accountId:c}})]})})},b=function(){return(0,i.jsx)(r.Z,{View:(0,i.jsx)(h,{})})}}},function(n){n.O(0,[3662,367,2283,212,619,8890,2583,4135,8579,6043,1564,4244,1336,3911,3776,5370,2329,778,6540,4046,1023,1870,2797,653,1207,8660,8344,6733,61,9774,2888,179],function(){return n(n.s=51332)}),_N_E=n.O()}]);