(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3731,4972],{34193:function(e,n,t){"use strict";var r=t(64836);n.Z=void 0;var i=r(t(64938)),o=t(85893);n.Z=(0,i.default)((0,o.jsx)("path",{d:"m12 5.69 5 4.5V18h-2v-6H9v6H7v-7.81zM12 3 2 12h3v8h6v-6h2v6h6v-8h3z"}),"HomeOutlined")},81261:function(e,n,t){"use strict";var r=t(64836);n.Z=void 0;var i=r(t(64938)),o=t(85893);n.Z=(0,i.default)((0,o.jsx)("path",{d:"M2 20h20v-4H2zm2-3h2v2H4zM2 4v4h20V4zm4 3H4V5h2zm-4 7h20v-4H2zm2-3h2v2H4z"}),"Storage")},58951:function(e,n,t){"use strict";t.d(n,{Z:function(){return b}});var r=t(63366),i=t(87462),o=t(67294),a=t(63961),s=t(58510),u=t(90948),c=t(14136),l=t(71657),d=t(15861),f=t(1977),h=t(8027);function m(e){return(0,h.ZP)("MuiDialogContentText",e)}(0,f.Z)("MuiDialogContentText",["root"]);var p=t(85893);let v=["children","className"],g=e=>{let{classes:n}=e,t=(0,s.Z)({root:["root"]},m,n);return(0,i.Z)({},n,t)},y=(0,u.ZP)(d.Z,{shouldForwardProp:e=>(0,c.Z)(e)||"classes"===e,name:"MuiDialogContentText",slot:"Root",overridesResolver:(e,n)=>n.root})({}),_=o.forwardRef(function(e,n){let t=(0,l.Z)({props:e,name:"MuiDialogContentText"}),{className:o}=t,s=(0,r.Z)(t,v),u=g(s);return(0,p.jsx)(y,(0,i.Z)({component:"p",variant:"body1",color:"text.secondary",ref:n,ownerState:s,className:(0,a.Z)(u.root,o)},t,{classes:u}))});var b=_},37645:function(e,n,t){"use strict";var r=t(87462),i=t(63366),o=t(67294),a=t(63961),s=t(58510),u=t(15861),c=t(90948),l=t(71657),d=t(4472),f=t(34182),h=t(85893);let m=["className","id"],p=e=>{let{classes:n}=e;return(0,s.Z)({root:["root"]},d.a,n)},v=(0,c.ZP)(u.Z,{name:"MuiDialogTitle",slot:"Root",overridesResolver:(e,n)=>n.root})({padding:"16px 24px",flex:"0 0 auto"}),g=o.forwardRef(function(e,n){let t=(0,l.Z)({props:e,name:"MuiDialogTitle"}),{className:s,id:u}=t,c=(0,i.Z)(t,m),d=p(t),{titleId:g=u}=o.useContext(f.Z);return(0,h.jsx)(v,(0,r.Z)({component:"h2",className:(0,a.Z)(d.root,s),ownerState:t,ref:n,variant:"h6",id:null!=u?u:g},c))});n.Z=g},26186:function(e,n,t){"use strict";var r=t(34613),i=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=new Date(e),i=t.getFullYear(),o=""+(t.getMonth()+1),a=""+t.getDate();o.length<2&&(o="0"+o),a.length<2&&(a="0"+a);var s=[i,o,a].join("-");return n?s+" "+(0,r.Z)(e):s};n.Z=i},34613:function(e,n){"use strict";var t=function(e){var n=new Date(e),t=""+n.getHours(),r=""+n.getMinutes();return t.length<2&&(t="0"+t),r.length<2&&(r="0"+r),"".concat(t,":").concat(r)};n.Z=t},30845:function(e,n){"use strict";var t=Number.isNaN||function(e){return"number"==typeof e&&e!=e};function r(e,n){return!!(e===n||t(e)&&t(n))}function i(e,n){if(e.length!==n.length)return!1;for(var t=0;t<e.length;t++)if(!r(e[t],n[t]))return!1;return!0}n.Z=function(e,n){void 0===n&&(n=i);var t,r,o=[],a=!1;return function(){for(var i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];return a&&t===this&&n(i,o)||(r=e.apply(this,i),a=!0,t=this,o=i),r}}},61400:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/issues",function(){return t(51504)}])},5336:function(e,n,t){"use strict";t.d(n,{C:function(){return j}});var r=t(85893),i=t(67294),o=t(45697),a=t.n(o),s=t(93946),u=t(25464),c=t(18972),l=t(57976),d=t(73890),f=t(69008),h=t(41687),m=t(60888),p=t(40535),v=t(63441),g=t(41733),y=t(77957),_=t(2548),b=t(24519),x=t(2391),I=t(69308),$=t(79369),q=t(22961),Z=t(28201),S=t(51233),C=t(15861),w={add:(0,r.jsx)(h.Z,{}),archive:(0,r.jsx)(d.Z,{}),avatar:(0,r.jsx)(Z.Z,{}),check:(0,r.jsx)(m.Z,{}),delete:(0,r.jsx)(g.Z,{}),description:(0,r.jsx)(p.Z,{}),download:(0,r.jsx)(v.Z,{}),info:(0,r.jsx)(_.Z,{}),edit:(0,r.jsx)(y.Z,{}),location:(0,r.jsx)(I.Z,{}),unarchive:(0,r.jsx)(f.Z,{}),uploadFile:(0,r.jsx)(b.Z,{}),receipt:(0,r.jsx)(x.Z,{}),visibility:(0,r.jsx)(q.Z,{})},k={default:(0,r.jsx)(l.Z,{}),defaultHoriz:(0,r.jsx)($.Z,{}),description:(0,r.jsx)(p.Z,{})},j=function(e){var n=e.actionsData,t=e.icon,o=e.row,a=e.disabled,l=(0,i.useState)(null),d=l[0],f=l[1],h=function(e){e.stopPropagation(),f(e.currentTarget)},m=function(){f(null)};return(0,r.jsxs)("div",{children:[(0,r.jsx)(s.Z,{sx:{":hover":{backgroundColor:"#DDDDDD"}},disabled:a,"aria-controls":"simple-menu","aria-haspopup":"true",onClick:h,children:k[t]}),(0,r.jsx)(u.Z,{id:"simple-menu",anchorEl:d,keepMounted:!0,open:Boolean(d),onClose:m,PaperProps:{sx:{borderRadius:2}},children:n(o).map(function(e,n){return(0,r.jsx)(c.Z,{disabled:e.disabled,onClick:function(n){e.onClick(n),m()},sx:{pl:3,pr:4},children:(0,r.jsxs)(S.Z,{direction:"row",alignItems:"center",spacing:2,children:[(null==w?void 0:w[e.icon])||null,(0,r.jsx)(C.Z,{children:e.tooltip})]})},n)})})]})};j.propTypes={actionsData:a().func.isRequired,icon:a().oneOf(["default","description"]),row:a().any.isRequired,disabled:a().bool},j.defaultProps={actionsData:function(){return[{disabled:!1,onClick:function(){},icon:"edit",tooltip:"Edit"}]},icon:"default",disabled:!1}},78232:function(e,n,t){"use strict";t.d(n,{F:function(){return C}});var r=t(14924),i=t(26042),o=t(69396),a=t(85893),s=t(45697),u=t.n(s),c=t(10166),l=t(80482),d=t(23776),f=t(98456),h=t(16143),m=t(50135),p=t(99534),v=t(29815),g=t(74061),y=t(6498),_=t(75438),b=t(15861),x=t(61730),I=t(67294),$=(0,I.createContext)({}),q=(0,I.forwardRef)(function(e,n){var t=(0,I.useContext)($);return(0,a.jsx)("div",(0,i.Z)({ref:n},e,t))}),Z=(0,I.forwardRef)(function(e,n){var t=e.children,r=(0,p.Z)(e,["children"]),i=[];t.forEach(function(e){i.push(e),i.push.apply(i,(0,v.Z)(e.children||[]))});var o,s,u=(0,y.u)(),c=(0,x.Z)(u.breakpoints.up("sm"),{noSsr:!0}),l=i.length,d=c?36:48,f=function(e){return e.hasOwnProperty("group")?48:d},h=(s=(0,I.useRef)(null),(0,I.useEffect)(function(){null!=s.current&&s.current.resetAfterIndex(0,!0)},[l]),s);return(0,a.jsx)("div",{ref:n,children:(0,a.jsx)($.Provider,{value:r,children:(0,a.jsx)(g.S_,{itemData:i,height:(l>8?8*d:i.map(f).reduce(function(e,n){return e+n},0))+16,width:"100%",ref:h,outerElementType:q,innerElementType:"ul",itemSize:function(e){return f(i[e])},overscanCount:5,itemCount:l,children:S})})})});function S(e){var n=e.data,t=e.index,r=e.style,s=n[t],u=(0,o.Z)((0,i.Z)({},r),{top:r.top+8});return s.hasOwnProperty("group")?(0,a.jsx)(_.Z,{component:"div",style:u,children:s.group},s.key):(0,a.jsx)(b.Z,(0,o.Z)((0,i.Z)({component:"li"},s[0]),{noWrap:!0,style:u,children:s[1].label}))}var C=function(e){var n=e.label,t=e.loading,r=e.placeholder,s=e.error,u=e.helperText,c=e.inputProps;return(0,a.jsx)(k,(0,o.Z)((0,i.Z)({},e),{disableListWrap:!0,PopperComponent:w,ListboxComponent:Z,renderInput:function(e){return(0,a.jsx)(m.Z,(0,o.Z)((0,i.Z)({},e,c),{error:s,helperText:u,label:n,placeholder:r,color:"secondary",variant:"standard",InputProps:(0,o.Z)((0,i.Z)({},e.InputProps,(null==c?void 0:c.InputProps)||{}),{endAdornment:(0,a.jsxs)(a.Fragment,{children:[t?(0,a.jsx)(f.Z,{color:"inherit",size:20}):null,e.InputProps.endAdornment]})})}))},renderOption:function(e,n,t){return[e,n,t.index]},renderGroup:function(e){return e}}))};C.defaultProps={value:null,onChange:function(){},label:"",loading:!1,error:!1,onOpen:function(){},options:[],inputProps:{},withoutSelectIcon:!1},C.propTypes={value:u().shape({value:u().any,label:u().string}),onChange:u().func,label:u().string,loading:u().bool,onOpen:u().func,options:u().arrayOf(u().shape({value:u().any,label:u().string})),inputProps:u().object,withoutSelectIcon:u().bool,inputValue:u().string,onInputChange:u().func};var w=(0,c.Z)(h.Z)((0,r.Z)({zIndex:"12000 !important"},"& .".concat(l.Z.listbox),{boxSizing:"border-box","& ul":{padding:0,margin:0}})),k=(0,c.Z)(d.Z)(function(e){var n=e.withoutSelectIcon;return{"& .MuiAutocomplete-root":{cursor:"pointer"},"& .MuiAutocomplete-popper":{zIndex:"12000 "},"& .MuiAutocomplete-endAdornment":{"& .MuiButtonBase-root.MuiIconButton-root.MuiAutocomplete-popupIndicator":{"& .MuiSvgIcon-root":(0,i.Z)({},n&&{display:"none"})}}}})},48580:function(e,n,t){"use strict";t.d(n,{q:function(){return m}});var r=t(26042),i=t(69396),o=t(99534),a=t(85893),s=t(87918),u=t(98456),c=t(23776),l=t(50135),d=t(67294),f=t(45697),h=t.n(f),m=function(e){var n=e.loading,t=e.setSearch,f=e.textFieldProps,h=(0,o.Z)(e,["loading","setSearch","textFieldProps"]),m=(0,d.useState)(""),p=m[0],v=m[1];return(0,d.useEffect)(function(){var e=setTimeout(function(){t(p)},500);return function(){return clearTimeout(e)}},[p,t]),(0,a.jsx)(c.Z,(0,i.Z)((0,r.Z)({isOptionEqualToValue:function(e,n){return e.value===n.value}},h),{loading:n,onInputChange:function(e,n){v(n)},getOptionLabel:function(e){return"".concat(e.label)},renderTags:function(e,n){return e.map(function(e,t){return(0,a.jsx)(s.Z,(0,r.Z)({size:"small",label:e.label},n({index:t})))})},renderInput:function(e){return(0,a.jsx)(l.Z,(0,i.Z)((0,r.Z)({},e,f),{InputProps:(0,i.Z)((0,r.Z)({},e.InputProps,f.InputProps||{}),{endAdornment:(0,a.jsxs)(a.Fragment,{children:[n?(0,a.jsx)(u.Z,{color:"inherit",size:20}):null,e.InputProps.endAdornment]})})}))}}))};m.defaultProps={color:"secondary",onChange:function(){},options:[],onOpen:function(){},setSearch:function(){},textFieldProps:{}},m.propTypes={multiple:h().bool,limitTags:h().number,filterSelectedOptions:h().bool,color:h().string,loading:h().bool,value:h().oneOf([h().array,h().object]),onChange:h().func,options:h().arrayOf(h().shape({value:h().any.isRequired,label:h().string.isRequired})).isRequired,onOpen:h().func,setSearch:h().func,textFieldProps:h().shape({label:h().string,variant:h().oneOf(["standard"]),color:h().string,error:h().bool,helperText:h().string})}},63855:function(e,n,t){"use strict";t.d(n,{h:function(){return R}});var r=t(26042),i=t(69396),o=t(828),a=t(29815),s=t(85893),u=t(67294),c=t(11057),l=t(69368),d=t(50480),f=t(11994),h=t(90629),m=t(51233),p=t(50135),v=t(5616),g=t(61730),y=t(45697),_=t.n(y),b=t(73359),x=t(6812),I=t(59938),$=t(42283),q=t(50459),Z=t(92148),S=t(2845),C=t(4972),w=t(10166),k=t(78232),j=t(33754),A=t(11163),P=t(57179),T=t(48580),R=function(e){var n=e.open,t=e.setOpen,f=e.initialFilters,h=(e.filters,e.setFilters),y=e.filtersVisibilityModel,_=void 0===y?{}:y,w=(0,S.x)(),j=w.hasRole,R=w.user,O=(0,A.useRouter)().query,L=(0,g.Z)("(max-width: 400px)"),U=(0,o.Z)((0,I.X)("form_data_issues_".concat(f.filterType),f),2),N=U[0],G=U[1],z=(0,$.cI)({defaultValues:N}),B=z.control,W=z.handleSubmit,H=z.register,Q=z.reset,J=z.watch,V=z.getValues,K=J("locationId"),Y=(0,u.useState)(""),X=Y[0],ee=Y[1],en=(0,o.Z)((0,b.t)(C.yR,{fetchPolicy:"network-only",variables:{accountId:R.accountId}}),2),et=en[0],er=en[1],ei=er.loading,eo=er.data,ea=(void 0===eo?{items:[]}:eo).items,es=(0,o.Z)((0,b.t)(C.SW),2),eu=es[0],ec=es[1],el=ec.loading,ed=ec.data,ef=(void 0===ed?{items:[]}:ed).items,eh=(0,o.Z)((0,b.t)(C._d,{variables:{where:{status:{_eq:"active"},Account_Locations:{accountId:{_eq:f.customerId}}}}}),2),em=eh[0],ep=eh[1],ev=ep.loading,eg=ep.data,ey=(void 0===eg?{items:[]}:eg).items,e_=(0,o.Z)((0,b.t)(C.zR,{variables:{locationId:null==K?void 0:K.value}}),2),eb=e_[0],ex=e_[1],eI=ex.loading,e$=ex.data,eq=(void 0===e$?{items:[]}:e$).items,eZ=(0,o.Z)((0,b.t)(C.by,{variables:{where:{type:{_eq:"supplier"}}}}),2),eS=eZ[0],eC=eZ[1],ew=eC.loading,ek=eC.data,ej=(void 0===ek?{items:[]}:ek).items,eA=(0,x.a)(C.K4,{variables:{accountId:R.accountId,limit:50,offset:0,q:""!==X?"%".concat(X,"%"):null}}),eP=eA.data,eT=(void 0===eP?{items:[]}:eP).items,eR=eA.loading,eD=function(e){try{var n,i,o,a,s,u,c,l,d,m={customerId:null===(n=e.customerId)||void 0===n?void 0:n.value,endDate:null==e?void 0:e.endDate,locationId:null===(i=e.locationId)||void 0===i?void 0:i.value,sublocationId:null===(o=e.sublocationId)||void 0===o?void 0:o.value,managerId:e.managerId?R.id:null,tags:null===(a=e.tags)||void 0===a?void 0:a.map(function(e){return e.value}),startDate:null==e?void 0:e.startDate,status:null===(s=e.status)||void 0===s?void 0:s.map(function(e){return e.value}),supplierId:null===(u=e.supplierId)||void 0===u?void 0:u.value,userId:null===(c=e.userId)||void 0===c?void 0:c.value,customerManagerId:null===(l=e.customerManager)||void 0===l?void 0:l.value},p=null==e?void 0:e.q;if(p){m.q="%".concat(p,"%")||0;var v=/^\d+$/.test(p);"id"in f&&(m.id=v?Number(p):null),"meta"in f&&(m.meta=v?{invoiceNumbers:[p]}:null),"jobNumber"in f&&(m.jobNumber=v?String(p):null,m.invoiceNumber=v?Number(p):null)}(null===(d=m.status)||void 0===d?void 0:d.length)&&(m.isChangedStatusSelect=!0),h(function(e){return(0,r.Z)({},e,m)});var g=V();G(function(e){return(0,r.Z)({},e,g)})}finally{t(!1)}},eM=function(){h(f),Q(f),sessionStorage.removeItem("form_data_issues_".concat(f.filterType)),t(!1)},eF=function(e){var n=!0;return e in _&&!_[e]&&(n=!1),n};return(0,s.jsx)(M,{keepMounted:!0,open:n,onClose:function(){return t(!1)},sx:D.modal,children:(0,s.jsx)("form",{onSubmit:W(eD),children:(0,s.jsx)(F,{children:(0,s.jsxs)(m.Z,{direction:"row",flexWrap:"wrap",justifyContent:"center",children:[(0,s.jsx)(p.Z,{fullWidth:!0,variant:"standard",color:"secondary",label:"Search...",name:"q",inputRef:H}),eF("status")&&(0,s.jsx)(v.Z,{sx:D.inputContainer(L),children:(0,s.jsx)($.Qr,{name:"status",control:B,render:function(e){var n=e.value,t=e.onChange;return(0,s.jsx)(k.F,{value:n||[],onChange:function(e,n){return t(n)},multiple:!0,limitTags:1,label:"Select status",options:(0,q.lR)(O.show)})}})}),j(["supplier"].concat((0,a.Z)(Z.n)))&&eF("user")&&(0,s.jsx)(v.Z,{sx:D.inputContainer(L),children:(0,s.jsx)($.Qr,{name:"userId",control:B,render:function(e){var n=e.value,t=e.onChange;return(0,s.jsx)(k.F,{value:n,onChange:function(e,n){return t(n)},label:"Select user",loading:ei,onOpen:function(){return et()},options:ea})}})}),j("admin")&&eF("tags")&&(0,s.jsx)(v.Z,{sx:D.inputContainer(L),children:(0,s.jsx)(P.r,{control:B})}),!f.customerId&&j("admin")&&eF("customer")&&(0,s.jsx)(v.Z,{sx:D.inputContainer(L),children:(0,s.jsx)($.Qr,{name:"customerId",control:B,render:function(e){var n=e.value,t=e.onChange;return(0,s.jsx)(k.F,{value:n,onChange:function(e,n){return t(n)},label:"Select customer",loading:el,onOpen:function(){return eu()},options:ef})}})}),j(["admin","customer"])&&eF("location")&&(0,s.jsx)(v.Z,{sx:D.inputContainer(L),children:(0,s.jsx)($.Qr,{name:"locationId",control:B,render:function(e){var n=e.value,t=e.onChange;return(0,s.jsx)(k.F,{value:n,onChange:function(e,n){return t(n)},label:"Select location",loading:ev,onOpen:function(){return em()},options:ey})}})}),j("admin")&&eF("supplier")&&(0,s.jsx)(v.Z,{sx:D.inputContainer(L),children:(0,s.jsx)($.Qr,{name:"supplierId",control:B,render:function(e){var n=e.value,t=e.onChange;return(0,s.jsx)(k.F,{value:n,onChange:function(e,n){return t(n)},label:"Select supplier",loading:ew,onOpen:function(){return eS()},options:ej})}})}),K&&j("admin")&&eF("sublocation")&&(0,s.jsx)(v.Z,{sx:D.inputContainer(L),children:(0,s.jsx)($.Qr,{name:"sublocationId",control:B,render:function(e){var n=e.value,t=e.onChange;return(0,s.jsx)(k.F,{value:n,onChange:function(e,n){return t(n)},label:"Select sublocation",loading:eI,onOpen:function(){return eb()},options:eq})}})}),(0,s.jsx)(v.Z,{sx:D.inputContainer(L),children:(0,s.jsx)($.Qr,{name:"startDate",control:B,render:function(e){return(0,s.jsx)(E,(0,i.Z)((0,r.Z)({},e),{label:"Start date",renderInput:function(e){return(0,s.jsx)(p.Z,(0,i.Z)((0,r.Z)({},e),{variant:"standard"}))}}))}})}),(0,s.jsx)(v.Z,{sx:D.inputContainer(L),children:(0,s.jsx)($.Qr,{name:"endDate",control:B,render:function(e){return(0,s.jsx)(E,(0,i.Z)((0,r.Z)({},e),{label:"End date",renderInput:function(e){return(0,s.jsx)(p.Z,(0,i.Z)((0,r.Z)({},e),{variant:"standard"}))}}))}})}),j((0,a.Z)(Z.SA))&&eF("accountManager")&&(0,s.jsx)(v.Z,{sx:D.inputContainer(L),children:(0,s.jsx)($.Qr,{name:"customerManager",control:B,render:function(e){var n=e.value,t=e.onChange;return(0,s.jsx)(T.q,{value:n,onChange:function(e,n){return t(n)},loading:eR,options:eT,setSearch:ee,textFieldProps:{color:"secondary",variant:"standard",label:"Select account manager"}})}})}),!f.noAssignToMeFilter&&j((0,a.Z)(Z.SA).concat((0,a.Z)(Z.n),(0,a.Z)(Z.nx)))&&eF("accountManager")&&(0,s.jsx)(v.Z,{sx:D.singleFilter(L),children:(0,s.jsx)($.Qr,{name:"managerId",control:B,render:function(e){var n=e.value,t=e.onChange;return(0,s.jsx)(d.Z,{control:(0,s.jsx)(l.Z,{color:"secondary",checked:n,onChange:function(e){return t(e.target.checked)}}),label:"Assigned to me"})}})}),(0,s.jsxs)(m.Z,{width:"100%",direction:"row",justifyContent:"flex-end",spacing:2,sx:D.bottomButtons,children:[(0,s.jsx)(c.Z,{variant:"contained",color:"danger",onClick:function(){return eM()},children:"Cancel"}),(0,s.jsx)(c.Z,{variant:"contained",color:"secondary",type:"submit",children:"Search"})]})]})})})})},D={modal:{width:"40%"},inputContainer:function(e){return(0,r.Z)({width:e?"100%":"50%"},e?{padding:"10px 0px"}:{padding:"10px"})},singleFilter:function(e){return(0,r.Z)({width:"100%"},e?{padding:"10px 0px"}:{padding:"10px"})},checkboxContainer:function(e){return(0,r.Z)({width:"100%"},e?{padding:"10px 0px"}:{padding:"10px"})},bottomButtons:{marginTop:"20px"}};R.defaultProps={open:!1,setOpen:function(){},initialFilters:{},filters:{},setFilters:function(){},filtersVisibilityModel:{}},R.propTypes={open:_().bool,setOpen:_().func,initialFilters:_().object,filters:_().object,setFilters:_().func,filtersVisibilityModel:_().object};var M=(0,w.Z)(f.Z)(function(){return{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%"}}),F=(0,w.Z)(h.Z)(function(){return{padding:"24px",maxWidth:"700px",maxHeight:"100vh",overflowY:"scroll"}}),E=(0,w.Z)(j.M)(function(){return{"&.MuiFormControl-root.MuiTextField-root":{width:"100%"}}})},4972:function(e,n,t){"use strict";t.d(n,{A5:function(){return ec},Ak:function(){return G},Cj:function(){return Y},K4:function(){return eo},Oq:function(){return eu},Qn:function(){return U},RJ:function(){return K},SW:function(){return L},T_:function(){return Q},UH:function(){return O},UM:function(){return er},Ve:function(){return X},_d:function(){return B},_f:function(){return ei},by:function(){return J},cz:function(){return M},he:function(){return N},j$:function(){return z},kB:function(){return en},kU:function(){return ee},kx:function(){return W},nD:function(){return E},nP:function(){return es},pY:function(){return ea},qd:function(){return F},t1:function(){return H},yR:function(){return V},zR:function(){return et}});var r=t(7297),i=t(75063);function o(){var e=(0,r.Z)(["\n  query GetAddressForSelect($q: String, $entity: String!, $entityId: Int!) {\n    items: Address(\n      where: {\n        Address_Entities: { entity: { _eq: $entity }, entityId: { _eq: $entityId } }\n        _or: [\n          { addressLine1: { _eq: $q } }\n          { addressLine2: { _eq: $q } }\n          { addressLine3: { _eq: $q } }\n          { county: { _eq: $q } }\n          { postCode: { _eq: $q } }\n          { city: { _eq: $q } }\n        ]\n      }\n    ) {\n      label: addressLine1\n      value: id\n      id\n      name\n      addressLine1\n      addressLine2\n      addressLine3\n      postCode\n      county\n      country: Country {\n        name\n      }\n      city\n      Address_Entities {\n        invoice\n      }\n    }\n  }\n"]);return o=function(){return e},e}function a(){var e=(0,r.Z)(["\n  query GetAccountsForSelect($q: String, $type: String, $limit: Int, $offset: Int) {\n    items: Account(\n      where: { name: { _ilike: $q }, type: { _eq: $type } }\n      limit: $limit\n      offset: $offset\n      order_by: { name: asc }\n    ) {\n      label: name\n      value: id\n    }\n  }\n"]);return a=function(){return e},e}function s(){var e=(0,r.Z)(['\n  query GetTaxonomy($q: String, $id: Int) {\n    items: Taxonomy(\n      where: { type: { _eq: "assetCategory" }, status: { _eq: "active" } }\n      order_by: { name: asc }\n    ) {\n      label: name\n      options: Taxonomies(\n        where: {\n          type: { _eq: "assetCategory" }\n          name: { _ilike: $q }\n          id: { _eq: $id }\n          status: { _eq: "active" }\n        }\n        order_by: { name: asc }\n      ) {\n        value: id\n        label: name\n      }\n    }\n  }\n']);return s=function(){return e},e}function u(){var e=(0,r.Z)(["\n  query GetAssetsForSelect(\n    $locationId: Int\n    $q: String\n    $categoryId: Int\n    $bookable: String\n    $limit: Int\n    $offset: Int\n  ) {\n    items: Asset(\n      where: {\n        categoryId: { _eq: $categoryId }\n        locationId: { _eq: $locationId }\n        name: { _ilike: $q }\n        bookable: { _eq: $bookable }\n      }\n      limit: $limit\n      offset: $offset\n      order_by: { name: asc }\n    ) {\n      label: name\n      value: id\n    }\n  }\n"]);return u=function(){return e},e}function c(){var e=(0,r.Z)(['\n  query GetCustomersForSelect($q: String, $limit: Int, $offset: Int) {\n    items: Account(\n      where: { name: { _ilike: $q }, type: { _eq: "customer" } }\n      limit: $limit\n      offset: $offset\n      order_by: { name: asc }\n    ) {\n      admin: Admins {\n        id: adminId\n      }\n      label: name\n      spendThreshold: meta(path: "$.finance.spendThreshold")\n      serviceRateLabour: meta(path: "$.finance.serviceRateLabour")\n      serviceRateExpenses: meta(path: "$.finance.serviceRateExpenses")\n      value: id\n    }\n  }\n']);return c=function(){return e},e}function l(){var e=(0,r.Z)(["\n  query GetJobsForSelect($_q: Int, $locationId: Int) {\n    items: Job(\n      where: {\n        Location: { id: { _eq: $locationId } }\n        _or: [{ id: { _eq: $_q } }, { Invoices: { id: { _eq: $_q } } }]\n      }\n      order_by: { title: asc }\n    ) {\n      label: label\n      value: id\n      number\n      createdAt\n      description\n      status\n      timingStart\n      title\n      type\n      Location {\n        name\n      }\n      Taxonomy {\n        Taxonomy {\n          shortJobDescription: name\n        }\n      }\n    }\n  }\n"]);return l=function(){return e},e}function d(){var e=(0,r.Z)(['\n  query GetManagersForSelect($userId: Int, $accountId: Int!, $q: String) {\n    items: User(\n      where: {\n        status: { _eq: "active" }\n        Account_Users: {\n          role: { _in: ["owner", "manager"] }\n          status: { _eq: "active" }\n          Account: { id: { _eq: $accountId } }\n        }\n        _or: [{ nameFirst: { _ilike: $q } }, { nameLast: { _ilike: $q } }]\n        id: { _neq: $userId }\n      }\n      order_by: { nameFirst: asc }\n    ) {\n      label: fullName\n      value: id\n    }\n  }\n']);return d=function(){return e},e}function f(){var e=(0,r.Z)(['\n  query GetManagersForSelect(\n    $userId: Int\n    $accountId: Int!\n    $q: String\n    $invoiceThreshold: numeric\n    $quoteThreshold: numeric\n  ) {\n    items: User(\n      where: {\n        status: { _eq: "active" }\n        Account_Users: {\n          role: { _in: ["owner", "manager"] }\n          status: { _eq: "active" }\n          Account: { id: { _eq: $accountId } }\n        }\n        _or: [{ nameFirst: { _ilike: $q } }, { nameLast: { _ilike: $q } }]\n        id: { _neq: $userId }\n        _and: [\n          {\n            _or: [\n              { invoiceThreshold: { _gt: $invoiceThreshold } }\n              { invoiceThreshold: { _is_null: true } }\n            ]\n          }\n          {\n            _or: [\n              { quoteThreshold: { _gt: $quoteThreshold } }\n              { quoteThreshold: { _is_null: true } }\n            ]\n          }\n        ]\n      }\n      order_by: { nameFirst: asc }\n    ) {\n      label: fullName\n      value: id\n    }\n  }\n']);return f=function(){return e},e}function h(){var e=(0,r.Z)(["\n  query GetPostCodeAreaForSelect($countryId: Int, $q: String) {\n    items: PostcodeArea(\n      where: { name: { _ilike: $q }, countryId: { _eq: $countryId } }\n      order_by: { name: asc }\n    ) {\n      area\n      label: name\n      value: id\n    }\n  }\n"]);return h=function(){return e},e}function m(){var e=(0,r.Z)(['\n  query GetPropertiesForSelect($where: Location_bool_exp, $limit: Int, $offset: Int) {\n    items: Location(where: $where, order_by: { name: asc }, limit: $limit, offset: $offset) {\n      label: name\n      value: id\n      access\n      permitsRequired\n      registeredAddress: Addresses(\n        where: { entity: { _eq: "Location" }, registered: { _eq: true } }\n      ) {\n        address: Address {\n          id\n          addressLine1\n          addressLine2\n          addressLine3\n          county\n          country: Country {\n            name\n          }\n          postCode\n          city\n        }\n      }\n    }\n  }\n']);return m=function(){return e},e}function p(){var e=(0,r.Z)(['\n  query GetServicesForSelect($q: String, $limit: Int, $offset: Int) {\n    items: Service(\n      where: { name: { _ilike: $q }, status: { _eq: "active" } }\n      limit: $limit\n      offset: $offset\n      order_by: { name: asc }\n    ) {\n      label: name\n      value: id\n    }\n  }\n']);return p=function(){return e},e}function v(){var e=(0,r.Z)(["\n  query GetSlasForSelect($q: String, $adminId: Int, $type: String) {\n    items: SLA(\n      where: { name: { _ilike: $q }, type: { _eq: $type }, adminId: { _eq: $adminId } }\n      order_by: { name: asc }\n    ) {\n      label: name\n      value: id\n    }\n  }\n"]);return v=function(){return e},e}function g(){var e=(0,r.Z)(["\n  query GetSlasForSelectNew($where: SLA_bool_exp, $limit: Int, $offset: Int) {\n    items: SLA(where: $where, order_by: { name: asc }, limit: $limit, offset: $offset) {\n      label: name\n      value: id\n    }\n  }\n"]);return g=function(){return e},e}function y(){var e=(0,r.Z)(["\n  query GetSuppliersForSelect($where: Account_bool_exp, $limit: Int, $offset: Int) {\n    items: Account(where: $where, limit: $limit, offset: $offset, order_by: { name: asc }) {\n      label: name\n      value: id\n    }\n  }\n"]);return y=function(){return e},e}function _(){var e=(0,r.Z)(['\n  query GetUsersForSelect($accountId: Int, $q: String, $limit: Int, $offset: Int) {\n    items: User(\n      where: {\n        status: { _eq: "active" }\n        Account_Users: {\n          accountId: { _eq: $accountId }\n          isContact: { _eq: true }\n          status: { _eq: "active" }\n        }\n        _or: [{ nameFirst: { _ilike: $q } }, { nameLast: { _ilike: $q } }]\n      }\n      order_by: { nameFirst: asc }\n      limit: $limit\n      offset: $offset\n    ) {\n      label: fullName\n      value: id\n      email\n      phone\n    }\n  }\n']);return _=function(){return e},e}function b(){var e=(0,r.Z)(['\n  query GetUsersForSelect($q: String) {\n    items: User(\n      where: {\n        status: { _eq: "active" }\n        _or: [{ nameFirst: { _ilike: $q } }, { nameLast: { _ilike: $q } }]\n      }\n      order_by: { nameFirst: asc }\n    ) {\n      label: fullName\n      value: id\n      email\n      phone\n    }\n  }\n']);return b=function(){return e},e}function x(){var e=(0,r.Z)(["\n  query GetTaxonomyGroupForSelect($q: String, $type: String!) {\n    items: Taxonomy(\n      where: { isGroup: { _eq: true }, name: { _ilike: $q }, type: { _eq: $type } }\n      order_by: { name: asc }\n    ) {\n      label: name\n      value: id\n    }\n  }\n"]);return x=function(){return e},e}function I(){var e=(0,r.Z)(['\n  query GetTaxonomy($q: String) {\n    items: Taxonomy(where: { type: { _eq: "expenseCategoryGroup" } }, order_by: { name: asc }) {\n      label: name\n      options: Taxonomies(\n        where: { type: { _eq: "expenseCategory" }, name: { _ilike: $q } }\n        order_by: { name: asc }\n      ) {\n        value: id\n        label: name\n      }\n    }\n  }\n']);return I=function(){return e},e}function $(){var e=(0,r.Z)(['\n  query GetCompliancesForSelect($q: String, $locationId: Int, $limit: Int, $offset: Int) {\n    items: Taxonomy(\n      where: { type: { _eq: "complianceCategory" } }\n      order_by: { name: asc }\n      limit: $limit\n      offset: $offset\n    ) {\n      label: name\n      options: Compliances(\n        where: {\n          name: { _ilike: $q }\n          Compliance_Entities: { Location: { id: { _eq: $locationId } } }\n        }\n        order_by: { name: asc }\n      ) {\n        value: id\n        label: name\n      }\n    }\n  }\n']);return $=function(){return e},e}function q(){var e=(0,r.Z)(["\n  query GetUserRole($userId: Int!, $accountId: Int!) {\n    accountUsers: Account_User(\n      where: { userId: { _eq: $userId }, accountId: { _eq: $accountId } }\n    ) {\n      role\n    }\n  }\n"]);return q=function(){return e},e}function Z(){var e=(0,r.Z)(["\n  query GetSublocationsForSelect($locationId: Int!, $q: String, $limit: Int, $offset: Int) {\n    items: Sublocation(\n      where: { name: { _ilike: $q }, locationId: { _eq: $locationId }, active: { _eq: true } }\n      limit: $limit\n      offset: $offset\n      order_by: { createdAt: desc }\n    ) {\n      value: id\n      label: name\n    }\n  }\n"]);return Z=function(){return e},e}function S(){var e=(0,r.Z)(['\n  query GetTaxonomy($q: String, $limit: Int, $offset: Int) {\n    items: Taxonomy(\n      where: {\n        type: { _eq: "assetCategory" }\n        isGroup: { _eq: false }\n        status: { _eq: "active" }\n        name: { _ilike: $q }\n      }\n      limit: $limit\n      offset: $offset\n      order_by: { name: asc }\n    ) {\n      label: name\n      value: id\n    }\n  }\n']);return S=function(){return e},e}function C(){var e=(0,r.Z)(["\n  query GetTaxonomyForSelect(\n    $where: Taxonomy_bool_exp\n    $limit: Int\n    $offset: Int\n    $orderBy: Taxonomy_order_by!\n    $includeMeta: Boolean! = false\n  ) {\n    items: Taxonomy(where: $where, limit: $limit, offset: $offset, order_by: [$orderBy]) {\n      value: id\n      label: name\n      meta @include(if: $includeMeta)\n    }\n  }\n"]);return C=function(){return e},e}function w(){var e=(0,r.Z)(['\n  query GetTagsForTask($q: String!, $limit: Int = 50, $offset: Int = 0) {\n    items: Taxonomy(\n      where: { name: { _ilike: $q }, status: { _eq: "active" }, type: { _eq: "taskTags" } }\n      limit: $limit\n      offset: $offset\n      order_by: { id: desc }\n    ) {\n      value: id\n      label: name\n    }\n  }\n']);return w=function(){return e},e}function k(){var e=(0,r.Z)(['\n  query GetTagsForEntity(\n    $entityId: Int\n    $entity: String!\n    $q: String!\n    $limit: Int = 50\n    $offset: Int = 0\n  ) {\n    tags: Taxonomy(\n      where: {\n        name: { _ilike: $q }\n        status: { _eq: "active" }\n        type: { _eq: "taskTags" }\n        _not: { Taxonomy_Entities: { entity: { _eq: $entity }, entityId: { _eq: $entityId } } }\n      }\n      limit: $limit\n      offset: $offset\n      order_by: { id: desc }\n    ) {\n      id\n      name\n      meta\n    }\n  }\n']);return k=function(){return e},e}function j(){var e=(0,r.Z)(['\n  query GetEntityTags($entityId: Int!, $entity: String!) {\n    tags: Taxonomy_Entity(\n      where: {\n        entity: { _eq: $entity }\n        entityId: { _eq: $entityId }\n        Taxonomy: { status: { _eq: "active" }, type: { _eq: "taskTags" } }\n      }\n      order_by: { id: desc }\n    ) {\n      id\n      tag: Taxonomy {\n        id\n        name\n        meta\n      }\n    }\n  }\n']);return j=function(){return e},e}function A(){var e=(0,r.Z)(["\n  query GetCustomerManagers($accountId: Int, $q: String, $limit: Int, $offset: Int) {\n    items: User(\n      where: { Account_Users: { accountId: { _eq: $accountId } }, fullName: { _ilike: $q } }\n      order_by: { fullName: asc }\n      limit: $limit\n      offset: $offset\n    ) {\n      label: fullName\n      value: id\n    }\n  }\n"]);return A=function(){return e},e}function P(){var e=(0,r.Z)(["\n  query GetServiceSchedulesForSelect(\n    $q: String\n    $serviceId: Int\n    $entity: service_schedule_entity\n    $entityId: Int\n    $limit: Int = 50\n    $offset: Int = 0\n  ) {\n    items: ServiceSchedule(\n      where: {\n        name: { _ilike: $q }\n        serviceId: { _eq: $serviceId }\n        entity: { _eq: $entity }\n        entityId: { _eq: $entityId }\n      }\n      limit: $limit\n      offset: $offset\n      order_by: { name: asc }\n    ) {\n      label: name\n      value: id\n    }\n  }\n"]);return P=function(){return e},e}function T(){var e=(0,r.Z)(['\n  query GetPropertyById($id: Int!) {\n    item: Location_by_pk(id: $id) {\n      label: name\n      value: id\n      access\n      registeredAddress: Addresses(\n        where: { entity: { _eq: "Location" }, registered: { _eq: true } }\n      ) {\n        address: Address {\n          id\n          addressLine1\n          addressLine2\n          addressLine3\n          county\n          country: Country {\n            name\n            code\n          }\n          postCode\n          city\n        }\n      }\n    }\n  }\n']);return T=function(){return e},e}function R(){var e=(0,r.Z)(['\n  query GetCompliancesForSelectNew($q: String, $locationId: Int, $limit: Int, $offset: Int) {\n    items: Compliance(\n      where: {\n        name: { _ilike: $q }\n        Category: { type: { _eq: "complianceCategory" } }\n        Compliance_Entities: { entity: { _eq: "Location" }, Location: { id: { _eq: $locationId } } }\n      }\n      order_by: { name: asc }\n      limit: $limit\n      offset: $offset\n    ) {\n      value: id\n      label: name\n      category: Category {\n        label: name\n      }\n    }\n  }\n']);return R=function(){return e},e}function D(){var e=(0,r.Z)(['\n  query GetTaskAssignedToForSelect(\n    $accountId: Int\n    $q: String\n    $limit: Int = 50\n    $offset: Int = 0\n  ) {\n    items: User(\n      where: {\n        status: { _eq: "active" }\n        Account_Users: { accountId: { _eq: $accountId }, status: { _eq: "active" } }\n        _or: [{ nameFirst: { _ilike: $q } }, { nameLast: { _ilike: $q } }]\n      }\n      limit: $limit\n      offset: $offset\n      order_by: { nameFirst: asc }\n    ) {\n      label: fullName\n      value: id\n    }\n  }\n']);return D=function(){return e},e}var M=(0,i.Ps)(o()),F=(0,i.Ps)(a()),E=(0,i.Ps)(s()),O=(0,i.Ps)(u()),L=(0,i.Ps)(c()),U=(0,i.Ps)(l()),N=(0,i.Ps)(d()),G=(0,i.Ps)(f()),z=(0,i.Ps)(h()),B=(0,i.Ps)(m()),W=(0,i.Ps)(p()),H=(0,i.Ps)(v()),Q=(0,i.Ps)(g()),J=(0,i.Ps)(y()),V=(0,i.Ps)(_()),K=(0,i.Ps)(b()),Y=(0,i.Ps)(x()),X=(0,i.Ps)(I()),ee=(0,i.Ps)($()),en=(0,i.Ps)(q()),et=(0,i.Ps)(Z()),er=(0,i.Ps)(S()),ei=(0,i.Ps)(C());(0,i.Ps)(w()),(0,i.Ps)(k()),(0,i.Ps)(j());var eo=(0,i.Ps)(A()),ea=(0,i.Ps)(P()),es=(0,i.Ps)(T()),eu=(0,i.Ps)(R()),ec=(0,i.Ps)(D())},15033:function(e,n,t){"use strict";t.d(n,{i:function(){return Z}});var r=t(14924),i=t(26042),o=t(69396),a=t(85893),s=t(67294),u=t(11163),c=t(45697),l=t.n(c),d=t(61870),f=t(5616),h=t(51233),m=t(15861),p=t(90948),v=t(41796),g=t(29217),y=t(45111),_=t(46003),b=t(70872),x=t(58886),I=t(61730),$=function(e){var n=e.currentPage,t=e.totalCount,r=e.pageSize,o=e.onPageChange,s=(0,I.Z)("(max-width:400px)"),u=(0,I.Z)("(max-width:500px)");return(0,a.jsx)(q,{mb:2,page:n,count:Math.ceil(t/r),onChange:function(e,n){return o(n)},variant:"outlined",shape:"rounded",size:s?"small":"medium",hidePrevButton:1===n,hideNextButton:n===Math.ceil(t/r),siblingCount:u?0:1,renderItem:function(e){return(0,a.jsx)(x.Z,(0,i.Z)({slots:{previous:function(){return"Previous"},next:function(){return"Next"}}},e))}})};$.defaultProps={currentPage:1,totalCount:0,pageSize:50,onPageChange:function(){}},$.propTypes={currentPage:l().number,totalCount:l().number,pageSize:l().number,onPageChange:l().func};var q=(0,p.ZP)(b.Z)(function(e){var n,t=e.hidePrevButton,o=e.hideNextButton,a=e.theme;return n={},(0,r.Z)(n,"&.MuiPagination-root",{alignSelf:"center",marginTop:"16px"}),(0,r.Z)(n,"& .MuiPaginationItem-root",{fontWeight:600,margin:0,borderRadius:0}),(0,r.Z)(n,"& .MuiPagination-ul > li:last-child .MuiPaginationItem-previousNext:last-child",{margin:0,borderRadius:"0 5px 5px 0"}),(0,r.Z)(n,"& .MuiPagination-ul > li:first-child .MuiPaginationItem-previousNext:last-child",{margin:0,borderRadius:"5px 0 0 5px"}),(0,r.Z)(n,"& button.Mui-selected",(0,i.Z)({color:a.palette.white.main,backgroundColor:a.palette.secondary.main},o?{borderRadius:"0 5px 5px 0"}:{},t?{borderRadius:"5px 0 0 5px"}:{})),n}),Z=(0,s.forwardRef)(function(e,n){var t=e.columns,r=e.history,o=e.initialSort,c=e.meta,l=e.refetch,d=e.paginationSize,f=e.containerHeight,p=e.noResultsMessage,v=e.autoHeight,b=(0,u.useRouter)(),x=b.query,I=void 0===x?{}:x,q=(0,s.useState)(parseInt(null==I?void 0:I.page,10)||1),Z=q[0],w=q[1],k=(0,s.useState)(d||_.C1.paginationSize),j=k[0],A=k[1];o||(o={item:"createdAt",order:"desc"});var P=(0,s.useState)({item:o.item,order:o.order}),T=P[0],R=P[1],D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=b.query,t=void 0===n?{}:n;if(e>1?t.page=e:delete t.page,!(Object.keys(t).length>0))return{};var r=Object.keys(t).map(function(n){return"page"===n?"".concat(n,"=").concat(e):"".concat(n,"=").concat(t[n])}).join("&");return"?".concat(r)},M=function(){R({item:o.item,order:o.order}),w(1);var e=D();b.push(e),A(d||_.C1.paginationSize)};(0,s.useImperativeHandle)(n,function(){return{currentPage:Z,pageSize:j,sort:T,resetPagination:function(){M()}}});var F=function(e){var n=D(e);r&&b.push(n),w(e),!r&&l&&l()},E=function(e){e&&e.field&&e.sort?(R({item:t.find(function(n){return n.field===e.field}).sortName||e.field||e.item||o.item,order:e.sort||e.order||o.order}),l&&l()):(R({item:o.item,order:o.order}),l&&l())};return(0,a.jsxs)(S,{containerHeight:f,children:[(0,a.jsx)(C,(0,i.Z)({hideFooter:!0,disableColumnMenu:!0,disableSelectionOnClick:!0,autoHeight:v,sortingMode:"server",onSortModelChange:function(e){return E(e[0])},columns:t,pageSize:j,slots:{columnSortedAscendingIcon:function(){return(0,a.jsx)(g.Z,{})},columnSortedDescendingIcon:function(){return(0,a.jsx)(y.Z,{})},columnUnsortedIcon:function(){return(0,a.jsxs)(h.Z,{alignItems:"center",sx:{width:"33px"},children:[(0,a.jsx)(g.Z,{sx:{marginBottom:"-15px"}}),(0,a.jsx)(y.Z,{})]})},noResultsOverlay:function(){return(0,a.jsx)(h.Z,{height:"100%",alignItems:"center",justifyContent:"center",spacing:1,p:1,children:(0,a.jsx)(m.Z,{children:p})})},noRowsOverlay:function(){return(0,a.jsx)(h.Z,{height:"100%",alignItems:"center",justifyContent:"center",spacing:1,p:1,children:(0,a.jsx)(m.Z,{children:p})})}}},e)),c&&Math.ceil(c.aggregate.totalCount/j)>1&&(0,a.jsx)($,{currentPage:Z,totalCount:c.aggregate.totalCount,pageSize:j,onPageChange:F})]})});Z.propTypes={history:l().bool,initialSort:l().object,loading:l().bool,meta:l().object,refetch:l().func,paginationSize:l().number,noResultsMessage:l().string,columns:l().array.isRequired,rows:l().array.isRequired,autoHeight:l().bool},Z.defaultProps={columns:[],history:!1,loading:!1,rows:[],noResultsMessage:"There are no results.",autoHeight:!0};var S=(0,p.ZP)(f.Z)(function(e){return{height:e.containerHeight,display:"flex",flexDirection:"column"}}),C=(0,p.ZP)(d.s)(function(e){var n,t=e.theme,a=e.hideHeader,s=(e.rows,e.loading,e.rowHeight),u=e.isPdf;return n={"--DataGrid-overlayHeight":"40px"},(0,r.Z)(n,"&.MuiDataGrid-root",(0,i.Z)({color:t.palette.black.main,border:"none"},u&&{"@media print":{display:"block"}})),(0,r.Z)(n,"& .MuiDataGrid-main",(0,i.Z)({},u&&{"@media print":{overflow:"visible !important"}})),(0,r.Z)(n,"& .MuiDataGrid-columnHeaders",(0,o.Z)((0,i.Z)({},a&&{display:"none"}),{"& .MuiDataGrid-iconButtonContainer":{visibility:"visible","& .MuiButtonBase-root.MuiIconButton-root":{backgroundColor:"inherit",color:t.palette.black.main,"&:hover":{backgroundColor:"rgba(0, 0, 0, 0.1)"}}}})),(0,r.Z)(n,"& .MuiDataGrid-virtualScroller",(0,i.Z)({},a&&{marginTop:"0 !important"},u&&{"@media print":{overflow:"visible !important"}})),(0,r.Z)(n,"& .MuiDataGrid-iconSeparator",{opacity:0}),(0,r.Z)(n,"& .MuiDataGrid-columnHeaderTitle",{fontWeight:700}),(0,r.Z)(n,"& .MuiButtonBase-root.MuiDataGrid-columnHeaderTitle",{fontWeight:700}),(0,r.Z)(n,"& .MuiDataGrid-virtualScrollerContent",(0,i.Z)({},u&&{height:"initial !important",minHeight:"initial !important"})),(0,r.Z)(n,"& .MuiDataGrid-virtualScrollerRenderZone",(0,i.Z)({},u&&{position:"relative"})),(0,r.Z)(n,"& .MuiDataGrid-overlayWrapper",(0,r.Z)({},"& .MuiCircularProgress-root",{color:t.palette.secondary.main})),(0,r.Z)(n,"& .MuiDataGrid-row",(0,i.Z)({},u&&{minHeight:"".concat(s,"cm !important"),maxHeight:"".concat(s,"cm !important")})),(0,r.Z)(n,"& .MuiDataGrid-row > .MuiDataGrid-cell",(0,i.Z)({},u&&{minHeight:"".concat(s,"cm !important"),maxHeight:"".concat(s,"cm !important")})),(0,r.Z)(n,"& .MuiDataGrid-row.even",{backgroundColor:t.palette.muiLightGray.main,"&:hover, &.Mui-hovered":{backgroundColor:(0,v.Fq)(t.palette.muiLightGray.main,.3),"@media (hover: none)":{backgroundColor:"transparent"}},"&.Mui-selected":{backgroundColor:(0,v.Fq)(t.palette.muiLightGray.main,.3+t.palette.action.selectedOpacity),"&:hover, &.Mui-hovered":{backgroundColor:(0,v.Fq)(t.palette.muiLightGray.main,.3+t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:(0,v.Fq)(t.palette.muiLightGray.main,.3+t.palette.action.selectedOpacity)}}}}),n})},20705:function(e,n,t){"use strict";t.d(n,{x:function(){return l}});var r=t(14924),i=t(26042),o=t(69396),a=t(67294),s=t(96486),u=t(46003),c=function(e){try{return JSON.parse(e)}catch(n){return!1}},l=function(e){var n,t,l,d,f,h,m,p,v,g,y,_=e.filters,b=e.newFilters,x=e.initialSort,I=(0,a.useRef)(),$=(0,a.useState)({}),q=$[0],Z=$[1],S=(0,a.useState)({}),C=S[0],w=S[1],k=x||{item:"createdAt",order:"desc"},j=(0,r.Z)({},(null===(n=I.current)||void 0===n?void 0:n.sort.item)||k.item,k.inneritem?(0,r.Z)({},k.inneritem,(null===(t=I.current)||void 0===t?void 0:t.sort.order)||k.order):(null===(l=I.current)||void 0===l?void 0:l.sort.order)||k.order);return(0,a.useEffect)(function(){var e=!(0,s.isEqual)(q,_),n=!(0,s.isEqual)(C,b);if(e&&(Z(_),null==I||null===(r=I.current)||void 0===r||r.resetPagination()),n&&(w(b),null==I||null===(i=I.current)||void 0===i||i.resetPagination()),(null==I?void 0:null===(t=I.current)||void 0===t?void 0:t.setSort)&&!(e||n)){var t,r,i,o,a,u,c,l,d,f,h,m=(null===(o=I.current)||void 0===o?void 0:null===(a=o.sort)||void 0===a?void 0:a.item)&&(null===(u=I.current)||void 0===u?void 0:null===(c=u.sort)||void 0===c?void 0:c.order)?{item:null===(l=I.current)||void 0===l?void 0:null===(d=l.sort)||void 0===d?void 0:d.item,order:null===(f=I.current)||void 0===f?void 0:null===(h=f.sort)||void 0===h?void 0:h.order}:j;I.current.setSort(m)}},[_,b]),{initialData:(0,o.Z)((0,i.Z)({},_),{newFilters:(null==b?void 0:b.length)>0?b:void 0,limit:(null===(d=I.current)||void 0===d?void 0:d.pageSize)==="Infinity"?null:parseInt(null===(f=I.current)||void 0===f?void 0:f.pageSize,10)||u.C1.paginationSize,offset:((null===(h=I.current)||void 0===h?void 0:h.currentPage)-1||0)*((null===(m=I.current)||void 0===m?void 0:m.pageSize)||u.C1.paginationSize),orderBy:c(null===(p=I.current)||void 0===p?void 0:null===(v=p.sort)||void 0===v?void 0:null===(g=v.item)||void 0===g?void 0:g.replace(/ORDER/i,null===(y=I.current)||void 0===y?void 0:y.sort.order))||j}),initialSort:x,ref:I}}},66137:function(e,n,t){"use strict";t.d(n,{Y:function(){return r}});var r=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Job",t="";return(null==e?void 0:e.length)&&(t="\n      Taxonomy: {\n      _and: [\n        { entity: { _eq: ".concat(n,' } }\n        {\n          Taxonomy: {\n            status: { _eq: "active" }\n            _and: [{ id: { _in: [').concat(e,'] } }, { type: { _eq: "tags" } }]\n          }\n        }\n      ]\n    }\n  ')),t}},75327:function(e,n,t){"use strict";t.d(n,{$E:function(){return M},AX:function(){return q},I4:function(){return $},JA:function(){return S},MT:function(){return A},Px:function(){return w},WF:function(){return C},ZA:function(){return O},a8:function(){return k},fA:function(){return D},fo:function(){return Z},ge:function(){return E},iM:function(){return R},nE:function(){return P},nh:function(){return T},r1:function(){return j},tW:function(){return L},uz:function(){return F}});var r=t(7297),i=t(75063);function o(){var e=(0,r.Z)(["\n  mutation InsertAccountUser($objects: [Account_User_insert_input!]!) {\n    insert_Account_User(objects: $objects) {\n      returning {\n        id\n      }\n    }\n  }\n"]);return o=function(){return e},e}function a(){var e=(0,r.Z)(["\n  mutation UpdateUser(\n    $id: Int!\n    $accountUserId: Int!\n    $accountUserChanges: Account_User_set_input\n    $changes: User_set_input\n    $updateAccountUser: Boolean!\n  ) {\n    update_Account_User_by_pk(pk_columns: { id: $accountUserId }, _set: $accountUserChanges)\n      @include(if: $updateAccountUser) {\n      id\n    }\n    update_User_by_pk(pk_columns: { id: $id }, _set: $changes) {\n      id\n    }\n  }\n"]);return a=function(){return e},e}function s(){var e=(0,r.Z)(["\n  query GetUsers(\n    $accountId: Int\n    $accountType: String\n    $date: timestamptz\n    $limit: Int\n    $offset: Int\n    $q: String\n    $orderBy: User_order_by!\n    $status: String\n  ) {\n    users: User(\n      limit: $limit\n      offset: $offset\n      where: {\n        Account_Users: { Account: { id: { _eq: $accountId }, type: { _eq: $accountType } } }\n        createdAt: { _eq: $date }\n        _or: [\n          { email: { _ilike: $q } }\n          { nameFirst: { _ilike: $q } }\n          { nameLast: { _ilike: $q } }\n        ]\n        status: { _eq: $status }\n      }\n      order_by: [$orderBy]\n    ) {\n      id\n      name: nameFirst\n      nameFirst\n      nameLast\n      phone\n      status\n      email\n      createdAt\n      meta\n      invoiceThreshold\n      quoteThreshold\n      media: Media {\n        id\n        medium: Medium {\n          id\n          category\n          filename\n          meta\n          type\n        }\n      }\n      accounts: Account_Users {\n        id\n        role\n        position\n        isContact\n        status\n        account: Account {\n          id\n          name\n          type\n        }\n        userLocations: User_Account_Locations {\n          accountLocationId\n        }\n      }\n    }\n    meta: User_aggregate(\n      where: {\n        Account_Users: { Account: { id: { _eq: $accountId }, type: { _eq: $accountType } } }\n        createdAt: { _eq: $date }\n        _or: [{ nameFirst: { _ilike: $q } }, { nameLast: { _ilike: $q } }]\n        status: { _eq: $status }\n      }\n    ) {\n      aggregate {\n        totalCount: count\n      }\n    }\n  }\n"]);return s=function(){return e},e}function u(){var e=(0,r.Z)(["\n  query GetUser($id: Int!) {\n    user: User_by_pk(id: $id) {\n      id\n      fullName\n      name: nameFirst\n      nameFirst\n      nameLast\n      phone\n      status\n      email\n      createdAt\n      meta\n      invoiceThreshold\n      quoteThreshold\n      media: Media {\n        id\n        medium: Medium {\n          id\n          category\n          filename\n          meta\n          type\n        }\n      }\n      accounts: Account_Users {\n        id\n        role\n        position\n        isContact\n        status\n        account: Account {\n          id\n          name\n          type\n        }\n      }\n    }\n  }\n"]);return u=function(){return e},e}function c(){var e=(0,r.Z)(["\n  query CheckDuplicateEmail($email: String!) {\n    users: User_public(where: { email: { _eq: $email } }) {\n      id\n      nameFirst\n      nameLast\n      email\n      phone\n    }\n  }\n"]);return c=function(){return e},e}function l(){var e=(0,r.Z)(["\n  fragment UserFields on User {\n    id\n    email\n    nameFirst\n    nameLast\n    fullName\n    phone\n    status\n  }\n"]);return l=function(){return e},e}function d(){var e=(0,r.Z)(["\n  mutation SendGoogleAuthCode($code: String!, $id: Int!, $type: String!) {\n    createGoogleToken(code: $code, id: $id, type: $type) {\n      success\n      tokens\n      error\n    }\n  }\n"]);return d=function(){return e},e}function f(){var e=(0,r.Z)(["\n  mutation GenerateMSURL($type: String!, $id: Int!) {\n    genenrateMSURL(id: $id, type: $type) {\n      url\n    }\n  }\n"]);return f=function(){return e},e}function h(){var e=(0,r.Z)(["\n  mutation signoutMS($id: Int!, $type: String!, $email: String!) {\n    signoutMS(id: $id, type: $type, email: $email) {\n      error\n      msId\n      success\n    }\n  }\n"]);return h=function(){return e},e}function m(){var e=(0,r.Z)(["\n  query getAccountMeta($id: Int!) {\n    account: Account_by_pk(id: $id) {\n      meta\n    }\n  }\n"]);return m=function(){return e},e}function p(){var e=(0,r.Z)(["\n  query user($id: Int!) {\n    user: User_by_pk(id: $id) {\n      meta\n      invoiceThreshold\n      quoteThreshold\n    }\n  }\n"]);return p=function(){return e},e}function v(){var e=(0,r.Z)(["\n  query GetAccountUserMeta($userId: Int!, $accountId: Int!) {\n    accountUser: Account_User(where: { userId: { _eq: $userId }, accountId: { _eq: $accountId } }) {\n      meta\n    }\n  }\n"]);return v=function(){return e},e}function g(){var e=(0,r.Z)(["\n  mutation UpdateAccountUserByUserIdAccoutId(\n    $userId: Int!\n    $accountId: Int!\n    $changes: Account_User_set_input!\n  ) {\n    update_Account_User(\n      where: { userId: { _eq: $userId }, accountId: { _eq: $accountId } }\n      _set: $changes\n    ) {\n      returning {\n        id\n      }\n    }\n  }\n"]);return g=function(){return e},e}function y(){var e=(0,r.Z)(["\n  mutation updateAccount($accountId: Int!, $set: Account_set_input!) {\n    update_Account_by_pk(pk_columns: { id: $accountId }, _set: $set) {\n      id\n    }\n  }\n"]);return y=function(){return e},e}function _(){var e=(0,r.Z)(["\n  mutation updateUserMeta($userId: Int!, $meta: jsonb!) {\n    update_User_by_pk(pk_columns: { id: $userId }, _set: { meta: $meta }) {\n      id\n      meta\n    }\n  }\n"]);return _=function(){return e},e}function b(){var e=(0,r.Z)(['\n  query userDevices($accountId: Int!) {\n    users: User(\n      where: {\n        Account_Users: { accountId: { _eq: $accountId }, status: { _eq: "active" } }\n        UserDevices: { status: { _eq: "active" } }\n        status: { _eq: "active" }\n      }\n    ) {\n      id\n      fullName\n      devices: UserDevices(\n        order_by: { updatedAt: desc_nulls_last }\n        where: { status: { _eq: "active" } }\n        limit: 1\n      ) {\n        id\n        playerId\n      }\n    }\n  }\n']);return b=function(){return e},e}function x(){var e=(0,r.Z)(['\n  query GetAccountLocations($accountId: Int, $limit: Int, $offset: Int) {\n    location: Location(\n      offset: $offset\n      limit: $limit\n      where: {\n        Account_Locations: {\n          accountId: { _eq: $accountId }\n          Account: { type: { _eq: "customer" } }\n        }\n      }\n    ) {\n      id\n      name\n      accountLocations: Account_Locations {\n        id\n      }\n      addresses: Addresses(where: { entity: { _eq: "Location" }, registered: { _eq: true } }) {\n        id\n        status\n        address: Address {\n          id\n          name\n          addressLine1\n          postCode\n        }\n      }\n    }\n    meta: Location_aggregate(\n      where: {\n        Account_Locations: {\n          accountId: { _eq: $accountId }\n          Account: { type: { _eq: "customer" } }\n        }\n      }\n    ) {\n      aggregate {\n        totalCount: count\n      }\n    }\n  }\n']);return x=function(){return e},e}function I(){var e=(0,r.Z)(["\n  mutation InsertUserAccountLocations(\n    $accountUserId: Int!\n    $objects: [User_Account_Location_insert_input!]!\n  ) {\n    delete_User_Account_Location(where: { accountUserId: { _eq: $accountUserId } }) {\n      affected_rows\n    }\n    insert_User_Account_Location(objects: $objects) {\n      affected_rows\n      returning {\n        id\n      }\n    }\n  }\n"]);return I=function(){return e},e}var $=(0,i.Ps)(o()),q=(0,i.Ps)(a()),Z=(0,i.Ps)(s()),S=(0,i.Ps)(u()),C=(0,i.Ps)(c()),w=(0,i.Ps)(l()),k=(0,i.Ps)(d()),j=(0,i.Ps)(f()),A=(0,i.Ps)(h()),P=(0,i.Ps)(m()),T=(0,i.Ps)(p()),R=(0,i.Ps)(v()),D=(0,i.Ps)(g()),M=(0,i.Ps)(y()),F=(0,i.Ps)(_()),E=(0,i.Ps)(b()),O=(0,i.Ps)(x()),L=(0,i.Ps)(I())},51504:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return V}});var r=t(85893),i=t(67294),o=t(11163),a=t.n(o),s=t(73987),u=t(26042),c=t(69396),l=t(828),d=t(6812),f=t(73359),h=t(5616),m=t(11057),p=t(98456),v=t(90629),g=t(51233),y=t(15861),_=t(57460),b=t.n(_),x=t(45697),I=t.n(x),$=t(18586),q=t(2845),Z=t(20705),S=t(26186),C=function(e){var n=e.data,t=e.isCSV,r=e.isAdmin,i=e.type;return n.map(function(e){var n,o,a,s,l,d,f,h,m,p,v,g,y,_,b,x,I,$,q,Z,C,w=e.manager?"".concat(e.manager.nameFirst," ").concat(e.manager.nameLast):"Unassigned",k=e.scheduledAt?(0,S.Z)(e.scheduledAt,!0):(0,S.Z)(e.timingStart,!0),j=t&&(null==e?void 0:e.supplierOffers.length)>0?null===(n=null==e?void 0:e.supplierOffers[0].supplier)||void 0===n?void 0:n.name:null,A="bookings"===i||t?(null===(o=e.sublocation)||void 0===o?void 0:o.name)||"-":void 0;return(0,c.Z)((0,u.Z)({id:e.id,type:e.type,number:e.number,invoiceNumber:null===(a=e.invoices)||void 0===a?void 0:null===(s=a[0])||void 0===s?void 0:s.invoiceNumber,sublocation:A,creator:null===(l=e.timings)||void 0===l?void 0:null===(d=l[0])||void 0===d?void 0:null===(f=d.user)||void 0===f?void 0:f.fullName,propertyId:null===(h=e.location)||void 0===h?void 0:h.id,managerId:null===(m=e.manager)||void 0===m?void 0:m.id,customerId:null===(p=e.customer)||void 0===p?void 0:p.id,priority:(null===(v=e.sla)||void 0===v?void 0:v.name)||"-",supplierId:e.supplier?e.supplier.id:"",service:(null===(g=e.service)||void 0===g?void 0:g.name)||"-",description:(null===(y=e.shortJobDesc)||void 0===y?void 0:null===(_=y[0])||void 0===_?void 0:_.taxonomy.name)||"-",manager:w,location:(null===(b=e.location)||void 0===b?void 0:b.name)||"-",customer:(null===(x=e.customer)||void 0===x?void 0:x.name)||"-",customerManager:(null===(I=e.customer)||void 0===I?void 0:null===($=I.manager)||void 0===$?void 0:$.fullName)||"-"},!t&&{customerManagerId:null===(q=e.customer)||void 0===q?void 0:null===(Z=q.manager)||void 0===Z?void 0:Z.id}),{supplier:e.supplier?e.supplier.name:"-",supplierUser:e.supplierUser?e.supplierUser.fullName:"-",scheduleDate:k,tags:null==e?void 0:e.tags,date:(0,S.Z)(e.createdAt),status:(null==e?void 0:e.job)?null===(C=e.job)||void 0===C?void 0:C.status:e.status,offerTo:r?j:"",actions:""})})},w=t(9492),k=t(50459),j=t(63855),A=t(71431),P=t(52785),T=function(e){var n=e.variables,t=e.user,r=e.queryParams,i=e.hasRole,o=r.hasOwnProperty("tileName");if(!n.isChangedStatusSelect)switch(r.show){case"offered":n.status=["offered"];break;case"current":n.status=["accepted","inProgress","pending"];break;case"openJobs":n.status=["raised","pending"];break;case"raised":n.status=["raised"];break;case"pending":n.status=["pending"];break;case"past":n.status=["completed","inDispute","disputeResolved","reportSent","invoiceSent","customerPaid","supplierPaid","closed"];break;default:n.status=r.show}var a=n.limit,s=n.offset,l=n.orderBy,d=n.q,f=n.status,h=n.startDate,m=n.endDate,p=n.type,v=n.number,g=n.userId,y=n.managerId,_=n.locationId,b=n.monthStart,x=n.tagsWhere,I=n.todayStart,$=n.yearStart,q=n.asAt;if(o){var Z=g||+r.userId,S=+r.accountId;return i(["customer","supplier"])&&(Z=t.id,S=t.accountId),{query:(0,A.Z)({tagsWhere:x}),variables:(0,c.Z)((0,u.Z)({},n),{locationId:_||r.locationId,managerId:y||r.managerId,customerManagerId:+r.customerManagerId,accountId:S,adminId:null==t?void 0:t.adminId,asAt:q,tileName:null==r?void 0:r.tileName,orderBy:l,monthStart:b,dayStart:I,yearStart:$,type:r.type||p,userId:Z})}}switch(t.accountType){case"supplier":return{query:P.p7,variables:{limit:a,offset:s,orderBy:l,q:d,status:f,startDate:h,endDate:m,type:p,number:v,userId:g||y}};case"customer":return{query:P.lS,variables:{limit:a,offset:s,orderBy:l,q:d,status:f,type:p,number:v,startDate:h,endDate:m,userId:g||y,locationId:_}};case"tenant":return{query:P.lS,variables:{limit:a,offset:s,orderBy:l,q:d,status:f,type:p,startDate:h,endDate:m}};default:return{query:(0,P.ct)({tagsWhere:x}),variables:(0,u.Z)({},n)}}},R=function(e){var n,t,r;return(0,c.Z)((0,u.Z)({},e),{orderBy:(null==e?void 0:null===(n=e.orderBy)||void 0===n?void 0:n.scheduleDate)?{scheduledAt:null==e?void 0:null===(t=e.orderBy)||void 0===t?void 0:t.scheduleDate,timingStart:null==e?void 0:null===(r=e.orderBy)||void 0===r?void 0:r.scheduleDate}:e.orderBy})},D=t(45416),M=t(75759),F=t(15033),E=t(5336),O=t(81261),L=t(30381),U=t.n(L),N=t(63139),G=t(12547),z=t(48381),B=t(66137),W="/dashboard/issues/",H=function(e){var n,t,s,_,x,I=e.initialFilters,S=e.type,A=e.title,P=e.subtitle,L=(0,$.q)(),H=(0,q.x)(),Q=H.hasRole,J=H.user,V=(0,o.useRouter)().query,K=(0,i.useState)((0,u.Z)({},I)),Y=K[0],X=K[1],ee=(0,i.useState)(!1),en=ee[0],et=ee[1],er=(0,i.useState)(!1),ei=er[0],eo=er[1],ea=null===(n=L.admin)||void 0===n?void 0:null===(t=n.jobSetting)||void 0===t?void 0:t.jobNumberPrefix,es=null===(s=L.admin)||void 0===s?void 0:null===(_=s.jobSetting)||void 0===_?void 0:_.jobNumberSuffix,eu=(0,N.s)(),ec=Q("admin"),el=Q("customer"),ed=Q("tenant"),ef=Q("supplier"),eh=(0,Z.x)({filters:Y}),em=eh.initialData,ep=eh.ref,ev=T({variables:(0,c.Z)((0,u.Z)({assetId:null},R(em)),{monthStart:U()(V.asAt).startOf("month"),todayEnd:U()(V.asAt).endOf("day"),todayStart:U()(V.asAt).startOf("day"),yearStart:U()(V.asAt).startOf("year"),asAt:U()(V.asAt).endOf("day"),number:em.id?String(em.id):null,tagsWhere:(0,B.Y)(em.tags),type:S}),user:J,queryParams:V,hasRole:Q}),eg=ev.query,ey=ev.variables,e_=(0,d.a)(eg,{variables:ey}),eb=e_.data,ex=void 0===eb?{jobs:[],meta:{aggregate:{totalCount:0}}}:eb,eI=ex.jobs,e$=ex.meta,eq=e_.loading,eZ=e_.refetch,eS=(0,l.Z)((0,f.t)(eg,{fetchPolicy:"no-cache",variables:(0,c.Z)((0,u.Z)({},ey),{limit:(null==e$?void 0:null===(x=e$.aggregate)||void 0===x?void 0:x.totalCount)||150}),onCompleted:function(e){var n=e.jobs;try{var t=b().unparse(C({data:n,isCSV:!0,isAdmin:ec})),r="data:application/octet-stream,"+encodeURIComponent(t);(0,w.S)(r,"jobs.csv")}finally{eo(!1)}}}),1)[0],eC=function(e){a().push("".concat(W,"manage?id=").concat(e.number))},ew=function(e){return[{context:"secondary",icon:"edit",onClick:function(n){return eC(e)},tooltip:"Edit"},{context:"secondary",icon:"info",onClick:function(n){return a().push("/dashboard/issues/view?id=".concat(e.number))},tooltip:"Info"}]},ek=function(e){e.stopPropagation();var n=(0,k.Uu)(Y);a().push("".concat(W,"manage").concat(n))},ej=function(e){e.stopPropagation(),eo(!0),eS()};return(0,r.jsxs)(g.Z,{width:"100%",spacing:2,sx:{height:"100%"},children:[(0,r.jsxs)(g.Z,{width:"100%",direction:"row",justifyContent:"space-between",children:[(0,r.jsx)(m.Z,{variant:"contained",startIcon:(0,r.jsx)(O.Z,{}),onClick:function(){return et(!0)},children:"Filters"}),(0,r.jsxs)(g.Z,{direction:"row",spacing:2,children:["reactive"===S&&(ec||el)&&(0,r.jsx)(m.Z,{variant:"contained",color:"secondary",onClick:ek,children:"Create Work Order"}),!eu&&(0,r.jsx)(m.Z,{startIcon:!ei&&(0,r.jsx)("img",{src:"/static/icons/csv.svg"}),disabled:ei,variant:"contained",color:"success",onClick:ej,children:ei?(0,r.jsx)(p.Z,{size:20,color:"secondary"}):"Export"})]})]}),(0,r.jsxs)(v.Z,{sx:{paddingTop:"16px",paddingBottom:"16px",height:"calc(100% - 52px)"},children:[(0,r.jsxs)(g.Z,{children:[(0,r.jsx)(y.Z,{ml:2,variant:"h5",sx:{fontWeight:600},children:A}),P&&(0,r.jsx)(y.Z,{typography:"subtitle1",ml:2,children:P})]}),(0,r.jsx)(j.h,{open:en,setOpen:et,initialFilters:I,filters:Y,setFilters:X}),(0,r.jsx)(F.i,{autoHeight:!1,loading:eq,ref:ep,columns:[{minWidth:60,field:"id",headerName:"Job ID",renderCell:function(e){var n=e.row;return(0,r.jsx)(D.D,{id:n.id,number:n.number,openCanvas:!0,type:n.type,numberPrefix:ea,numberSuffix:es})}},{minWidth:60,field:"invoiceNumber",headerName:"Invoice ID",renderCell:function(e){return e.row.invoiceNumber},sortable:!1},{maxWidth:80,field:"priority",headerName:"Priority",sortName:'{"SLA": {"name": "ORDER"}}'},{minWidth:200,field:"service",headerName:"Service",sortName:'{"Service": {"name": "ORDER"}}'},{minWidth:80,field:"type",headerName:"Type",sortable:!0},{minWidth:300,field:"tags",headerName:"Tags",sortable:!1,renderCell:function(e){var n=e.row;return(0,r.jsx)(z.K,{row:n,refetchQueries:["GetJobs","GetDashboardList"],entity:"Job"})}},{minWidth:200,flex:1,field:"description",headerName:"Description",sortable:!1},{minWidth:130,flex:1,field:"manager",headerName:"Assigned to",sortName:'{"Manager": {"nameFirst": "ORDER"}}',renderCell:function(e){var n=e.row;return(0,r.jsx)(G.r,{noWrap:!n.managerId,color:"secondary",href:"/dashboard/users/view?id=".concat(n.managerId),children:n.manager})}},{minWidth:200,flex:1,field:"location",headerName:el||ef||ed?"Location":"Customer",sortName:'{"Customer": {"name": "ORDER"}}',renderCell:function(e){var n=e.row;return(0,r.jsxs)(g.Z,{children:[ec&&(0,r.jsx)(G.r,{color:"secondary",href:"/dashboard/customers/view?id=".concat(n.customerId),children:n.customer}),(0,r.jsx)(G.r,{noWrap:ef||ed,color:"secondary",href:"/dashboard/properties/view?id=".concat(n.propertyId),children:n.location})]})}},{minWidth:180,flex:1,field:"customerManager",headerName:"Account Manager",sortName:'{"Customer": {"Manager": {"fullName": "ORDER"}}}',renderCell:function(e){var n=e.row;return(0,r.jsx)(G.r,{noWrap:!n.customerManagerId,color:"secondary",href:"/dashboard/users/view?id=".concat(n.customerManagerId),children:n.customerManager})}},{minWidth:140,flex:1,field:"supplier",headerName:"Supplier",sortName:'{"Supplier": {"name": "ORDER"}}',renderCell:function(e){var n=e.row;return(0,r.jsx)(G.r,{color:"secondary",href:"/dashboard/suppliers/view?id=".concat(n.supplierId),children:n.supplier})}},{flex:1,minWidth:120,field:"supplierUser",headerName:"Assigned to",sortName:'{"SupplierUser": {"nameFirst": "ORDER"}}'},{minWidth:160,field:"scheduleDate",headerName:"Scheduled",sortable:!0},{minWidth:120,flex:1,field:"date",headerName:"Created",sortName:"createdAt"},{minWidth:120,flex:1,field:"status",headerName:"Status",renderCell:function(e){var n,t,i=e.row;return(0,r.jsxs)(g.Z,{children:[(0,r.jsx)(h.Z,{children:(0,r.jsx)(M.B,{value:i.status})}),ec&&"offered"===i.status&&i.offerTo&&i.offerTo.length>0&&(0,r.jsx)(G.r,{color:"secondary",href:"/dashboard/suppliers/view?id=".concat(null===(n=i.offerTo[0].supplier)||void 0===n?void 0:n.id),children:null===(t=i.offerTo[0].supplier)||void 0===t?void 0:t.name})]})}},{width:50,field:"actions",headerName:"",sortable:!1,renderCell:function(e){var n=e.row;return(0,r.jsx)(E.C,{actionsData:ew,row:n})}}],rows:C({data:eI,isCSV:!1,isAdmin:ec}),meta:e$,refetch:eZ,containerHeight:"calc(100% - ".concat(P?52:32,"px)"),columnVisibilityModel:{priority:!("ppm"===S||el||ef),manager:ec,customerManager:ec,supplier:ec,supplierUser:ef,actions:ec,tags:ec}})]})]})};H.defaultProps={initialFilters:{},type:"reactive",title:"",subtitle:""},H.propTypes={initialFilters:I().object,type:I().oneOf(["reactive","ppm"]),title:I().string,subtitle:I().string};var Q=t(58849),J=function(){var e,n,t=(0,i.useContext)(s.Z).user,u=(0,o.useRouter)().query;if(!t)return a().push("/account/sign-in"),null;var c=null;return c="ppm"===u.type?(0,r.jsx)(H,{type:"ppm",title:null!==(e=null==u?void 0:u.title)&&void 0!==e?e:"Find PPM",subtitle:null==u?void 0:u.subtitle,initialFilters:K}):(0,r.jsx)(H,{type:"reactive",title:null!==(n=null==u?void 0:u.title)&&void 0!==n?n:"Work Orders",subtitle:null==u?void 0:u.subtitle,initialFilters:Y}),(0,r.jsx)(Q.Z,{children:c})};J.getLayout=function(e){return e};var V=J,K={customerId:null,endDate:null,id:null,locationId:null,managerId:null,q:null,startDate:null,status:[],supplierId:null,userId:null,tags:null,customerManagerId:null,isChangedStatusSelect:!1,filterType:"reactive_table"},Y={customerId:null,endDate:null,id:null,meta:null,locationId:null,managerId:null,q:null,startDate:null,status:[],supplierId:null,userId:null,tags:null,customerManagerId:null,isChangedStatusSelect:!1,filterType:"ppm_table"}},57460:function(e,n){var t,r,i,o; /* @license
Papa Parse
v5.3.0
https://github.com/mholt/PapaParse
License: MIT
*/ o=function e(){"use strict";var n="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n?n:{},t=!n.document&&!!n.postMessage,r=t&&/blob:/i.test((n.location||{}).protocol),i={},o=0,a={parse:function(t,r){var s=(r=r||{}).dynamicTyping||!1;if(x(s)&&(r.dynamicTypingFunction=s,s={}),r.dynamicTyping=s,r.transform=!!x(r.transform)&&r.transform,r.worker&&a.WORKERS_SUPPORTED){var u=function(){if(!a.WORKERS_SUPPORTED)return!1;var t,r,s=(t=n.URL||n.webkitURL||null,r=e.toString(),a.BLOB_URL||(a.BLOB_URL=t.createObjectURL(new Blob(["(",r,")();"],{type:"text/javascript"})))),u=new n.Worker(s);return u.onmessage=v,u.id=o++,i[u.id]=u}();return u.userStep=r.step,u.userChunk=r.chunk,u.userComplete=r.complete,u.userError=r.error,r.step=x(r.step),r.chunk=x(r.chunk),r.complete=x(r.complete),r.error=x(r.error),delete r.worker,void u.postMessage({input:t,config:r,workerId:u.id})}var h=null;return a.NODE_STREAM_INPUT,"string"==typeof t?h=r.download?new c(r):new d(r):!0===t.readable&&x(t.read)&&x(t.on)?h=new f(r):(n.File&&t instanceof File||t instanceof Object)&&(h=new l(r)),h.stream(t)},unparse:function(e,n){var t=!1,r=!0,i=",",o="\r\n",s='"',u=s+s,c=!1,l=null,d=!1;!function(){if("object"==typeof n){if("string"!=typeof n.delimiter||a.BAD_DELIMITERS.filter(function(e){return -1!==n.delimiter.indexOf(e)}).length||(i=n.delimiter),("boolean"==typeof n.quotes||"function"==typeof n.quotes||Array.isArray(n.quotes))&&(t=n.quotes),"boolean"!=typeof n.skipEmptyLines&&"string"!=typeof n.skipEmptyLines||(c=n.skipEmptyLines),"string"==typeof n.newline&&(o=n.newline),"string"==typeof n.quoteChar&&(s=n.quoteChar),"boolean"==typeof n.header&&(r=n.header),Array.isArray(n.columns)){if(0===n.columns.length)throw Error("Option columns is empty");l=n.columns}void 0!==n.escapeChar&&(u=n.escapeChar+s),"boolean"==typeof n.escapeFormulae&&(d=n.escapeFormulae)}}();var f=RegExp(m(s),"g");if("string"==typeof e&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return p(null,e,c);if("object"==typeof e[0])return p(l||h(e[0]),e,c)}else if("object"==typeof e)return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:h(e.data[0])),Array.isArray(e.data[0])||"object"==typeof e.data[0]||(e.data=[e.data])),p(e.fields||[],e.data||[],c);throw Error("Unable to serialize unrecognized input");function h(e){if("object"!=typeof e)return[];var n=[];for(var t in e)n.push(t);return n}function p(e,n,t){var a="";"string"==typeof e&&(e=JSON.parse(e)),"string"==typeof n&&(n=JSON.parse(n));var s=Array.isArray(e)&&0<e.length,u=!Array.isArray(n[0]);if(s&&r){for(var c=0;c<e.length;c++)0<c&&(a+=i),a+=v(e[c],c);0<n.length&&(a+=o)}for(var l=0;l<n.length;l++){var d=s?e.length:n[l].length,f=!1,h=s?0===Object.keys(n[l]).length:0===n[l].length;if(t&&!s&&(f="greedy"===t?""===n[l].join("").trim():1===n[l].length&&0===n[l][0].length),"greedy"===t&&s){for(var m=[],p=0;p<d;p++){var g=u?e[p]:p;m.push(n[l][g])}f=""===m.join("").trim()}if(!f){for(var y=0;y<d;y++){0<y&&!h&&(a+=i);var _=s&&u?e[y]:y;a+=v(n[l][_],y)}l<n.length-1&&(!t||0<d&&!h)&&(a+=o)}}return a}function v(e,n){if(null==e)return"";if(e.constructor===Date)return JSON.stringify(e).slice(1,25);!0===d&&"string"==typeof e&&null!==e.match(/^[=+\-@].*$/)&&(e="'"+e);var r=e.toString().replace(f,u);return"boolean"==typeof t&&t||"function"==typeof t&&t(e,n)||Array.isArray(t)&&t[n]||function(e,n){for(var t=0;t<n.length;t++)if(-1<e.indexOf(n[t]))return!0;return!1}(r,a.BAD_DELIMITERS)||-1<r.indexOf(i)||" "===r.charAt(0)||" "===r.charAt(r.length-1)?s+r+s:r}}};if(a.RECORD_SEP="\x1e",a.UNIT_SEP="\x1f",a.BYTE_ORDER_MARK="\uFEFF",a.BAD_DELIMITERS=["\r","\n",'"',a.BYTE_ORDER_MARK],a.WORKERS_SUPPORTED=!t&&!!n.Worker,a.NODE_STREAM_INPUT=1,a.LocalChunkSize=10485760,a.RemoteChunkSize=5242880,a.DefaultDelimiter=",",a.Parser=p,a.ParserHandle=h,a.NetworkStreamer=c,a.FileStreamer=l,a.StringStreamer=d,a.ReadableStreamStreamer=f,n.jQuery){var s=n.jQuery;s.fn.parse=function(e){var t=e.config||{},r=[];return this.each(function(e){if(!("INPUT"===s(this).prop("tagName").toUpperCase()&&"file"===s(this).attr("type").toLowerCase()&&n.FileReader)||!this.files||0===this.files.length)return!0;for(var i=0;i<this.files.length;i++)r.push({file:this.files[i],inputElem:this,instanceConfig:s.extend({},t)})}),i(),this;function i(){if(0!==r.length){var n,t,i,u,c=r[0];if(x(e.before)){var l=e.before(c.file,c.inputElem);if("object"==typeof l){if("abort"===l.action)return n="AbortError",t=c.file,i=c.inputElem,u=l.reason,void(x(e.error)&&e.error({name:n},t,i,u));if("skip"===l.action)return void o();"object"==typeof l.config&&(c.instanceConfig=s.extend(c.instanceConfig,l.config))}else if("skip"===l)return void o()}var d=c.instanceConfig.complete;c.instanceConfig.complete=function(e){x(d)&&d(e,c.file,c.inputElem),o()},a.parse(c.file,c.instanceConfig)}else x(e.complete)&&e.complete()}function o(){r.splice(0,1),i()}}}function u(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(e){var n=_(e);n.chunkSize=parseInt(n.chunkSize),e.step||e.chunk||(n.chunkSize=null),this._handle=new h(n),(this._handle.streamer=this)._config=n}).call(this,e),this.parseChunk=function(e,t){if(this.isFirstChunk&&x(this._config.beforeFirstChunk)){var i=this._config.beforeFirstChunk(e);void 0!==i&&(e=i)}this.isFirstChunk=!1,this._halted=!1;var o=this._partialLine+e;this._partialLine="";var s=this._handle.parse(o,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var u=s.meta.cursor;this._finished||(this._partialLine=o.substring(u-this._baseIndex),this._baseIndex=u),s&&s.data&&(this._rowCount+=s.data.length);var c=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(r)n.postMessage({results:s,workerId:a.WORKER_ID,finished:c});else if(x(this._config.chunk)&&!t){if(this._config.chunk(s,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);s=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(s.data),this._completeResults.errors=this._completeResults.errors.concat(s.errors),this._completeResults.meta=s.meta),this._completed||!c||!x(this._config.complete)||s&&s.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),c||s&&s.meta.paused||this._nextChunk(),s}this._halted=!0},this._sendError=function(e){x(this._config.error)?this._config.error(e):r&&this._config.error&&n.postMessage({workerId:a.WORKER_ID,error:e,finished:!1})}}function c(e){var n;(e=e||{}).chunkSize||(e.chunkSize=a.RemoteChunkSize),u.call(this,e),this._nextChunk=t?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(e){this._input=e,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(n=new XMLHttpRequest,this._config.withCredentials&&(n.withCredentials=this._config.withCredentials),t||(n.onload=b(this._chunkLoaded,this),n.onerror=b(this._chunkError,this)),n.open(this._config.downloadRequestBody?"POST":"GET",this._input,!t),this._config.downloadRequestHeaders){var e=this._config.downloadRequestHeaders;for(var r in e)n.setRequestHeader(r,e[r])}if(this._config.chunkSize){var i=this._start+this._config.chunkSize-1;n.setRequestHeader("Range","bytes="+this._start+"-"+i)}try{n.send(this._config.downloadRequestBody)}catch(o){this._chunkError(o.message)}t&&0===n.status&&this._chunkError()}},this._chunkLoaded=function(){var e,t;4===n.readyState&&(n.status<200||400<=n.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:n.responseText.length,this._finished=!this._config.chunkSize||this._start>=(null===(t=(e=n).getResponseHeader("Content-Range"))?-1:parseInt(t.substring(t.lastIndexOf("/")+1))),this.parseChunk(n.responseText)))},this._chunkError=function(e){var t=n.statusText||e;this._sendError(Error(t))}}function l(e){(e=e||{}).chunkSize||(e.chunkSize=a.LocalChunkSize),u.call(this,e);var n,t,r="undefined"!=typeof FileReader;this.stream=function(e){this._input=e,t=e.slice||e.webkitSlice||e.mozSlice,r?((n=new FileReader).onload=b(this._chunkLoaded,this),n.onerror=b(this._chunkError,this)):n=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var e=this._input;if(this._config.chunkSize){var i=Math.min(this._start+this._config.chunkSize,this._input.size);e=t.call(e,this._start,i)}var o=n.readAsText(e,this._config.encoding);r||this._chunkLoaded({target:{result:o}})},this._chunkLoaded=function(e){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(e.target.result)},this._chunkError=function(){this._sendError(n.error)}}function d(e){var n;u.call(this,e=e||{}),this.stream=function(e){return n=e,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var e,t=this._config.chunkSize;return t?(e=n.substring(0,t),n=n.substring(t)):(e=n,n=""),this._finished=!n,this.parseChunk(e)}}}function f(e){u.call(this,e=e||{});var n=[],t=!0,r=!1;this.pause=function(){u.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){u.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(e){this._input=e,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){r&&1===n.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),n.length?this.parseChunk(n.shift()):t=!0},this._streamData=b(function(e){try{n.push("string"==typeof e?e:e.toString(this._config.encoding)),t&&(t=!1,this._checkIsFinished(),this.parseChunk(n.shift()))}catch(r){this._streamError(r)}},this),this._streamError=b(function(e){this._streamCleanUp(),this._sendError(e)},this),this._streamEnd=b(function(){this._streamCleanUp(),r=!0,this._streamData("")},this),this._streamCleanUp=b(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function h(e){var n,t,r,i=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)(e[-+]?\d+)?\s*$/,o=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,s=this,u=0,c=0,l=!1,d=!1,f=[],h={data:[],errors:[],meta:{}};if(x(e.step)){var v=e.step;e.step=function(n){if(h=n,b())y();else{if(y(),0===h.data.length)return;u+=n.data.length,e.preview&&u>e.preview?t.abort():(h.data=h.data[0],v(h,s))}}}function g(n){return"greedy"===e.skipEmptyLines?""===n.join("").trim():1===n.length&&0===n[0].length}function y(){if(h&&r&&($("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+a.DefaultDelimiter+"'"),r=!1),e.skipEmptyLines)for(var n=0;n<h.data.length;n++)g(h.data[n])&&h.data.splice(n--,1);return b()&&function(){if(h){if(Array.isArray(h.data[0])){for(var n=0;b()&&n<h.data.length;n++)h.data[n].forEach(t);h.data.splice(0,1)}else h.data.forEach(t)}function t(n,t){x(e.transformHeader)&&(n=e.transformHeader(n,t)),f.push(n)}}(),function(){if(!h||!e.header&&!e.dynamicTyping&&!e.transform)return h;function n(n,t){var r,i=e.header?{}:[];for(r=0;r<n.length;r++){var o=r,a=n[r];e.header&&(o=r>=f.length?"__parsed_extra":f[r]),e.transform&&(a=e.transform(a,o)),a=I(o,a),"__parsed_extra"===o?(i[o]=i[o]||[],i[o].push(a)):i[o]=a}return e.header&&(r>f.length?$("FieldMismatch","TooManyFields","Too many fields: expected "+f.length+" fields but parsed "+r,c+t):r<f.length&&$("FieldMismatch","TooFewFields","Too few fields: expected "+f.length+" fields but parsed "+r,c+t)),i}var t=1;return!h.data.length||Array.isArray(h.data[0])?(h.data=h.data.map(n),t=h.data.length):h.data=n(h.data,0),e.header&&h.meta&&(h.meta.fields=f),c+=t,h}()}function b(){return e.header&&0===f.length}function I(n,t){return e.dynamicTypingFunction&&void 0===e.dynamicTyping[n]&&(e.dynamicTyping[n]=e.dynamicTypingFunction(n)),!0===(e.dynamicTyping[n]||e.dynamicTyping)?"true"===t||"TRUE"===t||"false"!==t&&"FALSE"!==t&&(!function(e){if(i.test(e)){var n=parseFloat(e);if(-9007199254740992<n&&n<9007199254740992)return!0}return!1}(t)?o.test(t)?new Date(t):""===t?null:t:parseFloat(t)):t}function $(e,n,t,r){var i={type:e,code:n,message:t};void 0!==r&&(i.row=r),h.errors.push(i)}this.parse=function(i,o,s){var u=e.quoteChar||'"';if(e.newline||(e.newline=function(e,n){e=e.substring(0,1048576);var t=RegExp(m(n)+"([^]*?)"+m(n),"gm"),r=(e=e.replace(t,"")).split("\r"),i=e.split("\n"),o=1<i.length&&i[0].length<r[0].length;if(1===r.length||o)return"\n";for(var a=0,s=0;s<r.length;s++)"\n"===r[s][0]&&a++;return a>=r.length/2?"\r\n":"\r"}(i,u)),r=!1,e.delimiter)x(e.delimiter)&&(e.delimiter=e.delimiter(i),h.meta.delimiter=e.delimiter);else{var c=function(n,t,r,i,o){var s,u,c,l;o=o||[",","	","|",";",a.RECORD_SEP,a.UNIT_SEP];for(var d=0;d<o.length;d++){var f=o[d],h=0,m=0,v=0;c=void 0;for(var y=new p({comments:i,delimiter:f,newline:t,preview:10}).parse(n),_=0;_<y.data.length;_++)if(r&&g(y.data[_]))v++;else{var b=y.data[_].length;m+=b,void 0!==c?0<b&&(h+=Math.abs(b-c),c=b):c=b}0<y.data.length&&(m/=y.data.length-v),(void 0===u||h<=u)&&(void 0===l||l<m)&&1.99<m&&(u=h,s=f,l=m)}return{successful:!!(e.delimiter=s),bestDelimiter:s}}(i,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess);c.successful?e.delimiter=c.bestDelimiter:(r=!0,e.delimiter=a.DefaultDelimiter),h.meta.delimiter=e.delimiter}var d=_(e);return e.preview&&e.header&&d.preview++,n=i,h=(t=new p(d)).parse(n,o,s),y(),l?{meta:{paused:!0}}:h||{meta:{paused:!1}}},this.paused=function(){return l},this.pause=function(){l=!0,t.abort(),n=x(e.chunk)?"":n.substring(t.getCharIndex())},this.resume=function(){s.streamer._halted?(l=!1,s.streamer.parseChunk(n,!0)):setTimeout(s.resume,3)},this.aborted=function(){return d},this.abort=function(){d=!0,t.abort(),h.meta.aborted=!0,x(e.complete)&&e.complete(h),n=""}}function m(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function p(e){var n,t=(e=e||{}).delimiter,r=e.newline,i=e.comments,o=e.step,s=e.preview,u=e.fastMode,c=n=void 0===e.quoteChar?'"':e.quoteChar;if(void 0!==e.escapeChar&&(c=e.escapeChar),("string"!=typeof t||-1<a.BAD_DELIMITERS.indexOf(t))&&(t=","),i===t)throw Error("Comment character same as delimiter");!0===i?i="#":("string"!=typeof i||-1<a.BAD_DELIMITERS.indexOf(i))&&(i=!1),"\n"!==r&&"\r"!==r&&"\r\n"!==r&&(r="\n");var l=0,d=!1;this.parse=function(e,a,f){if("string"!=typeof e)throw Error("Input must be a string");var h=e.length,p=t.length,v=r.length,g=i.length,y=x(o),_=[],b=[],I=[],$=l=0;if(!e)return F();if(u||!1!==u&&-1===e.indexOf(n)){for(var q=e.split(r),Z=0;Z<q.length;Z++){if(l+=(I=q[Z]).length,Z!==q.length-1)l+=r.length;else if(f)break;if(!i||I.substring(0,g)!==i){if(y){if(_=[],T(I.split(t)),E(),d)return F()}else T(I.split(t));if(s&&s<=Z)return _=_.slice(0,s),F(!0)}}return F()}for(var S=e.indexOf(t,l),C=e.indexOf(r,l),w=RegExp(m(c)+m(n),"g"),k=e.indexOf(n,l);;)if(e[l]!==n){if(i&&0===I.length&&e.substring(l,l+g)===i){if(-1===C)return F();l=C+v,C=e.indexOf(r,l),S=e.indexOf(t,l)}else{if(-1!==S&&(S<C||-1===C)){if(!(S<k)){I.push(e.substring(l,S)),l=S+p,S=e.indexOf(t,l);continue}var j=O(S,k,C);if(j&&void 0!==j.nextDelim){S=j.nextDelim,k=j.quoteSearch,I.push(e.substring(l,S)),l=S+p,S=e.indexOf(t,l);continue}}if(-1===C)break;if(I.push(e.substring(l,C)),M(C+v),y&&(E(),d))return F();if(s&&_.length>=s)return F(!0)}}else for(k=l,l++;;){if(-1===(k=e.indexOf(n,k+1)))return f||b.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:_.length,index:l}),D();if(k===h-1)return D(e.substring(l,k).replace(w,n));if(n!==c||e[k+1]!==c){if(n===c||0===k||e[k-1]!==c){-1!==S&&S<k+1&&(S=e.indexOf(t,k+1)),-1!==C&&C<k+1&&(C=e.indexOf(r,k+1));var A=R(-1===C?S:Math.min(S,C));if(e[k+1+A]===t){I.push(e.substring(l,k).replace(w,n)),e[l=k+1+A+p]!==n&&(k=e.indexOf(n,l)),S=e.indexOf(t,l),C=e.indexOf(r,l);break}var P=R(C);if(e.substring(k+1+P,k+1+P+v)===r){if(I.push(e.substring(l,k).replace(w,n)),M(k+1+P+v),S=e.indexOf(t,l),k=e.indexOf(n,l),y&&(E(),d))return F();if(s&&_.length>=s)return F(!0);break}b.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:_.length,index:l}),k++}}else k++}return D();function T(e){_.push(e),$=l}function R(n){var t=0;if(-1!==n){var r=e.substring(k+1,n);r&&""===r.trim()&&(t=r.length)}return t}function D(n){return f||(void 0===n&&(n=e.substring(l)),I.push(n),l=h,T(I),y&&E()),F()}function M(n){l=n,T(I),I=[],C=e.indexOf(r,l)}function F(e){return{data:_,errors:b,meta:{delimiter:t,linebreak:r,aborted:d,truncated:!!e,cursor:$+(a||0)}}}function E(){o(F()),_=[],b=[]}function O(r,i,o){var a={nextDelim:void 0,quoteSearch:void 0},s=e.indexOf(n,i+1);if(i<r&&r<s&&(s<o||-1===o)){var u=e.indexOf(t,s);if(-1===u)return a;s<u&&(s=e.indexOf(n,s+1)),a=O(u,s,o)}else a={nextDelim:r,quoteSearch:i};return a}},this.abort=function(){d=!0},this.getCharIndex=function(){return l}}function v(e){var n=e.data,t=i[n.workerId],r=!1;if(n.error)t.userError(n.error,n.file);else if(n.results&&n.results.data){var o={abort:function(){r=!0,g(n.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:y,resume:y};if(x(t.userStep)){for(var a=0;a<n.results.data.length&&(t.userStep({data:n.results.data[a],errors:n.results.errors,meta:n.results.meta},o),!r);a++);delete n.results}else x(t.userChunk)&&(t.userChunk(n.results,o,n.file),delete n.results)}n.finished&&!r&&g(n.workerId,n.results)}function g(e,n){var t=i[e];x(t.userComplete)&&t.userComplete(n),t.terminate(),delete i[e]}function y(){throw Error("Not implemented.")}function _(e){if("object"!=typeof e||null===e)return e;var n=Array.isArray(e)?[]:{};for(var t in e)n[t]=_(e[t]);return n}function b(e,n){return function(){e.apply(n,arguments)}}function x(e){return"function"==typeof e}return r&&(n.onmessage=function(e){var t=e.data;if(void 0===a.WORKER_ID&&t&&(a.WORKER_ID=t.workerId),"string"==typeof t.input)n.postMessage({workerId:a.WORKER_ID,results:a.parse(t.input,t.config),finished:!0});else if(n.File&&t.input instanceof File||t.input instanceof Object){var r=a.parse(t.input,t.config);r&&n.postMessage({workerId:a.WORKER_ID,results:r,finished:!0})}}),(c.prototype=Object.create(u.prototype)).constructor=c,(l.prototype=Object.create(u.prototype)).constructor=l,(d.prototype=Object.create(d.prototype)).constructor=d,(f.prototype=Object.create(u.prototype)).constructor=f,a},void 0!==(i=o.apply(n,[]))&&(e.exports=i)},40872:function(e,n,t){"use strict";function r(){return(r=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}).apply(this,arguments)}function i(){return r.apply(this,arguments)}t.d(n,{Z:function(){return i}})}},function(e){e.O(0,[3662,2283,212,619,8890,2583,4135,8579,6043,1564,4244,3911,3776,2329,778,4046,1023,9957,1870,8062,2429,5497,4061,8324,8344,8849,2781,9774,2888,179],function(){return e(e.s=61400)}),_N_E=e.O()}]);