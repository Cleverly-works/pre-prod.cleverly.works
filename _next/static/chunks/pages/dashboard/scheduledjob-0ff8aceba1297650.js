(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6305],{55843:function(n,e,t){"use strict";t.d(e,{Z:function(){return Z}});var i,r,o,a,s,c=t(39725),u=t(51174),d=t(67294),l=t(45697),p=t(10367),m=t(66349),f=t(55255),g={xxsSize:"0.25rem",xsSize:"0.5rem",smSize:"0.75rem",mdSize:"1rem",lgSize:"1.5rem",xlSize:"2rem",xxlSize:"2.5rem",xxxlSize:"3rem"},v=function(n){var e="",t=0;return(n.forEach(function(n){n.v&&(t++,e+="".concat(n.k,": ").concat(g[n.v+"Size"],";\n      ").concat(f.Z.desktop(i||(i=(0,u.Z)(["\n        ",": calc("," * 2);"])),n.k,g[n.v+"Size"]),"\n      "))}),0===t)?(0,p.iv)(r||(r=(0,u.Z)(["\n      margin-bottom: ",";\n      ","\n    "])),g.mdSize,f.Z.desktop(o||(o=(0,u.Z)(["\n        margin-bottom: calc("," * 2);"])),g.mdSize)):(0,p.iv)(a||(a=(0,u.Z)(["\n    ","\n  "])),e)},h=function(n){var e=n.children,t=n.className,i=n.content,r=n.margin,o=n.marginX,a=n.marginY,s=n.marginTop,c=n.marginRight,u=n.marginBottom,l=n.marginLeft,p=n.padding,m=n.paddingX,f=n.paddingY,g=n.paddingTop,v=n.paddingRight,h=n.paddingBottom,Z=n.paddingLeft;return d.createElement(y,{className:t,margin:r,marginX:o,marginY:a,marginTop:s,marginRight:c,marginBottom:u,marginLeft:l,padding:p,paddingX:m,paddingY:f,paddingTop:g,paddingRight:v,paddingBottom:h,paddingLeft:Z},i||e)};h.displayName="Space";var y=p.ZP.div(s||(s=(0,u.Z)(["\n  margin: 0;\n  padding: 0;\n  ","\n"])),function(n){var e=n.margin,t=n.marginBottom,i=n.marginTop,r=n.marginLeft,o=n.marginRight,a=n.marginX,s=n.marginY,u=n.padding,d=n.paddingBottom,l=n.paddingLeft,p=n.paddingRight,m=n.paddingTop,f=n.paddingX,g=n.paddingY;return v([{k:"margin",v:e},{k:"margin-bottom",v:t},{k:"margin-left",v:r},{k:"margin-right",v:o},{k:"margin-top",v:i},{k:"padding",v:u},{k:"padding-bottom",v:d},{k:"padding-left",v:l},{k:"padding-right",v:p},{k:"padding-top",v:m}].concat((0,c.Z)(s?[{k:"margin-top",v:s},{k:"margin-bottom",v:s}]:[]),(0,c.Z)(a?[{k:"margin-left",v:a},{k:"margin-right",v:a}]:[]),(0,c.Z)(g?[{k:"padding-top",v:g},{k:"padding-bottom",v:g}]:[]),(0,c.Z)(f?[{k:"padding-left",v:f},{k:"padding-right",v:f}]:[])))});h.propTypes={children:l.node,content:l.string,margin:(0,l.oneOf)(Object.values(m.Z)),marginY:(0,l.oneOf)(Object.values(m.Z)),marginX:(0,l.oneOf)(Object.values(m.Z)),marginTop:(0,l.oneOf)(Object.values(m.Z)),marginRight:(0,l.oneOf)(Object.values(m.Z)),marginBottom:(0,l.oneOf)(Object.values(m.Z)),marginLeft:(0,l.oneOf)(Object.values(m.Z)),padding:(0,l.oneOf)(Object.values(m.Z)),paddingY:(0,l.oneOf)(Object.values(m.Z)),paddingX:(0,l.oneOf)(Object.values(m.Z)),paddingTop:(0,l.oneOf)(Object.values(m.Z)),paddingRight:(0,l.oneOf)(Object.values(m.Z)),paddingBottom:(0,l.oneOf)(Object.values(m.Z)),paddingLeft:(0,l.oneOf)(Object.values(m.Z))};var Z=h},49501:function(n,e,t){"use strict";var i,r=t(51174),o=t(67294),a=t(45697),s=t(10367),c=t(55843),u=t(51466),d=function(n){var e=n.children,t=n.id,i=n.label,r=n.show,a=n.size;return o.createElement(l,{hasChild:e,htmlFor:t,show:r},o.createElement(c.Z,{marginBottom:"xs"},o.createElement(u.Z,{size:null!=a?a:"md",colour:"darkText",content:i})),e)};d.displayName="FormLabel";var l=s.ZP.label(i||(i=(0,r.Z)(["\n  display: ",";\n  margin-bottom: ",";\n  .react-datepicker-wrapper {\n    width: 100%;\n  }\n"])),function(n){return n.show?"block":"none"},function(n){return n.hasChild?"1rem":"0"});d.propTypes={children:a.node,id:a.string,label:a.string,show:a.bool},d.defaultProps={show:!0},e.Z=d},76312:function(n,e,t){"use strict";var i,r=t(18391),o=t(51174),a=t(67294),s=t(45697),c=t(10367),u=t(28368),d=Array(12).fill(""),l=c.ZP.div(i||(i=(0,o.Z)(["\n  display: inline-block;\n  height: ","px;\n  position: relative;\n  width: ","px;\n\n  div {\n    animation: lds-spinner 1.2s linear infinite;\n    transform-origin: ","px ","px;\n\n    ::after {\n      background: ",";\n      border-radius: ","%;\n      content: ' ';\n      display: block;\n      height: ","px;\n      left: ","px;\n      position: absolute;\n      top: ","px;\n      width: ","px;\n    }\n  }\n\n  ","\n\n  @keyframes lds-spinner {\n    0% {\n      opacity: 1;\n    }\n    100% {\n      opacity: 0;\n    }\n  }\n"])),function(n){return n.size},function(n){return n.size},function(n){return n.size/2},function(n){return n.size/2},function(n){var e=n.context;return n.theme.COLOUR[e]},function(n){return n.size/4},function(n){return n.size/4-2},function(n){return n.size/2-3},function(n){return n.size/10-5},function(n){return n.size/10-2},function(n){var e=n.spinner,t="";return e.forEach(function(n,e){t+="\n        div:nth-child(".concat(e+1,") {\n          transform: rotate(").concat(30*e,"deg);\n          animation-delay: ").concat(-1.1+parseFloat(.1*e),"s;\n        }\n      ")}),t}),p=function(n){return a.createElement(l,(0,r.Z)({},n,{spinner:d}),d.map(function(n,e){return a.createElement("div",{key:"spin"+e})}))};p.displayName="LdsSpinner",p.propTypes={size:s.number,context:(0,s.oneOf)(Object.values(u.Z))},p.defaultProps={context:"dark",size:56},e.Z=p},18645:function(n,e,t){"use strict";var i,r=t(51174),o=t(18391),a=t(66080),s=t(67294),c=t(45697),u=t(10367),d=["children","dataCy","indicator"],l=function(n){var e=n.children,t=n.dataCy,i=n.indicator,r=(0,a.Z)(n,d);return s.createElement(p,(0,o.Z)({"data-cy":t},r),i||e)};l.displayName="PageLoading";var p=u.ZP.div(i||(i=(0,r.Z)(["\n  align-items: center;\n  background-color: ",";\n  color: #fff;\n  display: flex;\n  height: 100%;\n  justify-content: center;\n  left: 0;\n  opacity: ",";\n  position: ",";\n  right: 0;\n  top: 0;\n  width: 100%;\n  z-index: 99;\n"])),function(n){return n.backgroundColor},function(n){return n.opacity},function(n){return n.position});l.propTypes={backgroundColor:c.string,children:c.any,dataCy:c.string,indicator:c.any,opacity:c.number,position:c.string},l.defaultProps={backgroundColor:"#fff",dataCy:"loadingIndicator",opacity:1,position:"fixed"},e.Z=l},68956:function(n,e,t){"use strict";t.d(e,{Z:function(){return x}});var i,r,o=t(67294),a=t(45697),s=t(16551),c=t(28368),u=t(41564),d=function(n){var e=n.children,t=n.tooltip;return o.createElement(u.Z,{content:t},e)};d.displayName="TableActionsTooltip",d.propTypes={children:a.node.isRequired,tooltip:a.string.isRequired};var l=t(51174),p=t(11163),m=t.n(p),f=t(10367),g=t(77439),v=t(40826),h=(0,o.forwardRef)(function(n,e){var t,i=n.context,r=n.disabled,a=n.icon,s=n.numberOverlay,c=n.onClick,u=n.overlayCustom,d=n.row,l=n.to,p=Array.isArray(a),f=d[s]||u,g=c?function(n){return c(n,d)}:(t="".concat(l,"?id=").concat(d.id),function(n){n.preventDefault(),n.stopPropagation(),m().push(t)});return o.createElement(y,{forwardedAs:"a",context:i,disabled:r,itemCount:f,onClick:g,ref:e,size:"sm"},o.createElement(Z,{icon:a?p?a[1]:a:null,prefix:a&&p&&a[0]}))}),y=(0,f.ZP)(g.Z)(i||(i=(0,l.Z)(["\n  font-size: 14px;\n  padding: 0.5rem;\n  position: relative;\n"]))),Z=(0,f.ZP)(v.Z)(r||(r=(0,l.Z)(["\n  pointer-events: 'none';\n"])));h.propTypes={context:(0,a.oneOf)(Object.values(c.Z)),disabled:a.bool,icon:(0,a.oneOfType)([a.array,a.string]),numberOverlay:a.string,onClick:a.func,overlayCustom:a.string,row:a.object.isRequired,to:a.string};var b=function(n){var e,t=n.align,i=n.data,r=n.row;return e="function"==typeof i?i()(r):i,o.createElement(s.Z,{align:t},e.map(function(n,e){var t=n.context,i=n.disabled,a=n.icon,s=n.numberOverlay,c=n.onClick,u=n.overlayCustom,l=n.to,p=n.tooltip;return o.createElement(d,{key:e,tooltip:p},o.createElement(h,{context:t,disabled:i,icon:a,numberOverlay:s,onClick:c,overlayCustom:u,row:r,to:l}))}))};b.displayName="TableActions",b.propTypes={align:a.string,data:(0,a.arrayOf)((0,a.shape)({content:a.string,context:(0,a.oneOf)(Object.values(c.Z)),disabled:a.bool,icon:(0,a.oneOfType)([a.array,a.string]),numberOverlay:a.string,onClick:a.func,overlayCustom:a.string,to:a.string,tooltip:a.string})).isRequired,row:a.object.isRequired},b.defaultProps={align:"flex-start"};var x=b},68430:function(n,e,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/scheduledjob",function(){return t(25467)}])},2173:function(n,e,t){"use strict";t.d(e,{W:function(){return l}});var i=t(47568),r=t(7297),o=t(97582),a=t(75063),s=t(63139),c=t(13777);function u(){var n=(0,r.Z)(["\n  mutation CreateSupplierPpmInvoicePdf($accountEntryId: Int!) {\n    invoice: createSupplierPpmInvoicePdf(accountEntryId: $accountEntryId) {\n      success\n      key\n    }\n  }\n"]);return u=function(){return n},n}var d,l=(d=(0,i.Z)(function(n){var e,t,i,r,a,u,d,l,m,f,g,v;return(0,o.__generator)(this,function(o){switch(o.label){case 0:e=n.client,t=n.accountEntryId,i=n.getUrl,o.label=1;case 1:return o.trys.push([1,3,,4]),a="",(0,s.a)()||i||(r=window.open("/download","_blank")),[4,e.mutate({mutation:p,variables:{accountEntryId:t}})];case 2:return l=o.sent().data.invoice.key,i?a="".concat("https://cleverly-pre-prod-media.s3.eu-west-2.amazonaws.com","/").concat(l):(null==r||null===(m=r.location)||void 0===m||m.assign("".concat("https://cleverly-pre-prod-media.s3.eu-west-2.amazonaws.com","/").concat(l)),(null==window?void 0:null===(f=window.Capacitor)||void 0===f?void 0:null===(g=f.Plugins)||void 0===g?void 0:g.Browser)&&window.Capacitor.Plugins.Browser.open({url:"".concat("https://cleverly-pre-prod-media.s3.eu-west-2.amazonaws.com","/").concat(l)})),[2,a];case 3:return v=o.sent(),(0,c.Tb)({message:v,section:"fetch"}),[3,4];case 4:return[2]}})}),function(n){return d.apply(this,arguments)}),p=(0,a.Ps)(u())},9489:function(n,e,t){"use strict";t.d(e,{I:function(){return p}});var i=t(26042),r=t(69396),o=t(99534),a=t(85893),s=t(5616),c=t(51233),u=t(50135),d=t(90948),l=t(15861),p=function(n){var e=n.leftLabel,t=n.rightLabel,s=n.error,u=(0,o.Z)(n,["leftLabel","rightLabel","error"]);return(0,a.jsxs)(c.Z,{direction:"row",alignItems:"center",children:[(0,a.jsx)(m,{sx:{borderTopLeftRadius:"5px",borderBottomLeftRadius:"5px"},error:s,children:(0,a.jsx)(l.Z,{sx:{display:"flex",justifyContent:"center",alignItems:"center",whiteSpace:"nowrap"},children:e})}),(0,a.jsx)(f,(0,r.Z)((0,i.Z)({},u),{variant:"outlined",size:"small",error:s})),(0,a.jsx)(m,{sx:{borderTopRightRadius:"5px",borderBottomRightRadius:"5px"},error:s,children:(0,a.jsx)(l.Z,{sx:{display:"flex",justifyContent:"center",alignItems:"center",whiteSpace:"nowrap"},variant:"body2",fontWeight:700,children:t})})]})},m=(0,d.ZP)(s.Z)(function(n){var e=n.theme;return{display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:n.error?e.palette.danger.main:"#D9D9D9",minwidth:"28px",height:"28px",padding:"0 5px"}}),f=(0,d.ZP)(u.Z)(function(n){var e=n.theme,t=n.error;return{height:"28px","& .MuiInputBase-root ":{borderRadius:"0px","&.Mui-focused":{"& .MuiOutlinedInput-notchedOutline":{borderColor:t?e.palette.danger.main:"#D9D9D9"}},"& .MuiInputBase-input":{padding:"2px 14px",borderColor:t?e.palette.danger.main:"#D9D9D9",borderStyle:"solid",borderBottomWidth:"2.5px",borderTopWidth:"2px"},"& .MuiOutlinedInput-notchedOutline":{border:"none"}}}})},46602:function(n,e,t){"use strict";t.d(e,{k:function(){return b}});var i=t(26042),r=t(69396),o=t(85893),a=t(45697),s=t(42283),c=t(79665),u=t(76600),d=t(9270),l=t(62140),p=t(49501),m=t(55563),f=t(6710),g=t(95103),v=t(74231),h=(0,v.Ry)().shape({name:(0,v.Z_)(),invoicingEntity:(0,v.Z_)(),addressLine1:(0,v.Z_)().required(),addressLine2:(0,v.Z_)(),addressLine3:(0,v.Z_)(),city:(0,v.Z_)().required(),postCode:(0,v.Z_)().matches("^([Gg][Ii][Rr] 0[Aa]{2})|((([A-Za-z][0-9]{1,2})|(([A-Za-z][A-Ha-hJ-Yj-y][0-9]{1,2})|(([A-Za-z][0-9][A-Za-z])|([A-Za-z][A-Ha-hJ-Yj-y][0-9][A-Za-z]?))))\\s?[0-9][A-Za-z]{2})$|^([AC-FHKNPRTV-Y]\\d{2}|D6W)\\s[0-9AC-FHKNPRTV-Y]{4}$").required(),county:(0,v.Z_)(),countryId:(0,v.Z_)().required()}),y=t(25742),Z=t(73760),b=function(n){var e=n.defaultValues,t=(n.onCancel,n.onSubmit),a=n.type,v=(0,s.cI)({defaultValues:(0,i.Z)({},e),resolver:(0,c.S)(h)}),b=v.control,x=v.errors,_=v.handleSubmit,I={control:b,errors:x,register:v.register};return(0,o.jsxs)(u.Z,{id:"offCanvasForm",handleSubmit:_(t),children:[(0,o.jsxs)(d.Z,{children:[(0,o.jsx)(l.Z,{md:12,children:(0,o.jsx)(p.Z,{label:"Address name",children:(0,o.jsx)(m.Z,(0,r.Z)((0,i.Z)({},I),{name:"name"}))})}),"invoice"===a&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(l.Z,{md:12,children:(0,o.jsx)(p.Z,{label:"invoicing email",children:(0,o.jsx)(m.Z,(0,r.Z)((0,i.Z)({},I),{name:"invoicingEmail",type:"email"}))})}),(0,o.jsx)(l.Z,{md:12,children:(0,o.jsx)(p.Z,{label:"Invoicing entity",children:(0,o.jsx)(f.Z,(0,r.Z)((0,i.Z)({},I),{name:"invoicingEntity",rows:4}))})})]}),(0,o.jsx)(l.Z,{md:6,children:(0,o.jsx)(p.Z,{label:"Address Line 1",children:(0,o.jsx)(m.Z,(0,r.Z)((0,i.Z)({},I),{name:"addressLine1"}))})}),(0,o.jsx)(l.Z,{md:6,children:(0,o.jsx)(p.Z,{label:"Address Line 2",children:(0,o.jsx)(m.Z,(0,r.Z)((0,i.Z)({},I),{name:"addressLine2"}))})}),(0,o.jsx)(l.Z,{md:6,children:(0,o.jsx)(p.Z,{label:"Address Line 3",children:(0,o.jsx)(m.Z,(0,r.Z)((0,i.Z)({},I),{name:"addressLine3"}))})}),(0,o.jsx)(l.Z,{md:6,children:(0,o.jsx)(p.Z,{label:"City",children:(0,o.jsx)(m.Z,(0,r.Z)((0,i.Z)({},I),{name:"city"}))})}),(0,o.jsx)(l.Z,{md:6,children:(0,o.jsx)(p.Z,{label:"Post Code",children:(0,o.jsx)(m.Z,(0,r.Z)((0,i.Z)({},I),{name:"postCode"}))})}),(0,o.jsx)(l.Z,{md:6,children:(0,o.jsx)(p.Z,{label:"County",children:(0,o.jsx)(m.Z,(0,r.Z)((0,i.Z)({},I),{name:"county"}))})}),(0,o.jsx)(l.Z,{md:6,children:(0,o.jsx)(p.Z,{label:"Country",children:(0,o.jsx)(g.Z,(0,r.Z)((0,i.Z)({},I),{name:"countryId",options:Z.O}))})})]}),(0,o.jsx)(d.Z,{justify:"end",children:(0,o.jsx)(l.Z,{md:12,children:(0,o.jsx)(y.H,{content:"Submit",type:"submit"})})}),(null==e?void 0:e.id)&&(0,o.jsx)(m.Z,(0,r.Z)((0,i.Z)({},I),{name:"id",type:"hidden"})),(null==e?void 0:e.meta)&&(0,o.jsx)(m.Z,(0,r.Z)((0,i.Z)({},I),{name:"meta",type:"hidden"}))]})};b.propTypes={defaultValues:a.object,onCancel:a.func.isRequired,onSubmit:a.func.isRequired,type:a.string}},36641:function(n,e,t){"use strict";t.d(e,{H:function(){return L}});var i=t(47568),r=t(14924),o=t(828),a=t(29815),s=t(97582),c=t(85893),u=t(67294),d=t(45697),l=t(6812),p=t(50319),m=t(66312),f=t(33006),g=t(15214),v=t(26042),h=t(68956),y=t(49501),Z=t(62047),b=t(51466),x=t(2931),_=t(55843),I=t(16540),j=t(25742),$=t(46602),A=t(13777),w=t(64872),S=function(n){var e,t=n.addresses,r=n.entity,a=n.entityId,d=(n.id,n.loading),l=n.onSelected,f=n.refetch,g=n.selectable,S=n.selected,C=n.type,k=n.editable,L=(0,w.a)(),P=(0,u.useState)(1),q=P[0],O=P[1],U=(0,o.Z)((0,p.D)(m.BO,{onCompleted:function(){L.close(),f()}}),1)[0],T=(0,o.Z)((0,p.D)(m._r,{onCompleted:function(){L.close(),f()}}),1)[0],E=function(n,e){l(n,e)},z=(e=(0,i.Z)(function(n){var e,t,i,o,c;return(0,s.__generator)(this,function(s){switch(s.label){case 0:return(e=n).countryId||(e.countryId=1),t={address:e},[4,window.fetch("".concat("https://aws-pre-prod.cleverly.works","/google/maps/geocode"),{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify(t)}).then(function(n){return n.json()}).catch(function(n){(0,A.Tb)({message:n,section:"fetch"})})];case 1:if(i=s.sent(),n.id?e.meta=(0,v.Z)({invoicingEmail:n.invoicingEmail},n.meta):e.meta={invoicingEmail:n.invoicingEmail},delete e.invoicingEmail,(null==(o=(null==i?void 0:i.coordinates)||null)?void 0:o.lat)&&(null==o?void 0:o.lng)&&(e.geo={type:"Point",coordinates:[o.lng,o.lat]}),!n.id)return[3,3];return c=parseInt(n.id),[4,T({variables:{id:c,changes:e}})];case 2:return s.sent(),[3,5];case 3:return e.Address_Entities={data:{entity:r,entityId:a,status:"active"}},[4,U({variables:{objects:[e]}})];case 4:s.sent(),s.label=5;case 5:return[2]}})}),function(n){return e.apply(this,arguments)}),R=function(n){L.close()},F=function(n){var e,i={},r=t.find(function(e){return e.id===n.id}),o=r?r.address:null;o&&(i.id=o.id,i.invoicingEmail=null===(e=o.meta)||void 0===e?void 0:e.invoicingEmail,i.invoicingEntity=o.invoicingEntity,i.name=o.name,i.addressLine1=o.addressLine1,i.addressLine2=o.addressLine2,i.addressLine3=o.addressLine3,i.city=o.city,i.postCode=o.postCode,i.county=o.county,i.countryId=o.countryId),L.show({content:(0,c.jsx)($.k,{defaultValues:i,onCancel:R,onSubmit:z,type:C}),title:o?"Edit address":"invoice"===C?"Add new invoice address":"Add new address",submit:!1})},M=[{hidden:!0},{hidden:!g||!k,text:"Select"},{text:"Address"},{hidden:"invoice"!==C,text:"Email"},{formatter:h.Z,formatterData:[{context:"secondary",icon:["fas","edit"],onClick:function(n,e){return F(e)},tooltip:"Edit"}],text:"Actions",hidden:!k}],B=(null==t?void 0:t.map(function(n,e){var t,i=n.address;return{id:n.id,select:function(){return(0,c.jsx)(y.Z,{children:(0,c.jsx)(Z.Z,{context:"secondary",onToggle:function(n){return E(i.id,n)},size:"sm",toggled:Number(S)===i.id})})},address:function(){var n;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(b.Z,{content:null==i?void 0:i.name,size:"md"}),(0,c.jsx)(x.Z,{country:(null===(n=i.country)||void 0===n?void 0:n.name)||"",line1:i.addressLine1,town:i.city})]})},email:(null===(t=i.meta)||void 0===t?void 0:t.invoicingEmail)||"-",actions:""}}))||[];return(0,c.jsxs)(c.Fragment,{children:[k&&(0,c.jsx)(j.H,{content:"Add new address",handleClick:F}),(0,c.jsx)(_.Z,{marginBottom:"xs"}),(0,c.jsx)(I.Z,{columns:M,loading:d,pagination:!0,paginationProps:{currentPage:q,onPageChange:function(n){O(n)},onPageSizeChange:function(){},pageCount:Math.ceil((null==B?void 0:B.length)/50),perPage:50},rows:null==B?void 0:B.slice((q-1)*50,50*q)})]})};S.propTypes={addresses:d.array.isRequired,entity:d.string.isRequired,entityId:d.number.isRequired,id:d.number,loading:d.bool.isRequired,onSelected:d.func.isRequired,refetch:d.func.isRequired,selectable:d.bool.isRequired,selected:d.number,type:d.string},S.defaultProps={addresses:[],selectable:!1,selected:""};var C=t(85113),k=t(2845),L=function(n){var e,t,d,v,h=n.addressId,y=n.entity,Z=n.entityId,b=n.id,x=n.onSubmit,_=n.type,I=(0,u.useState)(h||null),j=I[0],$=I[1],A=(0,u.useState)(!1),w=A[0],L=A[1],P=(0,u.useState)(null),q=P[0],O=P[1],U=(0,C.DM)(_),T=(0,C.VJ)(y),E=(0,(0,k.x)().hasRole)("customer"),z=(0,l.a)(T,{variables:{id:Z}}),R=z.loading,F=z.data,M=(void 0===F?{item:null}:F).item,B=z.refetch,N=(0,o.Z)((0,p.D)(m.x0,{onCompleted:function(n){x&&x(n)}}),1)[0],D=(0,o.Z)((0,p.D)(m.y8,{onCompleted:function(n){x&&x(n)}}),1)[0],Y=[];M&&(M.addresses&&Y.push.apply(Y,(0,a.Z)(M.addresses)),M.accounts&&(null===(e=M.accounts[0])||void 0===e?void 0:null===(t=e.account)||void 0===t?void 0:t.addresses)&&M.accounts[0].account.addresses.forEach(function(n){Y.find(function(e){return e.address.id===n.address.id})||Y.push(n)}));var X,V=(v=(0,i.Z)(function(n,e){return(0,s.__generator)(this,function(t){switch(t.label){case 0:if(O(!1),L(!1),!e)return[3,2];return $(parseInt(n)),[4,G(parseInt(n))];case 1:return t.sent(),[3,3];case 2:L(!0),t.label=3;case 3:return[2]}})}),function(n,e){return v.apply(this,arguments)}),G=(X=(0,i.Z)(function(n){var e,t,i,o,a;return(0,s.__generator)(this,function(o){switch(o.label){case 0:if(!(j!==n))return[3,5];if(e=null,t=null,Y.forEach(function(i){i.address.id===n&&(e=i.entity,t=i.id)}),!(t&&e===y))return[3,2];return i={id:parseInt(t),changes:(0,r.Z)({},_,!0),whereOld:(0,r.Z)({entityId:{_eq:Z}},_,{_eq:!0}),changesOld:(0,r.Z)({},_,!1)},[4,D({variables:i})];case 1:return o.sent(),O(!0),[3,4];case 2:return a={objects:[(0,r.Z)({addressId:parseInt(n),entity:y,entityId:Z,status:"active"},_,!0)],whereOld:(0,r.Z)({entityId:{_eq:Z}},_,{_eq:!0}),changesOld:(0,r.Z)({},_,!1)},[4,N({variables:a})];case 3:o.sent(),O(!0),o.label=4;case 4:return[3,6];case 5:x&&x(null),o.label=6;case 6:return[2]}})}),function(n){return X.apply(this,arguments)});return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(f.Z,{tag:"h4",content:U}),q&&(0,c.jsx)(g.Z,{content:"Selection saved.",context:"primary"}),w&&(0,c.jsx)(g.Z,{content:"You should select at least one address.",context:"info"}),(0,c.jsx)(S,{addresses:Y,entity:y,entityId:Z,id:b,loading:R,refetch:B,selectable:!0,selected:j,type:_,onSelected:V,editable:!E})]})};L.propTypes={addressId:d.number,entity:d.string.isRequired,entityId:d.number.isRequired,id:d.number,onSubmit:d.func.isRequired,type:d.string.isRequired}},35381:function(n,e,t){"use strict";t.d(e,{il:function(){return o},j$:function(){return i},wo:function(){return r}});var i=function(n,e){if(Array.isArray(e)){var t,i,r=null;return e.forEach(function(e){var t,i,o=null===(t=n.timings)||void 0===t?void 0:t.find(function(n){return n.status===e});r=(null==o?void 0:null===(i=o.user)||void 0===i?void 0:i.fullName)||r}),r}var o=null===(t=n.timings)||void 0===t?void 0:t.find(function(n){return n.status===e});return(null==o?void 0:null===(i=o.user)||void 0===i?void 0:i.fullName)||null},r=function(n,e){if(Array.isArray(e)){var t,i=null;return e.forEach(function(e){var t,r=null===(t=n.timings)||void 0===t?void 0:t.find(function(n){return n.status===e});i=(null==r?void 0:r.id)||i}),i}var r=null===(t=n.timings)||void 0===t?void 0:t.find(function(n){return n.status===e});return(null==r?void 0:r.id)||null},o=function(n,e){return!n||n>e}},93884:function(n,e,t){"use strict";t.d(e,{C:function(){return m}});var i=t(26042),r=t(69396),o=t(85893);t(67294);var a=t(45697),s=t(90948),c=t(15861),u=t(51233),d=t(11057),l=t(61730),p=(0,s.ZP)("img")({width:"300px",height:"250px"}),m=function(n){var e=n.imageSrc,t=n.sx,a=n.imageSx,s=n.title,m=n.titleSx,f=n.subtitleFirstLine,g=n.subtitleFirstLineSx,v=n.subtitleSecondLine,h=n.subtitleSecondLineSx,y=n.buttonText,Z=n.onAction,b=(0,l.Z)("(max-width: 400px)");return(0,o.jsxs)(u.Z,{sx:(0,r.Z)((0,i.Z)({},t),{width:"100%",height:"100%"}),justifyContent:"center",alignItems:"center",spacing:2,color:"#757575",children:[(0,o.jsx)(p,{src:e,sx:(0,r.Z)((0,i.Z)({},a),{width:b?"250px":"300px"})}),(0,o.jsx)(c.Z,{typography:"h5",sx:(0,i.Z)({},m),children:s}),(0,o.jsxs)(u.Z,{alignItems:"center",sx:{padding:"0px 10px",textAlign:"center"},children:[(0,o.jsx)(c.Z,{sx:(0,i.Z)({},g),children:f}),(0,o.jsx)(c.Z,{sx:(0,i.Z)({},h),children:v})]}),y&&Z&&(0,o.jsx)(d.Z,{variant:"contained",color:"secondary",onClick:Z,children:y})]})};m.propTypes={imageSrc:a.string,title:a.string,subtitleFirstLine:a.string,subtitleSecondLine:a.string,onAction:a.func,sx:a.object,imageSx:a.object,titleSx:a.object,subtitleFirstLineSx:a.object,subtitleSecondLineSx:a.object},m.defaultProps={title:"",subtitleFirstLine:"",subtitleSecondLine:"",sx:{},imageSx:{},titleSx:{},subtitleFirstLineSx:{},subtitleSecondLineSx:{},onAction:null}},75327:function(n,e,t){"use strict";t.d(e,{$E:function(){return T},AX:function(){return j},I4:function(){return I},JA:function(){return A},MT:function(){return L},Px:function(){return S},WF:function(){return w},ZA:function(){return R},a8:function(){return C},fA:function(){return U},fo:function(){return $},ge:function(){return z},iM:function(){return O},nE:function(){return P},nh:function(){return q},r1:function(){return k},tW:function(){return F},uz:function(){return E}});var i=t(7297),r=t(75063);function o(){var n=(0,i.Z)(["\n  mutation InsertAccountUser($objects: [Account_User_insert_input!]!) {\n    insert_Account_User(objects: $objects) {\n      returning {\n        id\n      }\n    }\n  }\n"]);return o=function(){return n},n}function a(){var n=(0,i.Z)(["\n  mutation UpdateUser(\n    $id: Int!\n    $accountUserId: Int!\n    $accountUserChanges: Account_User_set_input\n    $changes: User_set_input\n    $updateAccountUser: Boolean!\n  ) {\n    update_Account_User_by_pk(pk_columns: { id: $accountUserId }, _set: $accountUserChanges)\n      @include(if: $updateAccountUser) {\n      id\n    }\n    update_User_by_pk(pk_columns: { id: $id }, _set: $changes) {\n      id\n    }\n  }\n"]);return a=function(){return n},n}function s(){var n=(0,i.Z)(["\n  query GetUsers(\n    $accountId: Int\n    $accountType: String\n    $date: timestamptz\n    $limit: Int\n    $offset: Int\n    $q: String\n    $orderBy: User_order_by!\n    $status: String\n  ) {\n    users: User(\n      limit: $limit\n      offset: $offset\n      where: {\n        Account_Users: { Account: { id: { _eq: $accountId }, type: { _eq: $accountType } } }\n        createdAt: { _eq: $date }\n        _or: [\n          { email: { _ilike: $q } }\n          { nameFirst: { _ilike: $q } }\n          { nameLast: { _ilike: $q } }\n        ]\n        status: { _eq: $status }\n      }\n      order_by: [$orderBy]\n    ) {\n      id\n      name: nameFirst\n      nameFirst\n      nameLast\n      phone\n      status\n      email\n      createdAt\n      meta\n      invoiceThreshold\n      quoteThreshold\n      media: Media {\n        id\n        medium: Medium {\n          id\n          category\n          filename\n          meta\n          type\n        }\n      }\n      accounts: Account_Users {\n        id\n        role\n        position\n        isContact\n        status\n        account: Account {\n          id\n          name\n          type\n        }\n        userLocations: User_Account_Locations {\n          accountLocationId\n        }\n      }\n    }\n    meta: User_aggregate(\n      where: {\n        Account_Users: { Account: { id: { _eq: $accountId }, type: { _eq: $accountType } } }\n        createdAt: { _eq: $date }\n        _or: [{ nameFirst: { _ilike: $q } }, { nameLast: { _ilike: $q } }]\n        status: { _eq: $status }\n      }\n    ) {\n      aggregate {\n        totalCount: count\n      }\n    }\n  }\n"]);return s=function(){return n},n}function c(){var n=(0,i.Z)(["\n  query GetUser($id: Int!) {\n    user: User_by_pk(id: $id) {\n      id\n      fullName\n      name: nameFirst\n      nameFirst\n      nameLast\n      phone\n      status\n      email\n      createdAt\n      meta\n      invoiceThreshold\n      quoteThreshold\n      media: Media {\n        id\n        medium: Medium {\n          id\n          category\n          filename\n          meta\n          type\n        }\n      }\n      accounts: Account_Users {\n        id\n        role\n        position\n        isContact\n        status\n        account: Account {\n          id\n          name\n          type\n        }\n      }\n    }\n  }\n"]);return c=function(){return n},n}function u(){var n=(0,i.Z)(["\n  query CheckDuplicateEmail($email: String!) {\n    users: User_public(where: { email: { _eq: $email } }) {\n      id\n      nameFirst\n      nameLast\n      email\n      phone\n    }\n  }\n"]);return u=function(){return n},n}function d(){var n=(0,i.Z)(["\n  fragment UserFields on User {\n    id\n    email\n    nameFirst\n    nameLast\n    fullName\n    phone\n    status\n  }\n"]);return d=function(){return n},n}function l(){var n=(0,i.Z)(["\n  mutation SendGoogleAuthCode($code: String!, $id: Int!, $type: String!) {\n    createGoogleToken(code: $code, id: $id, type: $type) {\n      success\n      tokens\n      error\n    }\n  }\n"]);return l=function(){return n},n}function p(){var n=(0,i.Z)(["\n  mutation GenerateMSURL($type: String!, $id: Int!) {\n    genenrateMSURL(id: $id, type: $type) {\n      url\n    }\n  }\n"]);return p=function(){return n},n}function m(){var n=(0,i.Z)(["\n  mutation signoutMS($id: Int!, $type: String!, $email: String!) {\n    signoutMS(id: $id, type: $type, email: $email) {\n      error\n      msId\n      success\n    }\n  }\n"]);return m=function(){return n},n}function f(){var n=(0,i.Z)(["\n  query getAccountMeta($id: Int!) {\n    account: Account_by_pk(id: $id) {\n      meta\n    }\n  }\n"]);return f=function(){return n},n}function g(){var n=(0,i.Z)(["\n  query user($id: Int!) {\n    user: User_by_pk(id: $id) {\n      meta\n      invoiceThreshold\n      quoteThreshold\n    }\n  }\n"]);return g=function(){return n},n}function v(){var n=(0,i.Z)(["\n  query GetAccountUserMeta($userId: Int!, $accountId: Int!) {\n    accountUser: Account_User(where: { userId: { _eq: $userId }, accountId: { _eq: $accountId } }) {\n      meta\n    }\n  }\n"]);return v=function(){return n},n}function h(){var n=(0,i.Z)(["\n  mutation UpdateAccountUserByUserIdAccoutId(\n    $userId: Int!\n    $accountId: Int!\n    $changes: Account_User_set_input!\n  ) {\n    update_Account_User(\n      where: { userId: { _eq: $userId }, accountId: { _eq: $accountId } }\n      _set: $changes\n    ) {\n      returning {\n        id\n      }\n    }\n  }\n"]);return h=function(){return n},n}function y(){var n=(0,i.Z)(["\n  mutation updateAccount($accountId: Int!, $set: Account_set_input!) {\n    update_Account_by_pk(pk_columns: { id: $accountId }, _set: $set) {\n      id\n    }\n  }\n"]);return y=function(){return n},n}function Z(){var n=(0,i.Z)(["\n  mutation updateUserMeta($userId: Int!, $meta: jsonb!) {\n    update_User_by_pk(pk_columns: { id: $userId }, _set: { meta: $meta }) {\n      id\n      meta\n    }\n  }\n"]);return Z=function(){return n},n}function b(){var n=(0,i.Z)(['\n  query userDevices($accountId: Int!) {\n    users: User(\n      where: {\n        Account_Users: { accountId: { _eq: $accountId }, status: { _eq: "active" } }\n        UserDevices: { status: { _eq: "active" } }\n        status: { _eq: "active" }\n      }\n    ) {\n      id\n      fullName\n      devices: UserDevices(\n        order_by: { updatedAt: desc_nulls_last }\n        where: { status: { _eq: "active" } }\n        limit: 1\n      ) {\n        id\n        playerId\n      }\n    }\n  }\n']);return b=function(){return n},n}function x(){var n=(0,i.Z)(['\n  query GetAccountLocations($accountId: Int, $limit: Int, $offset: Int) {\n    location: Location(\n      offset: $offset\n      limit: $limit\n      where: {\n        Account_Locations: {\n          accountId: { _eq: $accountId }\n          Account: { type: { _eq: "customer" } }\n        }\n      }\n    ) {\n      id\n      name\n      accountLocations: Account_Locations {\n        id\n      }\n      addresses: Addresses(where: { entity: { _eq: "Location" }, registered: { _eq: true } }) {\n        id\n        status\n        address: Address {\n          id\n          name\n          addressLine1\n          postCode\n        }\n      }\n    }\n    meta: Location_aggregate(\n      where: {\n        Account_Locations: {\n          accountId: { _eq: $accountId }\n          Account: { type: { _eq: "customer" } }\n        }\n      }\n    ) {\n      aggregate {\n        totalCount: count\n      }\n    }\n  }\n']);return x=function(){return n},n}function _(){var n=(0,i.Z)(["\n  mutation InsertUserAccountLocations(\n    $accountUserId: Int!\n    $objects: [User_Account_Location_insert_input!]!\n  ) {\n    delete_User_Account_Location(where: { accountUserId: { _eq: $accountUserId } }) {\n      affected_rows\n    }\n    insert_User_Account_Location(objects: $objects) {\n      affected_rows\n      returning {\n        id\n      }\n    }\n  }\n"]);return _=function(){return n},n}var I=(0,r.Ps)(o()),j=(0,r.Ps)(a()),$=(0,r.Ps)(s()),A=(0,r.Ps)(c()),w=(0,r.Ps)(u()),S=(0,r.Ps)(d()),C=(0,r.Ps)(l()),k=(0,r.Ps)(p()),L=(0,r.Ps)(m()),P=(0,r.Ps)(f()),q=(0,r.Ps)(g()),O=(0,r.Ps)(v()),U=(0,r.Ps)(h()),T=(0,r.Ps)(y()),E=(0,r.Ps)(Z()),z=(0,r.Ps)(b()),R=(0,r.Ps)(x()),F=(0,r.Ps)(_())},97432:function(n,e,t){"use strict";t.d(e,{l:function(){return i}});var i=function(n,e){var t=Math.pow(10,e);return Math.round(n*t)/t}},73760:function(n,e,t){"use strict";t.d(e,{O:function(){return i},v:function(){return r}});var i=[{text:"Country",value:""},{text:"United Kingdom",value:1},{text:"Ireland",value:4}],r=[{label:"United Kingdom",value:1},{label:"Ireland",value:4}]},98552:function(n,e,t){"use strict";t.d(e,{SR:function(){return a},Tq:function(){return s},YK:function(){return o},cJ:function(){return r},pX:function(){return i}});var i=["customerVat","supplier"],r=["ProformaInvoiceCustomer","ProformaInvoiceSupplier"],o=["customerPpmInvoice","supplierPpmInvoice"],a={customer:["customerVat","ProformaInvoiceCustomer","customerPpmInvoice"],supplier:["supplier","ProformaInvoiceSupplier","supplierPpmInvoice"]},s={customerVat:"Customer VAT Invoice",supplier:"Supplier Invoice",ProformaInvoiceCustomer:"Customer ad-hoc Invoice",ProformaInvoiceSupplier:"Supplier ad-hoc Invoice",customerPpmInvoice:"PPM Customer Invoice",supplierPpmInvoice:"PPM Supplier Invoice"}},25467:function(n,e,t){"use strict";t.r(e);var i=t(85893),r=t(58849),o=t(5201),a={filterType:"page"},s={filterType:"page"},c={filterType:"page"},u=function(){return(0,i.jsx)(o.A,{showLocationSelector:!0,calendarInitialFilters:a,tableInitialFilters:s,itemsInitialFilters:c})};u.getLayout=function(n){return(0,i.jsx)(r.Z,{children:n})},e.default=u}},function(n){n.O(0,[3662,6898,9809,2283,212,619,8890,2583,4135,8579,6043,1564,4244,3911,3776,5370,2329,778,6540,4046,1023,9957,1870,2797,653,8062,2429,597,4211,8948,1121,1303,6127,7548,8344,8849,6733,1741,2781,5201,9774,2888,179],function(){return n(n.s=68430)}),_N_E=n.O()}]);