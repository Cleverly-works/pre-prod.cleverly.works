"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1741,4972],{5336:function(n,e,t){t.d(e,{C:function(){return j}});var i=t(85893),r=t(67294),o=t(45697),a=t.n(o),s=t(93946),u=t(25464),c=t(18972),l=t(57976),d=t(73890),m=t(69008),f=t(41687),p=t(60888),y=t(40535),h=t(63441),g=t(41733),v=t(77957),$=t(2548),b=t(24519),_=t(2391),q=t(69308),x=t(79369),I=t(22961),Z=t(28201),w=t(51233),S=t(15861),C={add:(0,i.jsx)(f.Z,{}),archive:(0,i.jsx)(d.Z,{}),avatar:(0,i.jsx)(Z.Z,{}),check:(0,i.jsx)(p.Z,{}),delete:(0,i.jsx)(g.Z,{}),description:(0,i.jsx)(y.Z,{}),download:(0,i.jsx)(h.Z,{}),info:(0,i.jsx)($.Z,{}),edit:(0,i.jsx)(v.Z,{}),location:(0,i.jsx)(q.Z,{}),unarchive:(0,i.jsx)(m.Z,{}),uploadFile:(0,i.jsx)(b.Z,{}),receipt:(0,i.jsx)(_.Z,{}),visibility:(0,i.jsx)(I.Z,{})},P={default:(0,i.jsx)(l.Z,{}),defaultHoriz:(0,i.jsx)(x.Z,{}),description:(0,i.jsx)(y.Z,{})},j=function(n){var e=n.actionsData,t=n.icon,o=n.row,a=n.disabled,l=(0,r.useState)(null),d=l[0],m=l[1],f=function(n){n.stopPropagation(),m(n.currentTarget)},p=function(){m(null)};return(0,i.jsxs)("div",{children:[(0,i.jsx)(s.Z,{sx:{":hover":{backgroundColor:"#DDDDDD"}},disabled:a,"aria-controls":"simple-menu","aria-haspopup":"true",onClick:f,children:P[t]}),(0,i.jsx)(u.Z,{id:"simple-menu",anchorEl:d,keepMounted:!0,open:Boolean(d),onClose:p,PaperProps:{sx:{borderRadius:2}},children:e(o).map(function(n,e){return(0,i.jsx)(c.Z,{disabled:n.disabled,onClick:function(e){n.onClick(e),p()},sx:{pl:3,pr:4},children:(0,i.jsxs)(w.Z,{direction:"row",alignItems:"center",spacing:2,children:[(null==C?void 0:C[n.icon])||null,(0,i.jsx)(S.Z,{children:n.tooltip})]})},e)})})]})};j.propTypes={actionsData:a().func.isRequired,icon:a().oneOf(["default","description"]),row:a().any.isRequired,disabled:a().bool},j.defaultProps={actionsData:function(){return[{disabled:!1,onClick:function(){},icon:"edit",tooltip:"Edit"}]},icon:"default",disabled:!1}},86267:function(n,e,t){t.d(e,{G:function(){return R}});var i=t(26042),r=t(69396),o=t(85893),a=t(45697),s=t.n(a),u=t(6812),c=t(52824),l=t(15033),d=t(23892),m=t(39087),f=t(76256),p=t(40826),y=function(n,e){var t=function(){return(0,o.jsx)(p.Z,{context:"success",icon:"check",size:"sm",title:"Yes"})},i=function(){return(0,o.jsx)(p.Z,{context:"warning",icon:"times",size:"sm",title:"No"})},r=function(){return(0,o.jsx)(p.Z,{context:"dark",icon:"minus",size:"sm",title:"Unavailable"})};return"image"===n?(null==e?void 0:e.thumbnails)&&(null==e?void 0:e.thumbnails.length)?t:i:r},h=t(20705),g=t(2845),v=t(86532),$=t(22797),b=t(38895),_=t(5616),q=t(11057),x=t(51233),I=t(21023),Z=t(15861),w=t(14924),S=t(70872),C=t(58886),P=t(90948),j=t(67294),k=t(77314),M=(0,t(42850).bH)(k.ZP),G=function(n){var e=n.images,t=n.showPagination,r=n.height,a=(0,j.useState)(0),s=a[0],u=a[1],c=function(n){u(n)};return(0,o.jsxs)(x.Z,{width:"100%",alignItems:"center",children:[(0,o.jsx)(M,{index:s,onChangeIndex:c,enableMouseEvents:!0,interval:1e4,children:e.map(function(n){return(0,o.jsx)(_.Z,{component:"img",sx:{height:r,display:"block",overflow:"hidden",width:"100%",objectFit:"cover"},src:n.filename,alt:n.caption},n.caption)})}),t&&e.length>1&&(0,o.jsx)(T,{page:s+1,count:e.length,onChange:function(n,e){return c(e-1)},variant:"outlined",shape:"rounded",renderItem:function(n){return(0,o.jsx)(C.Z,(0,i.Z)({slots:{previous:function(){return"Previous"},next:function(){return"Next"}}},n))}})]})};G.defaultProps={images:[],showPagination:!0},G.propTypes={height:s().oneOfType([s().string,s().number]),images:s().arrayOf(s().shape({caption:s().string,filename:s().string.isRequired}).isRequired).isRequired,showPagination:s().bool};var T=(0,P.ZP)(S.Z)(function(n){n.hidePrevButton,n.hideNextButton;var e,t=n.theme;return e={},(0,w.Z)(e,"&.MuiPagination-root",{alignSelf:"center",marginTop:"16px"}),(0,w.Z)(e,"& .MuiPaginationItem-root",{fontWeight:600,margin:0,borderRadius:0}),(0,w.Z)(e,"& .MuiPagination-ul > li:last-child .MuiPaginationItem-previousNext:last-child",{margin:0,borderRadius:"0 5px 5px 0"}),(0,w.Z)(e,"& .MuiPagination-ul > li:first-child .MuiPaginationItem-previousNext:last-child",{margin:0,borderRadius:"5px 0 0 5px"}),(0,w.Z)(e,"& button.Mui-selected",{color:t.palette.white.main,backgroundColor:t.palette.secondary.main}),e}),A=t(27434),F=t(5336),D=t(12547),L=t(64872),R=function(n){var e=n.carousel,t=n.category,a=n.data,s=n.entity,p=n.entityId,w=n.filters,S=n.listView,C=n.mediaMeta,P=n.onMediaAdd,j=n.onMediaRemove,k=n.showActionButtons,M=n.showEntityColumn,T=n.showItemActions,R=n.title,N=n.type,E=n.expanded,U=n.onChangeExpanded,z=n.hideExpandIcon,B=n.mediaFormProps,H=n.offCanvasProps,O=n.onlySingleMedia,V=n.elevation,W=n.accordionSx,J=n.refetch,Y=(0,h.x)({filters:w}),K=Y.initialData,Q=Y.ref,X=(0,g.x)(),nn=X.hasRole,ne=X.user,nt=(0,L.a)(),ni=(0,u.a)(c.t,{variables:(0,r.Z)((0,i.Z)({},K),{entity:s,entityId:p,category:t,adminId:ne.adminId,meta:C})}),nr=ni.data,no=void 0===nr?{items:[],meta:{aggregate:{totalCount:0}}}:nr,na=no.items,ns=no.meta,nu=ni.loading,nc=ni.refetch,nl=function(n){nt.close(),a.length||nc();var e=n.map(function(n){return(0,r.Z)((0,i.Z)({},n),{link:"".concat("https://cleverly-pre-prod-media.s3.eu-west-2.amazonaws.com","/").concat(n.filename)})});P&&P(e),J&&J()},nd=function(n){nt.close(),a.length||nc(),j&&j(n),J&&J()},nm=function(n){n.stopPropagation(),nt.show((0,i.Z)({content:(0,o.jsx)(f.z,(0,i.Z)({accept:"image/*",adminId:ne.adminId,category:t,entity:s,entityId:p,expiryShow:!1,mediaMeta:C,multiple:!0,onSuccess:nl,type:"image"},B)),title:"Upload Photos"},H))},nf=function(n){n.stopPropagation(),nt.show((0,i.Z)({content:(0,o.jsx)(f.z,(0,i.Z)({accept:".pdf, .doc, .docx, .xlsx",adminId:ne.adminId,category:t,entity:s,entityId:p,expiryShow:!1,mediaMeta:C,onSuccess:nl,type:"document"},B)),title:"Upload Documents"},H))},np=function(n){nt.show({content:(0,o.jsx)(d.d,{mediaId:n.data.id,onSuccess:nd}),submit:!1,title:"Delete Media"})},ny=function(n){nt.show({content:(0,o.jsx)(m.z,{media:n.data,toggleShow:nt.close}),title:"Media Details",width:"50%"})},nh=function(n){return[{context:"primary",icon:"info",onClick:function(e){return ny(n)},tooltip:"Details"},{context:"danger",icon:"delete",onClick:function(e){return np(n)},tooltip:"Delete"}]},ng=[],nv=na.filter(function(n){var e=n.item;return(null==e?void 0:e.visibility)&&nn(null==e?void 0:e.visibility)}).map(function(n){var e=n.entity,t=n.entityId,i=n.id,r=n.item,o=r.caption,a=r.filename,s=r.meta,u=r.name,c=r.type,l=r.user,d=r.visibility;return{data:r,id:i,userId:null==l?void 0:l.id,filename:a,visibility:d.join(", "),file:o||u||a,entity:e&&"".concat(e,"#").concat(t),authority:s,uploaded:"".concat(null==l?void 0:l.nameFirst," ").concat(null==l?void 0:l.nameLast),thumbnails:y(c,s),actions:""}}),n$=(na.filter(function(n){var e=n.item;return(null==e?void 0:e.visibility)&&nn(null==e?void 0:e.visibility)}).forEach(function(n){var e=n.item,t=e.caption,i=e.filename;"image"===e.type&&ng.push({caption:t,filename:"".concat("https://cleverly-pre-prod-media.s3.eu-west-2.amazonaws.com","/").concat(i)})}),ng),nb=n$.length;return(0,o.jsxs)(v.Z,{elevation:V,expanded:E,onChange:U,sx:W,children:[(0,o.jsx)(b.Z,(0,r.Z)((0,i.Z)({},z?{}:{expandIcon:(0,o.jsx)(A.Z,{})}),{children:(0,o.jsx)(Z.Z,{variant:"h6",children:R})})),(0,o.jsxs)($.Z,{children:[e&&nb>0&&(0,o.jsx)(G,{height:"200px",images:n$}),(0,o.jsx)(l.i,{columns:[{field:"file",headerName:"File",flex:1,sortable:!1,renderCell:function(n){var e=n.row,t=n.value;return(0,o.jsx)(D.r,{color:"secondary",onClick:function(n){n.preventDefault(),window.open("".concat("https://cleverly-pre-prod-media.s3.eu-west-2.amazonaws.com","/").concat(e.filename))},children:t})}},{field:"visibility",headerName:"Visible to",flex:1,sortable:!1},{hide:!M,field:"entity",headerName:"Entity",flex:1,sortable:!1},{field:"authority",headerName:"",width:50,sortable:!1,renderCell:function(n){var e=n.value;return(0,o.jsx)(o.Fragment,{children:(null==e?void 0:e.adminOnly)&&(0,o.jsx)(I.Z,{title:"Admin user only",children:(0,o.jsx)(_.Z,{component:"img",alt:"Admin Only",src:"/messaging/admin-only.svg",sx:{height:"24px"}})})})}},{field:"uploaded",headerName:"Uploaded by",flex:1,sortable:!1},{hide:!S,field:"thumbnails",headerName:"Thumbnails",flex:1,sortable:!1,renderCell:function(n){var e=n.value;return"function"==typeof e?e():e}},{hide:!T,field:"actions",headerName:"",width:50,sortable:!1,renderCell:function(n){var e=n.row;return nn("admin")?(0,o.jsx)(F.C,{actionsData:nh,row:e}):ne.id===e.userId?(0,o.jsx)(F.C,{actionsData:nh,row:e}):null}}],rows:nv,loading:nu,meta:ns,ref:Q,refetch:nc,columnVisibilityModel:{entity:M,thumbnails:S,actions:T}}),k&&!(O&&nv.length>0)&&(0,o.jsxs)(x.Z,{direction:"row",justifyContent:"center",spacing:2,mt:2,children:[(!N||"document"===N)&&(0,o.jsx)(q.Z,{variant:"contained",color:"secondary",onClick:nf,children:"Add Document"}),(!N||"image"===N||"avatar"===N)&&(0,o.jsxs)(q.Z,{variant:"contained",color:"secondary",onClick:nm,children:["Add ",N?"".concat(N.charAt(0).toUpperCase()).concat(N.slice(1)):"Image"]})]})]})]})};R.propTypes={carousel:s().bool,category:s().string,data:s().array,entity:s().string,entityId:s().number,filters:s().object,listView:s().bool,mediaMeta:s().object,onMediaAdd:s().func,onMediaRemove:s().func,showActionButtons:s().bool,showEntityColumn:s().bool,showItemActions:s().bool,title:s().string,type:s().string,expanded:s().bool,onChangeExpanded:s().func,hideExpandIcon:s().bool,mediaFormProps:s().object,offCanvasProps:s().object,onlySingleMedia:s().bool,elevation:s().number,accordionSx:s().object,refetch:s().func},R.defaultProps={carousel:!0,data:[],filters:{},listView:!1,mediaMeta:null,showActionButtons:!0,showEntityColumn:!1,showItemActions:!0,title:"Media",type:null,onChangeExpanded:function(){},mediaFormProps:{},offCanvasProps:{},category:"media",onlySingleMedia:!1,elevation:1,accordionSx:{},refetch:function(){}}},4972:function(n,e,t){t.d(e,{A5:function(){return nc},Ak:function(){return z},Cj:function(){return Q},K4:function(){return no},Oq:function(){return nu},Qn:function(){return E},RJ:function(){return K},SW:function(){return N},T_:function(){return W},UH:function(){return R},UM:function(){return ni},Ve:function(){return X},_d:function(){return H},_f:function(){return nr},by:function(){return J},cz:function(){return F},he:function(){return U},j$:function(){return B},kB:function(){return ne},kU:function(){return nn},kx:function(){return O},nD:function(){return L},nP:function(){return ns},pY:function(){return na},qd:function(){return D},t1:function(){return V},yR:function(){return Y},zR:function(){return nt}});var i=t(7297),r=t(75063);function o(){var n=(0,i.Z)(["\n  query GetAddressForSelect($q: String, $entity: String!, $entityId: Int!) {\n    items: Address(\n      where: {\n        Address_Entities: { entity: { _eq: $entity }, entityId: { _eq: $entityId } }\n        _or: [\n          { addressLine1: { _eq: $q } }\n          { addressLine2: { _eq: $q } }\n          { addressLine3: { _eq: $q } }\n          { county: { _eq: $q } }\n          { postCode: { _eq: $q } }\n          { city: { _eq: $q } }\n        ]\n      }\n    ) {\n      label: addressLine1\n      value: id\n      id\n      name\n      addressLine1\n      addressLine2\n      addressLine3\n      postCode\n      county\n      country: Country {\n        name\n      }\n      city\n      Address_Entities {\n        invoice\n      }\n    }\n  }\n"]);return o=function(){return n},n}function a(){var n=(0,i.Z)(["\n  query GetAccountsForSelect($q: String, $type: String, $limit: Int, $offset: Int) {\n    items: Account(\n      where: { name: { _ilike: $q }, type: { _eq: $type } }\n      limit: $limit\n      offset: $offset\n      order_by: { name: asc }\n    ) {\n      label: name\n      value: id\n    }\n  }\n"]);return a=function(){return n},n}function s(){var n=(0,i.Z)(['\n  query GetTaxonomy($q: String, $id: Int) {\n    items: Taxonomy(\n      where: { type: { _eq: "assetCategory" }, status: { _eq: "active" } }\n      order_by: { name: asc }\n    ) {\n      label: name\n      options: Taxonomies(\n        where: {\n          type: { _eq: "assetCategory" }\n          name: { _ilike: $q }\n          id: { _eq: $id }\n          status: { _eq: "active" }\n        }\n        order_by: { name: asc }\n      ) {\n        value: id\n        label: name\n      }\n    }\n  }\n']);return s=function(){return n},n}function u(){var n=(0,i.Z)(["\n  query GetAssetsForSelect(\n    $locationId: Int\n    $q: String\n    $categoryId: Int\n    $bookable: String\n    $limit: Int\n    $offset: Int\n  ) {\n    items: Asset(\n      where: {\n        categoryId: { _eq: $categoryId }\n        locationId: { _eq: $locationId }\n        name: { _ilike: $q }\n        bookable: { _eq: $bookable }\n      }\n      limit: $limit\n      offset: $offset\n      order_by: { name: asc }\n    ) {\n      label: name\n      value: id\n    }\n  }\n"]);return u=function(){return n},n}function c(){var n=(0,i.Z)(['\n  query GetCustomersForSelect($q: String, $limit: Int, $offset: Int) {\n    items: Account(\n      where: { name: { _ilike: $q }, type: { _eq: "customer" } }\n      limit: $limit\n      offset: $offset\n      order_by: { name: asc }\n    ) {\n      admin: Admins {\n        id: adminId\n      }\n      label: name\n      spendThreshold: meta(path: "$.finance.spendThreshold")\n      serviceRateLabour: meta(path: "$.finance.serviceRateLabour")\n      serviceRateExpenses: meta(path: "$.finance.serviceRateExpenses")\n      value: id\n    }\n  }\n']);return c=function(){return n},n}function l(){var n=(0,i.Z)(["\n  query GetJobsForSelect($_q: Int, $locationId: Int) {\n    items: Job(\n      where: {\n        Location: { id: { _eq: $locationId } }\n        _or: [{ id: { _eq: $_q } }, { Invoices: { id: { _eq: $_q } } }]\n      }\n      order_by: { title: asc }\n    ) {\n      label: label\n      value: id\n      number\n      createdAt\n      description\n      status\n      timingStart\n      title\n      type\n      Location {\n        name\n      }\n      Taxonomy {\n        Taxonomy {\n          shortJobDescription: name\n        }\n      }\n    }\n  }\n"]);return l=function(){return n},n}function d(){var n=(0,i.Z)(['\n  query GetManagersForSelect($userId: Int, $accountId: Int!, $q: String) {\n    items: User(\n      where: {\n        status: { _eq: "active" }\n        Account_Users: {\n          role: { _in: ["owner", "manager"] }\n          status: { _eq: "active" }\n          Account: { id: { _eq: $accountId } }\n        }\n        _or: [{ nameFirst: { _ilike: $q } }, { nameLast: { _ilike: $q } }]\n        id: { _neq: $userId }\n      }\n      order_by: { nameFirst: asc }\n    ) {\n      label: fullName\n      value: id\n    }\n  }\n']);return d=function(){return n},n}function m(){var n=(0,i.Z)(['\n  query GetManagersForSelect(\n    $userId: Int\n    $accountId: Int!\n    $q: String\n    $invoiceThreshold: numeric\n    $quoteThreshold: numeric\n  ) {\n    items: User(\n      where: {\n        status: { _eq: "active" }\n        Account_Users: {\n          role: { _in: ["owner", "manager"] }\n          status: { _eq: "active" }\n          Account: { id: { _eq: $accountId } }\n        }\n        _or: [{ nameFirst: { _ilike: $q } }, { nameLast: { _ilike: $q } }]\n        id: { _neq: $userId }\n        _and: [\n          {\n            _or: [\n              { invoiceThreshold: { _gt: $invoiceThreshold } }\n              { invoiceThreshold: { _is_null: true } }\n            ]\n          }\n          {\n            _or: [\n              { quoteThreshold: { _gt: $quoteThreshold } }\n              { quoteThreshold: { _is_null: true } }\n            ]\n          }\n        ]\n      }\n      order_by: { nameFirst: asc }\n    ) {\n      label: fullName\n      value: id\n    }\n  }\n']);return m=function(){return n},n}function f(){var n=(0,i.Z)(["\n  query GetPostCodeAreaForSelect($countryId: Int, $q: String) {\n    items: PostcodeArea(\n      where: { name: { _ilike: $q }, countryId: { _eq: $countryId } }\n      order_by: { name: asc }\n    ) {\n      area\n      label: name\n      value: id\n    }\n  }\n"]);return f=function(){return n},n}function p(){var n=(0,i.Z)(['\n  query GetPropertiesForSelect($where: Location_bool_exp, $limit: Int, $offset: Int) {\n    items: Location(where: $where, order_by: { name: asc }, limit: $limit, offset: $offset) {\n      label: name\n      value: id\n      access\n      permitsRequired\n      registeredAddress: Addresses(\n        where: { entity: { _eq: "Location" }, registered: { _eq: true } }\n      ) {\n        address: Address {\n          id\n          addressLine1\n          addressLine2\n          addressLine3\n          county\n          country: Country {\n            name\n          }\n          postCode\n          city\n        }\n      }\n    }\n  }\n']);return p=function(){return n},n}function y(){var n=(0,i.Z)(['\n  query GetServicesForSelect($q: String, $limit: Int, $offset: Int) {\n    items: Service(\n      where: { name: { _ilike: $q }, status: { _eq: "active" } }\n      limit: $limit\n      offset: $offset\n      order_by: { name: asc }\n    ) {\n      label: name\n      value: id\n    }\n  }\n']);return y=function(){return n},n}function h(){var n=(0,i.Z)(["\n  query GetSlasForSelect($q: String, $adminId: Int, $type: String) {\n    items: SLA(\n      where: { name: { _ilike: $q }, type: { _eq: $type }, adminId: { _eq: $adminId } }\n      order_by: { name: asc }\n    ) {\n      label: name\n      value: id\n    }\n  }\n"]);return h=function(){return n},n}function g(){var n=(0,i.Z)(["\n  query GetSlasForSelectNew($where: SLA_bool_exp, $limit: Int, $offset: Int) {\n    items: SLA(where: $where, order_by: { name: asc }, limit: $limit, offset: $offset) {\n      label: name\n      value: id\n    }\n  }\n"]);return g=function(){return n},n}function v(){var n=(0,i.Z)(["\n  query GetSuppliersForSelect($where: Account_bool_exp, $limit: Int, $offset: Int) {\n    items: Account(where: $where, limit: $limit, offset: $offset, order_by: { name: asc }) {\n      label: name\n      value: id\n    }\n  }\n"]);return v=function(){return n},n}function $(){var n=(0,i.Z)(['\n  query GetUsersForSelect($accountId: Int, $q: String, $limit: Int, $offset: Int) {\n    items: User(\n      where: {\n        status: { _eq: "active" }\n        Account_Users: {\n          accountId: { _eq: $accountId }\n          isContact: { _eq: true }\n          status: { _eq: "active" }\n        }\n        _or: [{ nameFirst: { _ilike: $q } }, { nameLast: { _ilike: $q } }]\n      }\n      order_by: { nameFirst: asc }\n      limit: $limit\n      offset: $offset\n    ) {\n      label: fullName\n      value: id\n      email\n      phone\n    }\n  }\n']);return $=function(){return n},n}function b(){var n=(0,i.Z)(['\n  query GetUsersForSelect($q: String) {\n    items: User(\n      where: {\n        status: { _eq: "active" }\n        _or: [{ nameFirst: { _ilike: $q } }, { nameLast: { _ilike: $q } }]\n      }\n      order_by: { nameFirst: asc }\n    ) {\n      label: fullName\n      value: id\n      email\n      phone\n    }\n  }\n']);return b=function(){return n},n}function _(){var n=(0,i.Z)(["\n  query GetTaxonomyGroupForSelect($q: String, $type: String!) {\n    items: Taxonomy(\n      where: { isGroup: { _eq: true }, name: { _ilike: $q }, type: { _eq: $type } }\n      order_by: { name: asc }\n    ) {\n      label: name\n      value: id\n    }\n  }\n"]);return _=function(){return n},n}function q(){var n=(0,i.Z)(['\n  query GetTaxonomy($q: String) {\n    items: Taxonomy(where: { type: { _eq: "expenseCategoryGroup" } }, order_by: { name: asc }) {\n      label: name\n      options: Taxonomies(\n        where: { type: { _eq: "expenseCategory" }, name: { _ilike: $q } }\n        order_by: { name: asc }\n      ) {\n        value: id\n        label: name\n      }\n    }\n  }\n']);return q=function(){return n},n}function x(){var n=(0,i.Z)(['\n  query GetCompliancesForSelect($q: String, $locationId: Int, $limit: Int, $offset: Int) {\n    items: Taxonomy(\n      where: { type: { _eq: "complianceCategory" } }\n      order_by: { name: asc }\n      limit: $limit\n      offset: $offset\n    ) {\n      label: name\n      options: Compliances(\n        where: {\n          name: { _ilike: $q }\n          Compliance_Entities: { Location: { id: { _eq: $locationId } } }\n        }\n        order_by: { name: asc }\n      ) {\n        value: id\n        label: name\n      }\n    }\n  }\n']);return x=function(){return n},n}function I(){var n=(0,i.Z)(["\n  query GetUserRole($userId: Int!, $accountId: Int!) {\n    accountUsers: Account_User(\n      where: { userId: { _eq: $userId }, accountId: { _eq: $accountId } }\n    ) {\n      role\n    }\n  }\n"]);return I=function(){return n},n}function Z(){var n=(0,i.Z)(["\n  query GetSublocationsForSelect($locationId: Int!, $q: String, $limit: Int, $offset: Int) {\n    items: Sublocation(\n      where: { name: { _ilike: $q }, locationId: { _eq: $locationId }, active: { _eq: true } }\n      limit: $limit\n      offset: $offset\n      order_by: { createdAt: desc }\n    ) {\n      value: id\n      label: name\n    }\n  }\n"]);return Z=function(){return n},n}function w(){var n=(0,i.Z)(['\n  query GetTaxonomy($q: String, $limit: Int, $offset: Int) {\n    items: Taxonomy(\n      where: {\n        type: { _eq: "assetCategory" }\n        isGroup: { _eq: false }\n        status: { _eq: "active" }\n        name: { _ilike: $q }\n      }\n      limit: $limit\n      offset: $offset\n      order_by: { name: asc }\n    ) {\n      label: name\n      value: id\n    }\n  }\n']);return w=function(){return n},n}function S(){var n=(0,i.Z)(["\n  query GetTaxonomyForSelect(\n    $where: Taxonomy_bool_exp\n    $limit: Int\n    $offset: Int\n    $orderBy: Taxonomy_order_by!\n    $includeMeta: Boolean! = false\n  ) {\n    items: Taxonomy(where: $where, limit: $limit, offset: $offset, order_by: [$orderBy]) {\n      value: id\n      label: name\n      meta @include(if: $includeMeta)\n    }\n  }\n"]);return S=function(){return n},n}function C(){var n=(0,i.Z)(['\n  query GetTagsForTask($q: String!, $limit: Int = 50, $offset: Int = 0) {\n    items: Taxonomy(\n      where: { name: { _ilike: $q }, status: { _eq: "active" }, type: { _eq: "taskTags" } }\n      limit: $limit\n      offset: $offset\n      order_by: { id: desc }\n    ) {\n      value: id\n      label: name\n    }\n  }\n']);return C=function(){return n},n}function P(){var n=(0,i.Z)(['\n  query GetTagsForEntity(\n    $entityId: Int\n    $entity: String!\n    $q: String!\n    $limit: Int = 50\n    $offset: Int = 0\n  ) {\n    tags: Taxonomy(\n      where: {\n        name: { _ilike: $q }\n        status: { _eq: "active" }\n        type: { _eq: "taskTags" }\n        _not: { Taxonomy_Entities: { entity: { _eq: $entity }, entityId: { _eq: $entityId } } }\n      }\n      limit: $limit\n      offset: $offset\n      order_by: { id: desc }\n    ) {\n      id\n      name\n      meta\n    }\n  }\n']);return P=function(){return n},n}function j(){var n=(0,i.Z)(['\n  query GetEntityTags($entityId: Int!, $entity: String!) {\n    tags: Taxonomy_Entity(\n      where: {\n        entity: { _eq: $entity }\n        entityId: { _eq: $entityId }\n        Taxonomy: { status: { _eq: "active" }, type: { _eq: "taskTags" } }\n      }\n      order_by: { id: desc }\n    ) {\n      id\n      tag: Taxonomy {\n        id\n        name\n        meta\n      }\n    }\n  }\n']);return j=function(){return n},n}function k(){var n=(0,i.Z)(["\n  query GetCustomerManagers($accountId: Int, $q: String, $limit: Int, $offset: Int) {\n    items: User(\n      where: { Account_Users: { accountId: { _eq: $accountId } }, fullName: { _ilike: $q } }\n      order_by: { fullName: asc }\n      limit: $limit\n      offset: $offset\n    ) {\n      label: fullName\n      value: id\n    }\n  }\n"]);return k=function(){return n},n}function M(){var n=(0,i.Z)(["\n  query GetServiceSchedulesForSelect(\n    $q: String\n    $serviceId: Int\n    $entity: service_schedule_entity\n    $entityId: Int\n    $limit: Int = 50\n    $offset: Int = 0\n  ) {\n    items: ServiceSchedule(\n      where: {\n        name: { _ilike: $q }\n        serviceId: { _eq: $serviceId }\n        entity: { _eq: $entity }\n        entityId: { _eq: $entityId }\n      }\n      limit: $limit\n      offset: $offset\n      order_by: { name: asc }\n    ) {\n      label: name\n      value: id\n    }\n  }\n"]);return M=function(){return n},n}function G(){var n=(0,i.Z)(['\n  query GetPropertyById($id: Int!) {\n    item: Location_by_pk(id: $id) {\n      label: name\n      value: id\n      access\n      registeredAddress: Addresses(\n        where: { entity: { _eq: "Location" }, registered: { _eq: true } }\n      ) {\n        address: Address {\n          id\n          addressLine1\n          addressLine2\n          addressLine3\n          county\n          country: Country {\n            name\n            code\n          }\n          postCode\n          city\n        }\n      }\n    }\n  }\n']);return G=function(){return n},n}function T(){var n=(0,i.Z)(['\n  query GetCompliancesForSelectNew($q: String, $locationId: Int, $limit: Int, $offset: Int) {\n    items: Compliance(\n      where: {\n        name: { _ilike: $q }\n        Category: { type: { _eq: "complianceCategory" } }\n        Compliance_Entities: { entity: { _eq: "Location" }, Location: { id: { _eq: $locationId } } }\n      }\n      order_by: { name: asc }\n      limit: $limit\n      offset: $offset\n    ) {\n      value: id\n      label: name\n      category: Category {\n        label: name\n      }\n    }\n  }\n']);return T=function(){return n},n}function A(){var n=(0,i.Z)(['\n  query GetTaskAssignedToForSelect(\n    $accountId: Int\n    $q: String\n    $limit: Int = 50\n    $offset: Int = 0\n  ) {\n    items: User(\n      where: {\n        status: { _eq: "active" }\n        Account_Users: { accountId: { _eq: $accountId }, status: { _eq: "active" } }\n        _or: [{ nameFirst: { _ilike: $q } }, { nameLast: { _ilike: $q } }]\n      }\n      limit: $limit\n      offset: $offset\n      order_by: { nameFirst: asc }\n    ) {\n      label: fullName\n      value: id\n    }\n  }\n']);return A=function(){return n},n}var F=(0,r.Ps)(o()),D=(0,r.Ps)(a()),L=(0,r.Ps)(s()),R=(0,r.Ps)(u()),N=(0,r.Ps)(c()),E=(0,r.Ps)(l()),U=(0,r.Ps)(d()),z=(0,r.Ps)(m()),B=(0,r.Ps)(f()),H=(0,r.Ps)(p()),O=(0,r.Ps)(y()),V=(0,r.Ps)(h()),W=(0,r.Ps)(g()),J=(0,r.Ps)(v()),Y=(0,r.Ps)($()),K=(0,r.Ps)(b()),Q=(0,r.Ps)(_()),X=(0,r.Ps)(q()),nn=(0,r.Ps)(x()),ne=(0,r.Ps)(I()),nt=(0,r.Ps)(Z()),ni=(0,r.Ps)(w()),nr=(0,r.Ps)(S());(0,r.Ps)(C()),(0,r.Ps)(P()),(0,r.Ps)(j());var no=(0,r.Ps)(k()),na=(0,r.Ps)(M()),ns=(0,r.Ps)(G()),nu=(0,r.Ps)(T()),nc=(0,r.Ps)(A())},15033:function(n,e,t){t.d(e,{i:function(){return Z}});var i=t(14924),r=t(26042),o=t(69396),a=t(85893),s=t(67294),u=t(11163),c=t(45697),l=t.n(c),d=t(61870),m=t(5616),f=t(51233),p=t(15861),y=t(90948),h=t(41796),g=t(29217),v=t(45111),$=t(46003),b=t(70872),_=t(58886),q=t(61730),x=function(n){var e=n.currentPage,t=n.totalCount,i=n.pageSize,o=n.onPageChange,s=(0,q.Z)("(max-width:400px)"),u=(0,q.Z)("(max-width:500px)");return(0,a.jsx)(I,{mb:2,page:e,count:Math.ceil(t/i),onChange:function(n,e){return o(e)},variant:"outlined",shape:"rounded",size:s?"small":"medium",hidePrevButton:1===e,hideNextButton:e===Math.ceil(t/i),siblingCount:u?0:1,renderItem:function(n){return(0,a.jsx)(_.Z,(0,r.Z)({slots:{previous:function(){return"Previous"},next:function(){return"Next"}}},n))}})};x.defaultProps={currentPage:1,totalCount:0,pageSize:50,onPageChange:function(){}},x.propTypes={currentPage:l().number,totalCount:l().number,pageSize:l().number,onPageChange:l().func};var I=(0,y.ZP)(b.Z)(function(n){var e,t=n.hidePrevButton,o=n.hideNextButton,a=n.theme;return e={},(0,i.Z)(e,"&.MuiPagination-root",{alignSelf:"center",marginTop:"16px"}),(0,i.Z)(e,"& .MuiPaginationItem-root",{fontWeight:600,margin:0,borderRadius:0}),(0,i.Z)(e,"& .MuiPagination-ul > li:last-child .MuiPaginationItem-previousNext:last-child",{margin:0,borderRadius:"0 5px 5px 0"}),(0,i.Z)(e,"& .MuiPagination-ul > li:first-child .MuiPaginationItem-previousNext:last-child",{margin:0,borderRadius:"5px 0 0 5px"}),(0,i.Z)(e,"& button.Mui-selected",(0,r.Z)({color:a.palette.white.main,backgroundColor:a.palette.secondary.main},o?{borderRadius:"0 5px 5px 0"}:{},t?{borderRadius:"5px 0 0 5px"}:{})),e}),Z=(0,s.forwardRef)(function(n,e){var t=n.columns,i=n.history,o=n.initialSort,c=n.meta,l=n.refetch,d=n.paginationSize,m=n.containerHeight,y=n.noResultsMessage,h=n.autoHeight,b=(0,u.useRouter)(),_=b.query,q=void 0===_?{}:_,I=(0,s.useState)(parseInt(null==q?void 0:q.page,10)||1),Z=I[0],C=I[1],P=(0,s.useState)(d||$.C1.paginationSize),j=P[0],k=P[1];o||(o={item:"createdAt",order:"desc"});var M=(0,s.useState)({item:o.item,order:o.order}),G=M[0],T=M[1],A=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=b.query,t=void 0===e?{}:e;if(n>1?t.page=n:delete t.page,!(Object.keys(t).length>0))return{};var i=Object.keys(t).map(function(e){return"page"===e?"".concat(e,"=").concat(n):"".concat(e,"=").concat(t[e])}).join("&");return"?".concat(i)},F=function(){T({item:o.item,order:o.order}),C(1);var n=A();b.push(n),k(d||$.C1.paginationSize)};(0,s.useImperativeHandle)(e,function(){return{currentPage:Z,pageSize:j,sort:G,resetPagination:function(){F()}}});var D=function(n){var e=A(n);i&&b.push(e),C(n),!i&&l&&l()},L=function(n){n&&n.field&&n.sort?(T({item:t.find(function(e){return e.field===n.field}).sortName||n.field||n.item||o.item,order:n.sort||n.order||o.order}),l&&l()):(T({item:o.item,order:o.order}),l&&l())};return(0,a.jsxs)(w,{containerHeight:m,children:[(0,a.jsx)(S,(0,r.Z)({hideFooter:!0,disableColumnMenu:!0,disableSelectionOnClick:!0,autoHeight:h,sortingMode:"server",onSortModelChange:function(n){return L(n[0])},columns:t,pageSize:j,slots:{columnSortedAscendingIcon:function(){return(0,a.jsx)(g.Z,{})},columnSortedDescendingIcon:function(){return(0,a.jsx)(v.Z,{})},columnUnsortedIcon:function(){return(0,a.jsxs)(f.Z,{alignItems:"center",sx:{width:"33px"},children:[(0,a.jsx)(g.Z,{sx:{marginBottom:"-15px"}}),(0,a.jsx)(v.Z,{})]})},noResultsOverlay:function(){return(0,a.jsx)(f.Z,{height:"100%",alignItems:"center",justifyContent:"center",spacing:1,p:1,children:(0,a.jsx)(p.Z,{children:y})})},noRowsOverlay:function(){return(0,a.jsx)(f.Z,{height:"100%",alignItems:"center",justifyContent:"center",spacing:1,p:1,children:(0,a.jsx)(p.Z,{children:y})})}}},n)),c&&Math.ceil(c.aggregate.totalCount/j)>1&&(0,a.jsx)(x,{currentPage:Z,totalCount:c.aggregate.totalCount,pageSize:j,onPageChange:D})]})});Z.propTypes={history:l().bool,initialSort:l().object,loading:l().bool,meta:l().object,refetch:l().func,paginationSize:l().number,noResultsMessage:l().string,columns:l().array.isRequired,rows:l().array.isRequired,autoHeight:l().bool},Z.defaultProps={columns:[],history:!1,loading:!1,rows:[],noResultsMessage:"There are no results.",autoHeight:!0};var w=(0,y.ZP)(m.Z)(function(n){return{height:n.containerHeight,display:"flex",flexDirection:"column"}}),S=(0,y.ZP)(d.s)(function(n){var e,t=n.theme,a=n.hideHeader,s=(n.rows,n.loading,n.rowHeight),u=n.isPdf;return e={"--DataGrid-overlayHeight":"40px"},(0,i.Z)(e,"&.MuiDataGrid-root",(0,r.Z)({color:t.palette.black.main,border:"none"},u&&{"@media print":{display:"block"}})),(0,i.Z)(e,"& .MuiDataGrid-main",(0,r.Z)({},u&&{"@media print":{overflow:"visible !important"}})),(0,i.Z)(e,"& .MuiDataGrid-columnHeaders",(0,o.Z)((0,r.Z)({},a&&{display:"none"}),{"& .MuiDataGrid-iconButtonContainer":{visibility:"visible","& .MuiButtonBase-root.MuiIconButton-root":{backgroundColor:"inherit",color:t.palette.black.main,"&:hover":{backgroundColor:"rgba(0, 0, 0, 0.1)"}}}})),(0,i.Z)(e,"& .MuiDataGrid-virtualScroller",(0,r.Z)({},a&&{marginTop:"0 !important"},u&&{"@media print":{overflow:"visible !important"}})),(0,i.Z)(e,"& .MuiDataGrid-iconSeparator",{opacity:0}),(0,i.Z)(e,"& .MuiDataGrid-columnHeaderTitle",{fontWeight:700}),(0,i.Z)(e,"& .MuiButtonBase-root.MuiDataGrid-columnHeaderTitle",{fontWeight:700}),(0,i.Z)(e,"& .MuiDataGrid-virtualScrollerContent",(0,r.Z)({},u&&{height:"initial !important",minHeight:"initial !important"})),(0,i.Z)(e,"& .MuiDataGrid-virtualScrollerRenderZone",(0,r.Z)({},u&&{position:"relative"})),(0,i.Z)(e,"& .MuiDataGrid-overlayWrapper",(0,i.Z)({},"& .MuiCircularProgress-root",{color:t.palette.secondary.main})),(0,i.Z)(e,"& .MuiDataGrid-row",(0,r.Z)({},u&&{minHeight:"".concat(s,"cm !important"),maxHeight:"".concat(s,"cm !important")})),(0,i.Z)(e,"& .MuiDataGrid-row > .MuiDataGrid-cell",(0,r.Z)({},u&&{minHeight:"".concat(s,"cm !important"),maxHeight:"".concat(s,"cm !important")})),(0,i.Z)(e,"& .MuiDataGrid-row.even",{backgroundColor:t.palette.muiLightGray.main,"&:hover, &.Mui-hovered":{backgroundColor:(0,h.Fq)(t.palette.muiLightGray.main,.3),"@media (hover: none)":{backgroundColor:"transparent"}},"&.Mui-selected":{backgroundColor:(0,h.Fq)(t.palette.muiLightGray.main,.3+t.palette.action.selectedOpacity),"&:hover, &.Mui-hovered":{backgroundColor:(0,h.Fq)(t.palette.muiLightGray.main,.3+t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:(0,h.Fq)(t.palette.muiLightGray.main,.3+t.palette.action.selectedOpacity)}}}}),e})}}]);